<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI Error Validation Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { border: 1px solid #ccc; padding: 15px; margin: 10px 0; }
        .error { color: red; }
        .success { color: green; }
        .warning { color: orange; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>UI Error Validation Test Results</h1>
    
    <div class="test-section">
        <h2>Test 1: Chat Send Button State</h2>
        <div id="chat-button-test">Testing...</div>
    </div>

    <div class="test-section">
        <h2>Test 2: Missing JavaScript Files</h2>
        <div id="missing-files-test">Testing...</div>
    </div>

    <div class="test-section">
        <h2>Test 3: Console Errors</h2>
        <div id="console-errors-test">Testing...</div>
    </div>

    <div class="test-section">
        <h2>Test 4: Network Errors</h2>
        <div id="network-errors-test">Testing...</div>
    </div>

    <script>
        // Test Results Storage
        const testResults = {
            chatButton: null,
            missingFiles: [],
            consoleErrors: [],
            networkErrors: []
        };

        // Test 1: Check chat send button state
        function testChatButton() {
            const button = document.getElementById('chat-send-btn');
            const result = document.getElementById('chat-button-test');
            
            if (!button) {
                result.innerHTML = '<span class="error">❌ Chat send button not found in DOM</span>';
                testResults.chatButton = 'not_found';
                return;
            }
            
            const isDisabled = button.disabled || button.hasAttribute('disabled');
            const hasDisabledClass = button.classList.contains('disabled');
            
            if (isDisabled || hasDisabledClass) {
                result.innerHTML = `<span class="error">❌ Chat send button is disabled</span>
                    <br>- disabled attribute: ${isDisabled}
                    <br>- disabled class: ${hasDisabledClass}`;
                testResults.chatButton = 'disabled';
            } else {
                result.innerHTML = '<span class="success">✅ Chat send button is enabled</span>';
                testResults.chatButton = 'enabled';
            }
        }

        // Test 2: Check for missing JavaScript files
        function testMissingFiles() {
            const result = document.getElementById('missing-files-test');
            const scripts = document.querySelectorAll('script[src]');
            
            const expectedFiles = [
                'emergency-layout-preload.js',
                'final-layout-enforcer.js', 
                'force-visualizer-mode.js',
                'project-management.js'
            ];
            
            const loadedFiles = Array.from(scripts).map(script => script.src);
            const missingFiles = expectedFiles.filter(file => 
                !loadedFiles.some(loaded => loaded.includes(file))
            );
            
            if (missingFiles.length > 0) {
                result.innerHTML = `<span class="error">❌ Missing JavaScript files: ${missingFiles.length}</span>
                    <pre>${missingFiles.join('\\n')}</pre>`;
                testResults.missingFiles = missingFiles;
            } else {
                result.innerHTML = '<span class="success">✅ All JavaScript files present</span>';
                testResults.missingFiles = [];
            }
        }

        // Test 3: Monitor console errors
        function testConsoleErrors() {
            const result = document.getElementById('console-errors-test');
            
            // Override console.error to capture errors
            const originalError = console.error;
            const capturedErrors = [];
            
            console.error = function(...args) {
                capturedErrors.push(args.join(' '));
                originalError.apply(console, args);
            };
            
            // Check for existing errors and wait for new ones
            setTimeout(() => {
                if (capturedErrors.length > 0) {
                    result.innerHTML = `<span class="error">❌ Console errors detected: ${capturedErrors.length}</span>
                        <pre>${capturedErrors.join('\\n')}</pre>`;
                    testResults.consoleErrors = capturedErrors;
                } else {
                    result.innerHTML = '<span class="success">✅ No console errors detected</span>';
                    testResults.consoleErrors = [];
                }
            }, 2000);
        }

        // Test 4: Monitor network errors
        function testNetworkErrors() {
            const result = document.getElementById('network-errors-test');
            const networkErrors = [];
            
            // Monitor resource loading errors
            window.addEventListener('error', function(e) {
                if (e.target.src || e.target.href) {
                    networkErrors.push({
                        url: e.target.src || e.target.href,
                        type: e.target.tagName,
                        message: e.message || 'Failed to load resource'
                    });
                }
            }, true);
            
            // Check results after a delay
            setTimeout(() => {
                if (networkErrors.length > 0) {
                    result.innerHTML = `<span class="error">❌ Network errors detected: ${networkErrors.length}</span>
                        <pre>${JSON.stringify(networkErrors, null, 2)}</pre>`;
                    testResults.networkErrors = networkErrors;
                } else {
                    result.innerHTML = '<span class="success">✅ No network errors detected</span>';
                    testResults.networkErrors = [];
                }
            }, 3000);
        }

        // Run all tests
        function runAllTests() {
            testChatButton();
            testMissingFiles();
            testConsoleErrors();
            testNetworkErrors();
            
            // Generate summary after all tests
            setTimeout(() => {
                const summary = document.createElement('div');
                summary.className = 'test-section';
                summary.innerHTML = `
                    <h2>Test Summary</h2>
                    <pre>${JSON.stringify(testResults, null, 2)}</pre>
                `;
                document.body.appendChild(summary);
            }, 5000);
        }

        // Run tests when DOM is ready
        document.addEventListener('DOMContentLoaded', runAllTests);
    </script>
</body>
</html>