<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Complete AI agent orchestration framework with Discord integration, Test-Driven Development, and human-in-the-loop control for automated software development"><meta name=author content="AI Agent Workflow Team"><link href=https://jmontp.github.io/agent-workflow/architecture/context-management-system/ rel=canonical><link href=../component-architecture/ rel=prev><link href=../context-api-specification/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>📊 Context System - AI Agent TDD-Scrum Workflow - Complete Guide</title><link rel=stylesheet href=../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{.md-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.5%207A1.5%201.5%200%200%201%204%205.5%201.5%201.5%200%200%201%205.5%204%201.5%201.5%200%200%201%207%205.5%201.5%201.5%200%200%201%205.5%207m15.91%204.58-9-9C12.05%202.22%2011.55%202%2011%202H4c-1.11%200-2%20.89-2%202v7c0%20.55.22%201.05.59%201.41l8.99%209c.37.36.87.59%201.42.59s1.05-.23%201.41-.59l7-7c.37-.36.59-.86.59-1.41%200-.56-.23-1.06-.59-1.42%22/%3E%3C/svg%3E');}.md-tag.md-tag--html{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m12%2017.56%204.07-1.13.55-6.1H9.38L9.2%208.3h7.6l.2-1.99H7l.56%206.01h6.89l-.23%202.58-2.22.6-2.22-.6-.14-1.66h-2l.29%203.19zM4.07%203h15.86L18.5%2019.2%2012%2021l-6.5-1.8z%22/%3E%3C/svg%3E');}.md-tag.md-tag--js{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M3%203h18v18H3zm4.73%2015.04c.4.85%201.19%201.55%202.54%201.55%201.5%200%202.53-.8%202.53-2.55v-5.78h-1.7V17c0%20.86-.35%201.08-.9%201.08-.58%200-.82-.4-1.09-.87zm5.98-.18c.5.98%201.51%201.73%203.09%201.73%201.6%200%202.8-.83%202.8-2.36%200-1.41-.81-2.04-2.25-2.66l-.42-.18c-.73-.31-1.04-.52-1.04-1.02%200-.41.31-.73.81-.73.48%200%20.8.21%201.09.73l1.31-.87c-.55-.96-1.33-1.33-2.4-1.33-1.51%200-2.48.96-2.48%202.23%200%201.38.81%202.03%202.03%202.55l.42.18c.78.34%201.24.55%201.24%201.13%200%20.48-.45.83-1.15.83-.83%200-1.31-.43-1.67-1.03z%22/%3E%3C/svg%3E');}.md-tag.md-tag--css{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m5%203-.65%203.34h13.59L17.5%208.5H3.92l-.66%203.33h13.59l-.76%203.81-5.48%201.81-4.75-1.81.33-1.64H2.85l-.79%204%207.85%203%209.05-3%201.2-6.03.24-1.21L21.94%203z%22/%3E%3C/svg%3E');}.md-tag.md-tag--python{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M19.14%207.5A2.86%202.86%200%200%201%2022%2010.36v3.78A2.86%202.86%200%200%201%2019.14%2017H12c0%20.39.32.96.71.96H17v1.68a2.86%202.86%200%200%201-2.86%202.86H9.86A2.86%202.86%200%200%201%207%2019.64v-3.75a2.85%202.85%200%200%201%202.86-2.85h5.25a2.85%202.85%200%200%200%202.85-2.86V7.5zm-4.28%2011.79c-.4%200-.72.3-.72.89s.32.71.72.71a.71.71%200%200%200%20.71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86%202.86%200%200%201%202%2014.64v-3.78A2.86%202.86%200%200%201%204.86%208H12c0-.39-.32-.96-.71-.96H7V5.36A2.86%202.86%200%200%201%209.86%202.5h4.28A2.86%202.86%200%200%201%2017%205.36v3.75a2.85%202.85%200%200%201-2.86%202.85H8.89a2.85%202.85%200%200%200-2.85%202.86v2.68zM9.14%205.71c.4%200%20.72-.3.72-.89s-.32-.71-.72-.71c-.39%200-.71.12-.71.71s.32.89.71.89%22/%3E%3C/svg%3E');}}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href=../../stylesheets/enhanced-navigation.css><link rel=stylesheet href=../../stylesheets/color-schemes.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head><body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=black><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off><input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off><label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#context-management-system-design class=md-skip> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=../.. title="AI Agent TDD-Scrum Workflow - Complete Guide" class="md-header__button md-logo" aria-label="AI Agent TDD-Scrum Workflow - Complete Guide" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a><label class="md-header__button md-icon" for=__drawer><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> AI Agent TDD-Scrum Workflow - Complete Guide </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> 📊 Context System </span></div></div></div><div class=md-header__option><div class=md-select><button class="md-header__button md-icon" aria-label="Select language"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg></button><div class=md-select__inner><ul class=md-select__list><li class=md-select__item><a href=../../ hreflang=en class=md-select__link> English </a></li></ul></div></div></div><label class="md-header__button md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required><label class="md-search__icon md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.41 16.58 10.83 12l4.58-4.59L14 6l-6 6 6 6z"/></svg></label><nav class=md-search__options aria-label=Search><a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg></a><button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap tabindex=0 data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta> Initializing search </div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a href=https://github.com/jmontp/agent-workflow title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></div><div class=md-source__repository> jmontp/agent-workflow </div></a></div></nav><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a href=../.. class=md-tabs__link> 🏠 Home </a></li><li class=md-tabs__item><a href=../../getting-started/ class=md-tabs__link> ⚡ Getting Started </a></li><li class=md-tabs__item><a href=../../user-guide/ class=md-tabs__link> 📚 User Guide </a></li><li class=md-tabs__item><a href=../../concepts/ class=md-tabs__link> 🎯 Core Concepts </a></li><li class="md-tabs__item md-tabs__item--active"><a href=../ class=md-tabs__link> 🏗️ Architecture </a></li><li class=md-tabs__item><a href=../../advanced/ class=md-tabs__link> 🔬 Advanced Topics </a></li><li class=md-tabs__item><a href=../../planning/ class=md-tabs__link> 🎨 Planning & Design </a></li><li class=md-tabs__item><a href=../../development/ class=md-tabs__link> 🛠️ Development </a></li><li class=md-tabs__item><a href=../../deployment/ class=md-tabs__link> 🚀 Deployment </a></li><li class=md-tabs__item><a href=../../templates/ class=md-tabs__link> 📋 Templates </a></li><li class=md-tabs__item><a href=../../theme-integration-guide/ class=md-tabs__link> 🎨 Theme Integration </a></li><li class=md-tabs__item><a href=../../archive/compliance/ class=md-tabs__link> 📁 Archive </a></li></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=../.. title="AI Agent TDD-Scrum Workflow - Complete Guide" class="md-nav__button md-logo" aria-label="AI Agent TDD-Scrum Workflow - Complete Guide" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a> AI Agent TDD-Scrum Workflow - Complete Guide </label><div class=md-nav__source><a href=https://github.com/jmontp/agent-workflow title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></div><div class=md-source__repository> jmontp/agent-workflow </div></a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../.. class=md-nav__link><span class=md-ellipsis> 🏠 Home </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../getting-started/ class=md-nav__link><span class=md-ellipsis> ⚡ Getting Started </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../user-guide/ class=md-nav__link><span class=md-ellipsis> 📚 User Guide </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../concepts/ class=md-nav__link><span class=md-ellipsis> 🎯 Core Concepts </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked><div class="md-nav__link md-nav__container"><a href=../ class="md-nav__link "><span class=md-ellipsis> 🏗️ Architecture </span></a><label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span> 🏗️ Architecture </label><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_2><label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex><span class=md-ellipsis> 🏠 System Design </span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false><label class=md-nav__title for=__nav_5_2><span class="md-nav__icon md-icon"></span> 🏠 System Design </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../system-overview/ class=md-nav__link><span class=md-ellipsis> 🏗️ System Overview </span></a></li><li class=md-nav__item><a href=../component-architecture/ class=md-nav__link><span class=md-ellipsis> 🔧 Component Architecture </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3 checked><label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex><span class=md-ellipsis> 🧠 Context Management </span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=true><label class=md-nav__title for=__nav_5_3><span class="md-nav__icon md-icon"></span> 🧠 Context Management </label><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" type=checkbox id=__toc><label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> 📊 Context System </span><span class="md-nav__icon md-icon"></span></label><a href=./ class="md-nav__link md-nav__link--active"><span class=md-ellipsis> 📊 Context System </span></a><nav class="md-nav md-nav--secondary" aria-label="On this page"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> On this page </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#executive-summary class=md-nav__link><span class=md-ellipsis> Executive Summary </span></a></li><li class=md-nav__item><a href=#system-overview class=md-nav__link><span class=md-ellipsis> System Overview </span></a></li><li class=md-nav__item><a href=#architecture-design class=md-nav__link><span class=md-ellipsis> Architecture Design </span></a><nav class=md-nav aria-label="Architecture Design"><ul class=md-nav__list><li class=md-nav__item><a href=#high-level-architecture class=md-nav__link><span class=md-ellipsis> High-Level Architecture </span></a></li><li class=md-nav__item><a href=#core-components class=md-nav__link><span class=md-ellipsis> Core Components </span></a></li></ul></nav></li><li class=md-nav__item><a href=#data-flow-diagrams class=md-nav__link><span class=md-ellipsis> Data Flow Diagrams </span></a><nav class=md-nav aria-label="Data Flow Diagrams"><ul class=md-nav__list><li class=md-nav__item><a href=#context-preparation-flow class=md-nav__link><span class=md-ellipsis> Context Preparation Flow </span></a></li><li class=md-nav__item><a href=#agent-handoff-flow class=md-nav__link><span class=md-ellipsis> Agent Handoff Flow </span></a></li></ul></nav></li><li class=md-nav__item><a href=#implementation-strategy class=md-nav__link><span class=md-ellipsis> Implementation Strategy </span></a><nav class=md-nav aria-label="Implementation Strategy"><ul class=md-nav__list><li class=md-nav__item><a href=#phase-1-core-infrastructure-weeks-1-2 class=md-nav__link><span class=md-ellipsis> Phase 1: Core Infrastructure (Weeks 1-2) </span></a></li><li class=md-nav__item><a href=#phase-2-intelligence-layer-weeks-3-4 class=md-nav__link><span class=md-ellipsis> Phase 2: Intelligence Layer (Weeks 3-4) </span></a></li><li class=md-nav__item><a href=#phase-3-optimization-weeks-5-6 class=md-nav__link><span class=md-ellipsis> Phase 3: Optimization (Weeks 5-6) </span></a></li><li class=md-nav__item><a href=#phase-4-advanced-features-weeks-7-8 class=md-nav__link><span class=md-ellipsis> Phase 4: Advanced Features (Weeks 7-8) </span></a></li></ul></nav></li><li class=md-nav__item><a href=#algorithm-designs class=md-nav__link><span class=md-ellipsis> Algorithm Designs </span></a><nav class=md-nav aria-label="Algorithm Designs"><ul class=md-nav__list><li class=md-nav__item><a href=#relevance-scoring-algorithm class=md-nav__link><span class=md-ellipsis> Relevance Scoring Algorithm </span></a></li><li class=md-nav__item><a href=#context-compression-algorithm class=md-nav__link><span class=md-ellipsis> Context Compression Algorithm </span></a></li><li class=md-nav__item><a href=#token-budget-allocation-algorithm class=md-nav__link><span class=md-ellipsis> Token Budget Allocation Algorithm </span></a></li></ul></nav></li><li class=md-nav__item><a href=#performance-requirements class=md-nav__link><span class=md-ellipsis> Performance Requirements </span></a><nav class=md-nav aria-label="Performance Requirements"><ul class=md-nav__list><li class=md-nav__item><a href=#latency-targets class=md-nav__link><span class=md-ellipsis> Latency Targets </span></a></li><li class=md-nav__item><a href=#throughput-targets class=md-nav__link><span class=md-ellipsis> Throughput Targets </span></a></li><li class=md-nav__item><a href=#scalability-targets class=md-nav__link><span class=md-ellipsis> Scalability Targets </span></a></li></ul></nav></li><li class=md-nav__item><a href=#error-handling-strategy class=md-nav__link><span class=md-ellipsis> Error Handling Strategy </span></a><nav class=md-nav aria-label="Error Handling Strategy"><ul class=md-nav__list><li class=md-nav__item><a href=#graceful-degradation class=md-nav__link><span class=md-ellipsis> Graceful Degradation </span></a></li><li class=md-nav__item><a href=#recovery-mechanisms class=md-nav__link><span class=md-ellipsis> Recovery Mechanisms </span></a></li></ul></nav></li><li class=md-nav__item><a href=#evaluation-framework class=md-nav__link><span class=md-ellipsis> Evaluation Framework </span></a><nav class=md-nav aria-label="Evaluation Framework"><ul class=md-nav__list><li class=md-nav__item><a href=#success-metrics class=md-nav__link><span class=md-ellipsis> Success Metrics </span></a></li><li class=md-nav__item><a href=#benchmarking-strategy class=md-nav__link><span class=md-ellipsis> Benchmarking Strategy </span></a></li></ul></nav></li><li class=md-nav__item><a href=#integration-points class=md-nav__link><span class=md-ellipsis> Integration Points </span></a><nav class=md-nav aria-label="Integration Points"><ul class=md-nav__list><li class=md-nav__item><a href=#claude-code-cli-integration class=md-nav__link><span class=md-ellipsis> Claude Code CLI Integration </span></a></li><li class=md-nav__item><a href=#tdd-state-machine-integration class=md-nav__link><span class=md-ellipsis> TDD State Machine Integration </span></a></li></ul></nav></li><li class=md-nav__item><a href=#future-enhancements class=md-nav__link><span class=md-ellipsis> Future Enhancements </span></a><nav class=md-nav aria-label="Future Enhancements"><ul class=md-nav__list><li class=md-nav__item><a href=#machine-learning-integration class=md-nav__link><span class=md-ellipsis> Machine Learning Integration </span></a></li><li class=md-nav__item><a href=#advanced-features class=md-nav__link><span class=md-ellipsis> Advanced Features </span></a></li><li class=md-nav__item><a href=#performance-optimizations class=md-nav__link><span class=md-ellipsis> Performance Optimizations </span></a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a href=../context-api-specification/ class=md-nav__link><span class=md-ellipsis> 🔌 Context API Specification </span></a></li><li class=md-nav__item><a href=../context-algorithms/ class=md-nav__link><span class=md-ellipsis> ⚙️ Context Algorithms </span></a></li><li class=md-nav__item><a href=../context-evaluation-framework/ class=md-nav__link><span class=md-ellipsis> 📋 Context Evaluation Framework </span></a></li><li class=md-nav__item><a href=../context-implementation-plan/ class=md-nav__link><span class=md-ellipsis> 🛠️ Context Implementation Plan </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_4><label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex><span class=md-ellipsis> 🔄 Parallel TDD System </span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false><label class=md-nav__title for=__nav_5_4><span class="md-nav__icon md-icon"></span> 🔄 Parallel TDD System </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../parallel-tdd-architecture/ class=md-nav__link><span class=md-ellipsis> 📐 Design Overview </span></a></li><li class=md-nav__item><a href=../parallel-tdd-technical-specification/ class=md-nav__link><span class=md-ellipsis> 🔧 Technical Specification </span></a></li><li class=md-nav__item><a href=../parallel-tdd-implementation-strategy/ class=md-nav__link><span class=md-ellipsis> 📋 Implementation Strategy </span></a></li><li class=md-nav__item><a href=../parallel-tdd-comprehensive-implementation-plan/ class=md-nav__link><span class=md-ellipsis> 📊 Comprehensive Plan </span></a></li><li class=md-nav__item><a href=../parallel-tdd-testing-strategy/ class=md-nav__link><span class=md-ellipsis> 🧪 Testing Strategy </span></a></li><li class=md-nav__item><a href=../parallel-context-integration/ class=md-nav__link><span class=md-ellipsis> 🔗 Context Integration </span></a></li><li class=md-nav__item><a href=../parallel-agent-pool-management/ class=md-nav__link><span class=md-ellipsis> 🤖 Agent Pool Management </span></a></li><li class=md-nav__item><a href=../parallel-conflict-algorithms/ class=md-nav__link><span class=md-ellipsis> ⚔️ Conflict Resolution </span></a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../advanced/ class=md-nav__link><span class=md-ellipsis> 🔬 Advanced Topics </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../planning/ class=md-nav__link><span class=md-ellipsis> 🎨 Planning & Design </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../development/ class=md-nav__link><span class=md-ellipsis> 🛠️ Development </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../deployment/ class=md-nav__link><span class=md-ellipsis> 🚀 Deployment </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../templates/ class=md-nav__link><span class=md-ellipsis> 📋 Templates </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../theme-integration-guide/ class=md-nav__link><span class=md-ellipsis> 🎨 Theme Integration </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../archive/compliance/ class=md-nav__link><span class=md-ellipsis> 📁 Archive </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a href=https://github.com/jmontp/agent-workflow/edit/master/docs/architecture/context-management-system.md title="Edit this page" class="md-content__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg></a><a href=https://github.com/jmontp/agent-workflow/raw/master/docs/architecture/context-management-system.md title="View source of this page" class="md-content__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg></a><h1 id=context-management-system-design>Context Management System Design<a class=headerlink href=#context-management-system-design title="Permanent link">&para;</a></h1><h2 id=executive-summary>Executive Summary<a class=headerlink href=#executive-summary title="Permanent link">&para;</a></h2><p>The Context Management System (CMS) is a foundational component that enables intelligent agent communication, manages Claude Code token limits, and optimizes information flow between agents and the orchestrator. This system addresses the critical challenge of efficiently sharing context across TDD phases while respecting Claude Code's ~200k token limitations.</p><h2 id=system-overview>System Overview<a class=headerlink href=#system-overview title="Permanent link">&para;</a></h2><p>The CMS acts as an intelligent middleware layer between the orchestrator and individual agents, providing:</p><ul><li><strong>Context Filtering</strong>: Intelligent selection of relevant files based on current task</li><li><strong>Token Budget Management</strong>: Optimal allocation of context within Claude Code limits </li><li><strong>Agent Memory</strong>: Persistent storage of agent decisions and artifacts</li><li><strong>Content Piping</strong>: Efficient handoff of work products between TDD phases</li><li><strong>Context Compression</strong>: Intelligent summarization of large codebases</li></ul><h2 id=architecture-design>Architecture Design<a class=headerlink href=#architecture-design title="Permanent link">&para;</a></h2><h3 id=high-level-architecture>High-Level Architecture<a class=headerlink href=#high-level-architecture title="Permanent link">&para;</a></h3><pre class=mermaid><code>graph TB
    subgraph "Orchestrator Layer"
        O[Orchestrator]
    end
    
    subgraph "Context Management System"
        CM[Context Manager]
        CF[Context Filter]
        TC[Token Calculator]
        AM[Agent Memory]
        CC[Context Compressor]
        CI[Context Index]
    end
    
    subgraph "Agent Layer"
        DA[Design Agent]
        QA[QA Agent] 
        CA[Code Agent]
        DTA[Data Agent]
    end
    
    subgraph "Storage Layer"
        CS[Context Storage]
        AC[Artifact Cache]
        MI[Memory Index]
        FS[File System]
    end
    
    O --&gt; CM
    CM --&gt; CF
    CM --&gt; TC
    CM --&gt; AM
    CM --&gt; CC
    CM --&gt; CI
    
    CM --&gt; DA
    CM --&gt; QA
    CM --&gt; CA
    CM --&gt; DTA
    
    CM --&gt; CS
    AM --&gt; AC
    CI --&gt; MI
    CS --&gt; FS</code></pre><h3 id=core-components>Core Components<a class=headerlink href=#core-components title="Permanent link">&para;</a></h3><h4 id=1-context-manager-central-coordinator>1. Context Manager (Central Coordinator)<a class=headerlink href=#1-context-manager-central-coordinator title="Permanent link">&para;</a></h4><p><strong>Responsibilities:</strong> - Orchestrate context preparation for agent tasks - Coordinate between filtering, compression, and caching components - Manage context lifecycle and invalidation - Interface with agents and orchestrator</p><p><strong>Key Methods:</strong><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="1 "></span></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prepare_context</span><span class=p>(</span><span class=n>agent_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>task</span><span class=p>:</span> <span class=n>TDDTask</span><span class=p>,</span> <span class=n>max_tokens</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>AgentContext</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="2 "></span></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>update_context</span><span class=p>(</span><span class=n>context_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>changes</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span>  
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="3 "></span></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>invalidate_context</span><span class=p>(</span><span class=n>context_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="4 "></span></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>get_agent_memory</span><span class=p>(</span><span class=n>agent_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>story_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>AgentMemory</span>
</span></code></pre></div></p><h4 id=2-context-filter-relevance-engine>2. Context Filter (Relevance Engine)<a class=headerlink href=#2-context-filter-relevance-engine title="Permanent link">&para;</a></h4><p><strong>Responsibilities:</strong> - Analyze task requirements to determine relevant files - Apply relevance scoring algorithms - Filter out noise while preserving critical dependencies - Handle cross-story context isolation</p><p><strong>Filtering Strategies:</strong> - <strong>Direct Relevance</strong>: Files explicitly mentioned in task or tests - <strong>Dependency Analysis</strong>: Static analysis of imports and references - <strong>Historical Relevance</strong>: Files frequently accessed in similar tasks - <strong>Semantic Similarity</strong>: Content similarity to current task description - <strong>TDD Phase Relevance</strong>: Phase-specific context requirements</p><h4 id=3-token-calculator-budget-manager>3. Token Calculator (Budget Manager)<a class=headerlink href=#3-token-calculator-budget-manager title="Permanent link">&para;</a></h4><p><strong>Responsibilities:</strong> - Calculate token usage for context components - Optimize context selection within budget constraints - Provide token usage analytics and warnings - Handle budget allocation across context types</p><p><strong>Budget Allocation Strategy:</strong><div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><a href=#__codelineno-1-1><span class=linenos data-linenos="1 "></span></a>Total Budget: ~200k tokens
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a><a href=#__codelineno-1-2><span class=linenos data-linenos="2 "></span></a>- Core Task Context: 40% (80k tokens)
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a><a href=#__codelineno-1-3><span class=linenos data-linenos="3 "></span></a>- Historical Context: 25% (50k tokens)  
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a><a href=#__codelineno-1-4><span class=linenos data-linenos="4 "></span></a>- Dependency Context: 20% (40k tokens)
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5></a><a href=#__codelineno-1-5><span class=linenos data-linenos="5 "></span></a>- Agent Memory: 10% (20k tokens)
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6></a><a href=#__codelineno-1-6><span class=linenos data-linenos="6 "></span></a>- Buffer/Metadata: 5% (10k tokens)
</span></code></pre></div></p><h4 id=4-agent-memory-persistent-context>4. Agent Memory (Persistent Context)<a class=headerlink href=#4-agent-memory-persistent-context title="Permanent link">&para;</a></h4><p><strong>Responsibilities:</strong> - Store agent decisions, rationale, and learned patterns - Maintain context across TDD phases and sessions - Track evolution of understanding over time - Provide context inheritance between phases</p><p><strong>Memory Structure:</strong><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><a href=#__codelineno-2-1><span class=linenos data-linenos="1 "></span></a><span class=nd>@dataclass</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2></a><a href=#__codelineno-2-2><span class=linenos data-linenos="2 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>AgentMemory</span><span class=p>:</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3></a><a href=#__codelineno-2-3><span class=linenos data-linenos="3 "></span></a>    <span class=n>agent_type</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4></a><a href=#__codelineno-2-4><span class=linenos data-linenos="4 "></span></a>    <span class=n>story_id</span><span class=p>:</span> <span class=nb>str</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5></a><a href=#__codelineno-2-5><span class=linenos data-linenos="5 "></span></a>    <span class=n>decisions</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Decision</span><span class=p>]</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6></a><a href=#__codelineno-2-6><span class=linenos data-linenos="6 "></span></a>    <span class=n>artifacts</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7></a><a href=#__codelineno-2-7><span class=linenos data-linenos="7 "></span></a>    <span class=n>learned_patterns</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Pattern</span><span class=p>]</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8></a><a href=#__codelineno-2-8><span class=linenos data-linenos="8 "></span></a>    <span class=n>context_history</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ContextSnapshot</span><span class=p>]</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9></a><a href=#__codelineno-2-9><span class=linenos data-linenos="9 "></span></a>    <span class=n>phase_handoffs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>PhaseHandoff</span><span class=p>]</span>
</span></code></pre></div></p><h4 id=5-context-compressor-intelligent-summarization>5. Context Compressor (Intelligent Summarization)<a class=headerlink href=#5-context-compressor-intelligent-summarization title="Permanent link">&para;</a></h4><p><strong>Responsibilities:</strong> - Compress large files into relevant summaries - Maintain semantic meaning while reducing token count - Apply compression strategies based on content type - Preserve critical information for agent tasks</p><p><strong>Compression Techniques:</strong> - <strong>Code Summarization</strong>: Extract signatures, docstrings, key logic - <strong>Test Summarization</strong>: Preserve test intent and assertions - <strong>Documentation Compression</strong>: Extract key requirements and specs - <strong>Git History Compression</strong>: Relevant commits and change patterns</p><h4 id=6-context-index-search-and-discovery>6. Context Index (Search and Discovery)<a class=headerlink href=#6-context-index-search-and-discovery title="Permanent link">&para;</a></h4><p><strong>Responsibilities:</strong> - Build searchable indexes of codebase content - Enable fast lookup of relevant code sections - Track file relationships and dependencies - Support semantic search for context discovery</p><h2 id=data-flow-diagrams>Data Flow Diagrams<a class=headerlink href=#data-flow-diagrams title="Permanent link">&para;</a></h2><h3 id=context-preparation-flow>Context Preparation Flow<a class=headerlink href=#context-preparation-flow title="Permanent link">&para;</a></h3><pre class=mermaid><code>sequenceDiagram
    participant O as Orchestrator
    participant CM as Context Manager
    participant CF as Context Filter
    participant TC as Token Calculator
    participant CC as Context Compressor
    participant AM as Agent Memory
    participant A as Agent

    O-&gt;&gt;CM: prepare_context(agent_type, task, max_tokens)
    CM-&gt;&gt;CF: filter_relevant_files(task, story_id)
    CF-&gt;&gt;CM: relevant_files[]
    CM-&gt;&gt;TC: calculate_token_budget(relevant_files, max_tokens)
    TC-&gt;&gt;CM: budget_allocation
    CM-&gt;&gt;CC: compress_if_needed(files, budget)
    CC-&gt;&gt;CM: compressed_context
    CM-&gt;&gt;AM: get_agent_memory(agent_type, story_id)
    AM-&gt;&gt;CM: agent_memory
    CM-&gt;&gt;CM: assemble_final_context()
    CM-&gt;&gt;O: agent_context
    O-&gt;&gt;A: execute_task(context)</code></pre><h3 id=agent-handoff-flow>Agent Handoff Flow<a class=headerlink href=#agent-handoff-flow title="Permanent link">&para;</a></h3><pre class=mermaid><code>sequenceDiagram
    participant DA as Design Agent
    participant CM as Context Manager
    participant AM as Agent Memory
    participant QA as QA Agent

    DA-&gt;&gt;CM: complete_phase(design_artifacts)
    CM-&gt;&gt;AM: store_artifacts(design_artifacts)
    AM-&gt;&gt;CM: artifacts_stored
    CM-&gt;&gt;CM: prepare_handoff_context(DESIGN-&gt;TEST_RED)
    CM-&gt;&gt;QA: provide_context(design_context + requirements)
    QA-&gt;&gt;CM: request_additional_context(specific_files)
    CM-&gt;&gt;QA: filtered_context(specific_files)</code></pre><h2 id=implementation-strategy>Implementation Strategy<a class=headerlink href=#implementation-strategy title="Permanent link">&para;</a></h2><h3 id=phase-1-core-infrastructure-weeks-1-2>Phase 1: Core Infrastructure (Weeks 1-2)<a class=headerlink href=#phase-1-core-infrastructure-weeks-1-2 title="Permanent link">&para;</a></h3><ol><li><strong>Context Manager</strong>: Central coordination component</li><li><strong>Basic Token Calculator</strong>: Simple token counting and budget allocation</li><li><strong>File System Interface</strong>: Direct file access and basic caching</li><li><strong>Agent Memory Storage</strong>: Simple JSON-based persistence</li></ol><h3 id=phase-2-intelligence-layer-weeks-3-4>Phase 2: Intelligence Layer (Weeks 3-4)<a class=headerlink href=#phase-2-intelligence-layer-weeks-3-4 title="Permanent link">&para;</a></h3><ol><li><strong>Context Filter</strong>: Relevance scoring and file filtering</li><li><strong>Context Compressor</strong>: Basic summarization for code and docs</li><li><strong>Context Index</strong>: File relationship mapping and search</li><li><strong>Agent Memory Intelligence</strong>: Pattern recognition and learning</li></ol><h3 id=phase-3-optimization-weeks-5-6>Phase 3: Optimization (Weeks 5-6)<a class=headerlink href=#phase-3-optimization-weeks-5-6 title="Permanent link">&para;</a></h3><ol><li><strong>Advanced Compression</strong>: ML-based summarization</li><li><strong>Predictive Caching</strong>: Anticipate context needs</li><li><strong>Performance Optimization</strong>: Caching strategies and performance tuning</li><li><strong>Cross-Story Context</strong>: Handle multiple concurrent stories</li></ol><h3 id=phase-4-advanced-features-weeks-7-8>Phase 4: Advanced Features (Weeks 7-8)<a class=headerlink href=#phase-4-advanced-features-weeks-7-8 title="Permanent link">&para;</a></h3><ol><li><strong>Semantic Search</strong>: Content-based context discovery</li><li><strong>Auto-tuning</strong>: Dynamic optimization based on usage patterns</li><li><strong>Integration Testing</strong>: End-to-end TDD workflow validation</li><li><strong>Documentation and Training</strong>: Complete system documentation</li></ol><h2 id=algorithm-designs>Algorithm Designs<a class=headerlink href=#algorithm-designs title="Permanent link">&para;</a></h2><h3 id=relevance-scoring-algorithm>Relevance Scoring Algorithm<a class=headerlink href=#relevance-scoring-algorithm title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><a href=#__codelineno-3-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>calculate_relevance_score</span><span class=p>(</span><span class=n>file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>task</span><span class=p>:</span> <span class=n>TDDTask</span><span class=p>,</span> <span class=n>story_context</span><span class=p>:</span> <span class=n>Dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a><a href=#__codelineno-3-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Calculate relevance score (0-1) for a file given current task&quot;&quot;&quot;</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><a href=#__codelineno-3-3><span class=linenos data-linenos=" 3 "></span></a>    <span class=n>score</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4></a><a href=#__codelineno-3-4><span class=linenos data-linenos=" 4 "></span></a>    
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5></a><a href=#__codelineno-3-5><span class=linenos data-linenos=" 5 "></span></a>    <span class=c1># Direct mention in task (40% weight)</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6></a><a href=#__codelineno-3-6><span class=linenos data-linenos=" 6 "></span></a>    <span class=k>if</span> <span class=n>file_mentioned_in_task</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>task</span><span class=p>):</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7></a><a href=#__codelineno-3-7><span class=linenos data-linenos=" 7 "></span></a>        <span class=n>score</span> <span class=o>+=</span> <span class=mf>0.4</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8></a><a href=#__codelineno-3-8><span class=linenos data-linenos=" 8 "></span></a>    
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9></a><a href=#__codelineno-3-9><span class=linenos data-linenos=" 9 "></span></a>    <span class=c1># Dependency analysis (25% weight)  </span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10></a><a href=#__codelineno-3-10><span class=linenos data-linenos="10 "></span></a>    <span class=n>dependency_score</span> <span class=o>=</span> <span class=n>analyze_dependencies</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>task</span><span class=o>.</span><span class=n>source_files</span><span class=p>)</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11></a><a href=#__codelineno-3-11><span class=linenos data-linenos="11 "></span></a>    <span class=n>score</span> <span class=o>+=</span> <span class=mf>0.25</span> <span class=o>*</span> <span class=n>dependency_score</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12></a><a href=#__codelineno-3-12><span class=linenos data-linenos="12 "></span></a>    
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13></a><a href=#__codelineno-3-13><span class=linenos data-linenos="13 "></span></a>    <span class=c1># Historical relevance (20% weight)</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14></a><a href=#__codelineno-3-14><span class=linenos data-linenos="14 "></span></a>    <span class=n>historical_score</span> <span class=o>=</span> <span class=n>get_historical_relevance</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>task</span><span class=o>.</span><span class=n>agent_type</span><span class=p>)</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15></a><a href=#__codelineno-3-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>score</span> <span class=o>+=</span> <span class=mf>0.20</span> <span class=o>*</span> <span class=n>historical_score</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16></a><a href=#__codelineno-3-16><span class=linenos data-linenos="16 "></span></a>    
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17></a><a href=#__codelineno-3-17><span class=linenos data-linenos="17 "></span></a>    <span class=c1># Semantic similarity (10% weight)</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18></a><a href=#__codelineno-3-18><span class=linenos data-linenos="18 "></span></a>    <span class=n>semantic_score</span> <span class=o>=</span> <span class=n>calculate_semantic_similarity</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>task</span><span class=o>.</span><span class=n>description</span><span class=p>)</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19></a><a href=#__codelineno-3-19><span class=linenos data-linenos="19 "></span></a>    <span class=n>score</span> <span class=o>+=</span> <span class=mf>0.10</span> <span class=o>*</span> <span class=n>semantic_score</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20></a><a href=#__codelineno-3-20><span class=linenos data-linenos="20 "></span></a>    
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21></a><a href=#__codelineno-3-21><span class=linenos data-linenos="21 "></span></a>    <span class=c1># TDD phase relevance (5% weight)</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22></a><a href=#__codelineno-3-22><span class=linenos data-linenos="22 "></span></a>    <span class=n>phase_score</span> <span class=o>=</span> <span class=n>get_phase_relevance</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>task</span><span class=o>.</span><span class=n>current_state</span><span class=p>)</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23></a><a href=#__codelineno-3-23><span class=linenos data-linenos="23 "></span></a>    <span class=n>score</span> <span class=o>+=</span> <span class=mf>0.05</span> <span class=o>*</span> <span class=n>phase_score</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24></a><a href=#__codelineno-3-24><span class=linenos data-linenos="24 "></span></a>    
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25></a><a href=#__codelineno-3-25><span class=linenos data-linenos="25 "></span></a>    <span class=k>return</span> <span class=nb>min</span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>score</span><span class=p>)</span>
</span></code></pre></div><h3 id=context-compression-algorithm>Context Compression Algorithm<a class=headerlink href=#context-compression-algorithm title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><a href=#__codelineno-4-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>compress_file_content</span><span class=p>(</span><span class=n>content</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>target_tokens</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>file_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><a href=#__codelineno-4-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Compress file content to target token count while preserving meaning&quot;&quot;&quot;</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a><a href=#__codelineno-4-3><span class=linenos data-linenos=" 3 "></span></a>    
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a><a href=#__codelineno-4-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>if</span> <span class=n>file_type</span> <span class=o>==</span> <span class=s2>&quot;python&quot;</span><span class=p>:</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><a href=#__codelineno-4-5><span class=linenos data-linenos=" 5 "></span></a>        <span class=k>return</span> <span class=n>compress_python_code</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>target_tokens</span><span class=p>)</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a><a href=#__codelineno-4-6><span class=linenos data-linenos=" 6 "></span></a>    <span class=k>elif</span> <span class=n>file_type</span> <span class=o>==</span> <span class=s2>&quot;test&quot;</span><span class=p>:</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a><a href=#__codelineno-4-7><span class=linenos data-linenos=" 7 "></span></a>        <span class=k>return</span> <span class=n>compress_test_file</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>target_tokens</span><span class=p>)</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8></a><a href=#__codelineno-4-8><span class=linenos data-linenos=" 8 "></span></a>    <span class=k>elif</span> <span class=n>file_type</span> <span class=o>==</span> <span class=s2>&quot;markdown&quot;</span><span class=p>:</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9></a><a href=#__codelineno-4-9><span class=linenos data-linenos=" 9 "></span></a>        <span class=k>return</span> <span class=n>compress_documentation</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>target_tokens</span><span class=p>)</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10></a><a href=#__codelineno-4-10><span class=linenos data-linenos="10 "></span></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11></a><a href=#__codelineno-4-11><span class=linenos data-linenos="11 "></span></a>        <span class=k>return</span> <span class=n>compress_generic_text</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>target_tokens</span><span class=p>)</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12></a><a href=#__codelineno-4-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13></a><a href=#__codelineno-4-13><span class=linenos data-linenos="13 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>compress_python_code</span><span class=p>(</span><span class=n>content</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>target_tokens</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14></a><a href=#__codelineno-4-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Python-specific compression preserving structure and key logic&quot;&quot;&quot;</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15></a><a href=#__codelineno-4-15><span class=linenos data-linenos="15 "></span></a>    <span class=n>ast_tree</span> <span class=o>=</span> <span class=n>ast</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16></a><a href=#__codelineno-4-16><span class=linenos data-linenos="16 "></span></a>    
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17></a><a href=#__codelineno-4-17><span class=linenos data-linenos="17 "></span></a>    <span class=c1># Extract critical elements</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18></a><a href=#__codelineno-4-18><span class=linenos data-linenos="18 "></span></a>    <span class=n>imports</span> <span class=o>=</span> <span class=n>extract_imports</span><span class=p>(</span><span class=n>ast_tree</span><span class=p>)</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19></a><a href=#__codelineno-4-19><span class=linenos data-linenos="19 "></span></a>    <span class=n>class_signatures</span> <span class=o>=</span> <span class=n>extract_class_signatures</span><span class=p>(</span><span class=n>ast_tree</span><span class=p>)</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20></a><a href=#__codelineno-4-20><span class=linenos data-linenos="20 "></span></a>    <span class=n>method_signatures</span> <span class=o>=</span> <span class=n>extract_method_signatures</span><span class=p>(</span><span class=n>ast_tree</span><span class=p>)</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21></a><a href=#__codelineno-4-21><span class=linenos data-linenos="21 "></span></a>    <span class=n>key_logic</span> <span class=o>=</span> <span class=n>extract_key_logic_blocks</span><span class=p>(</span><span class=n>ast_tree</span><span class=p>)</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22></a><a href=#__codelineno-4-22><span class=linenos data-linenos="22 "></span></a>    
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23></a><a href=#__codelineno-4-23><span class=linenos data-linenos="23 "></span></a>    <span class=c1># Reconstruct with compression</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24></a><a href=#__codelineno-4-24><span class=linenos data-linenos="24 "></span></a>    <span class=n>compressed</span> <span class=o>=</span> <span class=n>rebuild_compressed_code</span><span class=p>(</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25></a><a href=#__codelineno-4-25><span class=linenos data-linenos="25 "></span></a>        <span class=n>imports</span><span class=p>,</span> <span class=n>class_signatures</span><span class=p>,</span> <span class=n>method_signatures</span><span class=p>,</span> <span class=n>key_logic</span><span class=p>,</span> <span class=n>target_tokens</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26></a><a href=#__codelineno-4-26><span class=linenos data-linenos="26 "></span></a>    <span class=p>)</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27></a><a href=#__codelineno-4-27><span class=linenos data-linenos="27 "></span></a>    
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28></a><a href=#__codelineno-4-28><span class=linenos data-linenos="28 "></span></a>    <span class=k>return</span> <span class=n>compressed</span>
</span></code></pre></div><h3 id=token-budget-allocation-algorithm>Token Budget Allocation Algorithm<a class=headerlink href=#token-budget-allocation-algorithm title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><a href=#__codelineno-5-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>allocate_token_budget</span><span class=p>(</span><span class=n>total_budget</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>context_components</span><span class=p>:</span> <span class=n>Dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a><a href=#__codelineno-5-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Dynamically allocate token budget based on task priority and available content&quot;&quot;&quot;</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><a href=#__codelineno-5-3><span class=linenos data-linenos=" 3 "></span></a>    
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><a href=#__codelineno-5-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=n>allocation</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a><a href=#__codelineno-5-5><span class=linenos data-linenos=" 5 "></span></a>    
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a><a href=#__codelineno-5-6><span class=linenos data-linenos=" 6 "></span></a>    <span class=c1># Base allocation percentages</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><a href=#__codelineno-5-7><span class=linenos data-linenos=" 7 "></span></a>    <span class=n>base_allocations</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a><a href=#__codelineno-5-8><span class=linenos data-linenos=" 8 "></span></a>        <span class=s2>&quot;core_task&quot;</span><span class=p>:</span> <span class=mf>0.40</span><span class=p>,</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><a href=#__codelineno-5-9><span class=linenos data-linenos=" 9 "></span></a>        <span class=s2>&quot;historical&quot;</span><span class=p>:</span> <span class=mf>0.25</span><span class=p>,</span> 
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><a href=#__codelineno-5-10><span class=linenos data-linenos="10 "></span></a>        <span class=s2>&quot;dependencies&quot;</span><span class=p>:</span> <span class=mf>0.20</span><span class=p>,</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><a href=#__codelineno-5-11><span class=linenos data-linenos="11 "></span></a>        <span class=s2>&quot;agent_memory&quot;</span><span class=p>:</span> <span class=mf>0.10</span><span class=p>,</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12></a><a href=#__codelineno-5-12><span class=linenos data-linenos="12 "></span></a>        <span class=s2>&quot;buffer&quot;</span><span class=p>:</span> <span class=mf>0.05</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13></a><a href=#__codelineno-5-13><span class=linenos data-linenos="13 "></span></a>    <span class=p>}</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14></a><a href=#__codelineno-5-14><span class=linenos data-linenos="14 "></span></a>    
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15></a><a href=#__codelineno-5-15><span class=linenos data-linenos="15 "></span></a>    <span class=c1># Adjust based on context availability</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16></a><a href=#__codelineno-5-16><span class=linenos data-linenos="16 "></span></a>    <span class=k>for</span> <span class=n>component</span><span class=p>,</span> <span class=n>base_pct</span> <span class=ow>in</span> <span class=n>base_allocations</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17></a><a href=#__codelineno-5-17><span class=linenos data-linenos="17 "></span></a>        <span class=n>available_content</span> <span class=o>=</span> <span class=n>context_components</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>component</span><span class=p>,</span> <span class=p>{})</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18></a><a href=#__codelineno-5-18><span class=linenos data-linenos="18 "></span></a>        
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19></a><a href=#__codelineno-5-19><span class=linenos data-linenos="19 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>available_content</span><span class=p>:</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20></a><a href=#__codelineno-5-20><span class=linenos data-linenos="20 "></span></a>            <span class=c1># Redistribute unused allocation</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21></a><a href=#__codelineno-5-21><span class=linenos data-linenos="21 "></span></a>            <span class=n>base_allocations</span> <span class=o>=</span> <span class=n>redistribute_unused_allocation</span><span class=p>(</span><span class=n>base_allocations</span><span class=p>,</span> <span class=n>component</span><span class=p>)</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22></a><a href=#__codelineno-5-22><span class=linenos data-linenos="22 "></span></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23></a><a href=#__codelineno-5-23><span class=linenos data-linenos="23 "></span></a>            <span class=c1># Calculate actual need vs available content</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24></a><a href=#__codelineno-5-24><span class=linenos data-linenos="24 "></span></a>            <span class=n>content_size</span> <span class=o>=</span> <span class=n>estimate_token_size</span><span class=p>(</span><span class=n>available_content</span><span class=p>)</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25></a><a href=#__codelineno-5-25><span class=linenos data-linenos="25 "></span></a>            <span class=n>base_allocation</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>total_budget</span> <span class=o>*</span> <span class=n>base_pct</span><span class=p>)</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26></a><a href=#__codelineno-5-26><span class=linenos data-linenos="26 "></span></a>            
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27></a><a href=#__codelineno-5-27><span class=linenos data-linenos="27 "></span></a>            <span class=c1># Don&#39;t over-allocate if content is smaller than allocation</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28></a><a href=#__codelineno-5-28><span class=linenos data-linenos="28 "></span></a>            <span class=n>allocation</span><span class=p>[</span><span class=n>component</span><span class=p>]</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>base_allocation</span><span class=p>,</span> <span class=n>content_size</span><span class=p>)</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29></a><a href=#__codelineno-5-29><span class=linenos data-linenos="29 "></span></a>    
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30></a><a href=#__codelineno-5-30><span class=linenos data-linenos="30 "></span></a>    <span class=k>return</span> <span class=n>allocation</span>
</span></code></pre></div><h2 id=performance-requirements>Performance Requirements<a class=headerlink href=#performance-requirements title="Permanent link">&para;</a></h2><h3 id=latency-targets>Latency Targets<a class=headerlink href=#latency-targets title="Permanent link">&para;</a></h3><ul><li><strong>Context Preparation</strong>: &lt; 2 seconds for typical tasks</li><li><strong>Agent Handoff</strong>: &lt; 1 second for artifact transfer</li><li><strong>Context Invalidation</strong>: &lt; 500ms for cache updates</li><li><strong>Memory Retrieval</strong>: &lt; 100ms for agent memory access</li></ul><h3 id=throughput-targets>Throughput Targets<a class=headerlink href=#throughput-targets title="Permanent link">&para;</a></h3><ul><li><strong>Concurrent Contexts</strong>: Support 10+ parallel TDD cycles</li><li><strong>File Processing</strong>: 1000+ files/second for relevance scoring</li><li><strong>Compression</strong>: 100KB/second sustained compression rate</li><li><strong>Cache Hit Rate</strong>: &gt;80% for repeated context requests</li></ul><h3 id=scalability-targets>Scalability Targets<a class=headerlink href=#scalability-targets title="Permanent link">&para;</a></h3><ul><li><strong>Codebase Size</strong>: Support projects with 100k+ lines of code</li><li><strong>Context History</strong>: 1000+ context snapshots per story</li><li><strong>Agent Memory</strong>: 10MB+ per agent across all stories</li><li><strong>File Index</strong>: 50k+ files with sub-second search</li></ul><h2 id=error-handling-strategy>Error Handling Strategy<a class=headerlink href=#error-handling-strategy title="Permanent link">&para;</a></h2><h3 id=graceful-degradation>Graceful Degradation<a class=headerlink href=#graceful-degradation title="Permanent link">&para;</a></h3><ol><li><strong>Token Limit Exceeded</strong>: Automatic compression and pruning</li><li><strong>Context Service Unavailable</strong>: Fall back to basic file access</li><li><strong>Memory Corruption</strong>: Rebuild from artifacts and git history</li><li><strong>Index Corruption</strong>: Rebuild from filesystem scan</li></ol><h3 id=recovery-mechanisms>Recovery Mechanisms<a class=headerlink href=#recovery-mechanisms title="Permanent link">&para;</a></h3><ol><li><strong>Context Snapshots</strong>: Regular snapshots for quick recovery</li><li><strong>Incremental Rebuilds</strong>: Rebuild only affected components</li><li><strong>Fallback Modes</strong>: Progressively simpler context provision</li><li><strong>Health Monitoring</strong>: Continuous monitoring with automatic recovery</li></ol><h2 id=evaluation-framework>Evaluation Framework<a class=headerlink href=#evaluation-framework title="Permanent link">&para;</a></h2><h3 id=success-metrics>Success Metrics<a class=headerlink href=#success-metrics title="Permanent link">&para;</a></h3><h4 id=efficiency-metrics>Efficiency Metrics<a class=headerlink href=#efficiency-metrics title="Permanent link">&para;</a></h4><ul><li><strong>Context Relevance</strong>: &gt;95% of provided context is used by agents</li><li><strong>Token Utilization</strong>: &gt;90% of allocated tokens are effectively used</li><li><strong>Redundancy Reduction</strong>: &lt;5% duplicate information in context</li><li><strong>Preparation Speed</strong>: Context preparation within latency targets</li></ul><h4 id=quality-metrics>Quality Metrics<a class=headerlink href=#quality-metrics title="Permanent link">&para;</a></h4><ul><li><strong>Agent Task Success</strong>: &gt;95% agent task completion rate</li><li><strong>Context Completeness</strong>: &lt;2% missing critical information</li><li><strong>Cross-Phase Continuity</strong>: &gt;98% successful phase handoffs</li><li><strong>Memory Accuracy</strong>: &gt;95% accurate agent memory retrieval</li></ul><h4 id=performance-metrics>Performance Metrics<a class=headerlink href=#performance-metrics title="Permanent link">&para;</a></h4><ul><li><strong>System Throughput</strong>: Support target concurrent operations</li><li><strong>Resource Utilization</strong>: &lt;70% CPU and memory usage</li><li><strong>Cache Effectiveness</strong>: &gt;80% cache hit rate</li><li><strong>Scalability</strong>: Linear performance degradation with codebase size</li></ul><h3 id=benchmarking-strategy>Benchmarking Strategy<a class=headerlink href=#benchmarking-strategy title="Permanent link">&para;</a></h3><h4 id=synthetic-benchmarks>Synthetic Benchmarks<a class=headerlink href=#synthetic-benchmarks title="Permanent link">&para;</a></h4><ul><li><strong>Token Budget Stress Tests</strong>: Extreme token limit scenarios</li><li><strong>Large Codebase Tests</strong>: 100k+ file repositories</li><li><strong>Concurrent Load Tests</strong>: Multiple parallel TDD cycles</li><li><strong>Memory Pressure Tests</strong>: Limited system memory scenarios</li></ul><h4 id=real-world-benchmarks>Real-World Benchmarks<a class=headerlink href=#real-world-benchmarks title="Permanent link">&para;</a></h4><ul><li><strong>Open Source Projects</strong>: Test on popular GitHub repositories</li><li><strong>Legacy Codebase</strong>: Test on complex, undocumented codebases</li><li><strong>Multi-Language</strong>: Test cross-language context management</li><li><strong>Long-Running Sessions</strong>: Extended TDD sessions over days</li></ul><h2 id=integration-points>Integration Points<a class=headerlink href=#integration-points title="Permanent link">&para;</a></h2><h3 id=claude-code-cli-integration>Claude Code CLI Integration<a class=headerlink href=#claude-code-cli-integration title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><a href=#__codelineno-6-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>ClaudeCodeContextProvider</span><span class=p>:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2></a><a href=#__codelineno-6-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Integration with Claude Code CLI for optimized prompts&quot;&quot;&quot;</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3></a><a href=#__codelineno-6-3><span class=linenos data-linenos=" 3 "></span></a>    
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4></a><a href=#__codelineno-6-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prepare_claude_prompt</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>context</span><span class=p>:</span> <span class=n>AgentContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5></a><a href=#__codelineno-6-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Prepare optimized prompt for Claude Code CLI&quot;&quot;&quot;</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6></a><a href=#__codelineno-6-6><span class=linenos data-linenos=" 6 "></span></a>        <span class=n>prompt_parts</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7></a><a href=#__codelineno-6-7><span class=linenos data-linenos=" 7 "></span></a>        
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8></a><a href=#__codelineno-6-8><span class=linenos data-linenos=" 8 "></span></a>        <span class=c1># Add core context with highest priority</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9></a><a href=#__codelineno-6-9><span class=linenos data-linenos=" 9 "></span></a>        <span class=n>prompt_parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;## Core Task Context</span><span class=se>\n</span><span class=si>{</span><span class=n>context</span><span class=o>.</span><span class=n>core_context</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10></a><a href=#__codelineno-6-10><span class=linenos data-linenos="10 "></span></a>        
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11></a><a href=#__codelineno-6-11><span class=linenos data-linenos="11 "></span></a>        <span class=c1># Add compressed dependencies </span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12></a><a href=#__codelineno-6-12><span class=linenos data-linenos="12 "></span></a>        <span class=k>if</span> <span class=n>context</span><span class=o>.</span><span class=n>dependencies</span><span class=p>:</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13></a><a href=#__codelineno-6-13><span class=linenos data-linenos="13 "></span></a>            <span class=n>prompt_parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;## Dependencies</span><span class=se>\n</span><span class=si>{</span><span class=n>context</span><span class=o>.</span><span class=n>dependencies</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14></a><a href=#__codelineno-6-14><span class=linenos data-linenos="14 "></span></a>        
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15></a><a href=#__codelineno-6-15><span class=linenos data-linenos="15 "></span></a>        <span class=c1># Add agent memory if relevant</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16></a><a href=#__codelineno-6-16><span class=linenos data-linenos="16 "></span></a>        <span class=k>if</span> <span class=n>context</span><span class=o>.</span><span class=n>agent_memory</span><span class=p>:</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17></a><a href=#__codelineno-6-17><span class=linenos data-linenos="17 "></span></a>            <span class=n>prompt_parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;## Previous Decisions</span><span class=se>\n</span><span class=si>{</span><span class=n>context</span><span class=o>.</span><span class=n>agent_memory</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18></a><a href=#__codelineno-6-18><span class=linenos data-linenos="18 "></span></a>        
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19></a><a href=#__codelineno-6-19><span class=linenos data-linenos="19 "></span></a>        <span class=c1># Add specific instructions based on TDD phase</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20></a><a href=#__codelineno-6-20><span class=linenos data-linenos="20 "></span></a>        <span class=n>phase_instructions</span> <span class=o>=</span> <span class=n>get_phase_specific_instructions</span><span class=p>(</span><span class=n>context</span><span class=o>.</span><span class=n>tdd_phase</span><span class=p>)</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21></a><a href=#__codelineno-6-21><span class=linenos data-linenos="21 "></span></a>        <span class=n>prompt_parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;## Phase Instructions</span><span class=se>\n</span><span class=si>{</span><span class=n>phase_instructions</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22></a><a href=#__codelineno-6-22><span class=linenos data-linenos="22 "></span></a>        
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23></a><a href=#__codelineno-6-23><span class=linenos data-linenos="23 "></span></a>        <span class=k>return</span> <span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>prompt_parts</span><span class=p>)</span>
</span></code></pre></div><h3 id=tdd-state-machine-integration>TDD State Machine Integration<a class=headerlink href=#tdd-state-machine-integration title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1></a><a href=#__codelineno-7-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span><span class=w> </span><span class=nc>TDDContextManager</span><span class=p>:</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2></a><a href=#__codelineno-7-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Integration with TDD state machine for phase-aware context&quot;&quot;&quot;</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3></a><a href=#__codelineno-7-3><span class=linenos data-linenos=" 3 "></span></a>    
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4></a><a href=#__codelineno-7-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_phase_context_requirements</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>phase</span><span class=p>:</span> <span class=n>TDDState</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5></a><a href=#__codelineno-7-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Get context requirements specific to TDD phase&quot;&quot;&quot;</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6></a><a href=#__codelineno-7-6><span class=linenos data-linenos=" 6 "></span></a>        <span class=n>requirements</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7></a><a href=#__codelineno-7-7><span class=linenos data-linenos=" 7 "></span></a>            <span class=n>TDDState</span><span class=o>.</span><span class=n>DESIGN</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8></a><a href=#__codelineno-7-8><span class=linenos data-linenos=" 8 "></span></a>                <span class=s2>&quot;focus&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;requirements&quot;</span><span class=p>,</span> <span class=s2>&quot;architecture&quot;</span><span class=p>,</span> <span class=s2>&quot;existing_patterns&quot;</span><span class=p>],</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9></a><a href=#__codelineno-7-9><span class=linenos data-linenos=" 9 "></span></a>                <span class=s2>&quot;exclude&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;implementation_details&quot;</span><span class=p>,</span> <span class=s2>&quot;test_specifics&quot;</span><span class=p>],</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10></a><a href=#__codelineno-7-10><span class=linenos data-linenos="10 "></span></a>                <span class=s2>&quot;compression_level&quot;</span><span class=p>:</span> <span class=s2>&quot;moderate&quot;</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11></a><a href=#__codelineno-7-11><span class=linenos data-linenos="11 "></span></a>            <span class=p>},</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12></a><a href=#__codelineno-7-12><span class=linenos data-linenos="12 "></span></a>            <span class=n>TDDState</span><span class=o>.</span><span class=n>TEST_RED</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13></a><a href=#__codelineno-7-13><span class=linenos data-linenos="13 "></span></a>                <span class=s2>&quot;focus&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;design_specs&quot;</span><span class=p>,</span> <span class=s2>&quot;acceptance_criteria&quot;</span><span class=p>,</span> <span class=s2>&quot;existing_tests&quot;</span><span class=p>],</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14></a><a href=#__codelineno-7-14><span class=linenos data-linenos="14 "></span></a>                <span class=s2>&quot;exclude&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;implementation_files&quot;</span><span class=p>],</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15></a><a href=#__codelineno-7-15><span class=linenos data-linenos="15 "></span></a>                <span class=s2>&quot;compression_level&quot;</span><span class=p>:</span> <span class=s2>&quot;low&quot;</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16></a><a href=#__codelineno-7-16><span class=linenos data-linenos="16 "></span></a>            <span class=p>},</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17></a><a href=#__codelineno-7-17><span class=linenos data-linenos="17 "></span></a>            <span class=n>TDDState</span><span class=o>.</span><span class=n>CODE_GREEN</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18></a><a href=#__codelineno-7-18><span class=linenos data-linenos="18 "></span></a>                <span class=s2>&quot;focus&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;failing_tests&quot;</span><span class=p>,</span> <span class=s2>&quot;minimal_examples&quot;</span><span class=p>,</span> <span class=s2>&quot;interfaces&quot;</span><span class=p>],</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19></a><a href=#__codelineno-7-19><span class=linenos data-linenos="19 "></span></a>                <span class=s2>&quot;exclude&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;refactoring_notes&quot;</span><span class=p>,</span> <span class=s2>&quot;performance_docs&quot;</span><span class=p>],</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20></a><a href=#__codelineno-7-20><span class=linenos data-linenos="20 "></span></a>                <span class=s2>&quot;compression_level&quot;</span><span class=p>:</span> <span class=s2>&quot;moderate&quot;</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21></a><a href=#__codelineno-7-21><span class=linenos data-linenos="21 "></span></a>            <span class=p>},</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22></a><a href=#__codelineno-7-22><span class=linenos data-linenos="22 "></span></a>            <span class=n>TDDState</span><span class=o>.</span><span class=n>REFACTOR</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23></a><a href=#__codelineno-7-23><span class=linenos data-linenos="23 "></span></a>                <span class=s2>&quot;focus&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;current_implementation&quot;</span><span class=p>,</span> <span class=s2>&quot;quality_patterns&quot;</span><span class=p>,</span> <span class=s2>&quot;best_practices&quot;</span><span class=p>],</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24></a><a href=#__codelineno-7-24><span class=linenos data-linenos="24 "></span></a>                <span class=s2>&quot;exclude&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;test_files&quot;</span><span class=p>],</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25></a><a href=#__codelineno-7-25><span class=linenos data-linenos="25 "></span></a>                <span class=s2>&quot;compression_level&quot;</span><span class=p>:</span> <span class=s2>&quot;high&quot;</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26></a><a href=#__codelineno-7-26><span class=linenos data-linenos="26 "></span></a>            <span class=p>},</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27></a><a href=#__codelineno-7-27><span class=linenos data-linenos="27 "></span></a>            <span class=n>TDDState</span><span class=o>.</span><span class=n>COMMIT</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28></a><a href=#__codelineno-7-28><span class=linenos data-linenos="28 "></span></a>                <span class=s2>&quot;focus&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;all_changes&quot;</span><span class=p>,</span> <span class=s2>&quot;commit_history&quot;</span><span class=p>,</span> <span class=s2>&quot;integration_tests&quot;</span><span class=p>],</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29></a><a href=#__codelineno-7-29><span class=linenos data-linenos="29 "></span></a>                <span class=s2>&quot;exclude&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;draft_files&quot;</span><span class=p>],</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30></a><a href=#__codelineno-7-30><span class=linenos data-linenos="30 "></span></a>                <span class=s2>&quot;compression_level&quot;</span><span class=p>:</span> <span class=s2>&quot;low&quot;</span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31></a><a href=#__codelineno-7-31><span class=linenos data-linenos="31 "></span></a>            <span class=p>}</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32></a><a href=#__codelineno-7-32><span class=linenos data-linenos="32 "></span></a>        <span class=p>}</span>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33></a><a href=#__codelineno-7-33><span class=linenos data-linenos="33 "></span></a>        <span class=k>return</span> <span class=n>requirements</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>phase</span><span class=p>,</span> <span class=p>{})</span>
</span></code></pre></div><h2 id=future-enhancements>Future Enhancements<a class=headerlink href=#future-enhancements title="Permanent link">&para;</a></h2><h3 id=machine-learning-integration>Machine Learning Integration<a class=headerlink href=#machine-learning-integration title="Permanent link">&para;</a></h3><ul><li><strong>Context Relevance ML</strong>: Train models on agent context usage patterns</li><li><strong>Compression Optimization</strong>: ML-powered compression for better semantic preservation</li><li><strong>Predictive Caching</strong>: Predict future context needs based on TDD patterns</li><li><strong>Agent Behavior Learning</strong>: Learn optimal context for each agent type</li></ul><h3 id=advanced-features>Advanced Features<a class=headerlink href=#advanced-features title="Permanent link">&para;</a></h3><ul><li><strong>Multi-Project Context</strong>: Share learnings across related projects</li><li><strong>Team Context Sharing</strong>: Share context insights across team members</li><li><strong>Real-time Collaboration</strong>: Support concurrent agent operations</li><li><strong>Version-Aware Context</strong>: Context management across git branches</li></ul><h3 id=performance-optimizations>Performance Optimizations<a class=headerlink href=#performance-optimizations title="Permanent link">&para;</a></h3><ul><li><strong>Distributed Context</strong>: Distribute context processing across nodes</li><li><strong>Streaming Context</strong>: Stream large contexts to agents incrementally</li><li><strong>Edge Caching</strong>: Cache contexts at network edges for global teams</li><li><strong>Hardware Acceleration</strong>: GPU acceleration for large-scale compression</li></ul><p>This Context Management System design provides the foundation for efficient agent communication while respecting Claude Code's token limitations. The system is designed to be extensible, performant, and maintainable while providing the intelligent context filtering necessary for effective TDD workflow execution.</p><aside class=md-source-file><span class=md-source-file__fact><span class=md-icon title="Last update"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 17, 2025 21:28:50 UTC">June 17, 2025 21:28:50</span></span><span class=md-source-file__fact><span class=md-icon title=Created><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 17, 2025 21:28:50 UTC">June 17, 2025 21:28:50</span></span></aside><form class=md-feedback name=feedback hidden><fieldset><legend class=md-feedback__title> Was this page helpful? </legend><div class=md-feedback__inner><div class=md-feedback__list><button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg></button><button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg></button></div><div class=md-feedback__note><div data-md-value=1 hidden> Thanks for your feedback! </div><div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by <a href="https://github.com/jmontp/agent-workflow/issues/new/?title=[Feedback]+%F0%9F%93%8A%20Context%20System+-+/architecture/context-management-system/" target=_blank rel=noopener>telling us what you found confusing</a>. </div></div></div></fieldset></form></article></div><script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button type=button class="md-top md-icon" data-md-component=top hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button></main><footer class=md-footer><nav class="md-footer__inner md-grid" aria-label=Footer><a href=../component-architecture/ class="md-footer__link md-footer__link--prev" aria-label="Previous: 🔧 Component Architecture"><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.41 16.58 10.83 12l4.58-4.59L14 6l-6 6 6 6z"/></svg></div><div class=md-footer__title><span class=md-footer__direction> Previous </span><div class=md-ellipsis> 🔧 Component Architecture </div></div></a><a href=../context-api-specification/ class="md-footer__link md-footer__link--next" aria-label="Next: 🔌 Context API Specification"><div class=md-footer__title><span class=md-footer__direction> Next </span><div class=md-ellipsis> 🔌 Context API Specification </div></div><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright></div><div class=md-social><a href=https://github.com/jmontp/agent-workflow target=_blank rel=noopener title="GitHub Repository" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></a><a href=https://jmontp.github.io/agent-workflow/ target=_blank rel=noopener title="Documentation Site" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a><a href=https://discord.gg/your-discord-server target=_blank rel=noopener title="Discord Community" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3c5.5 0 10 3.58 10 8s-4.5 8-10 8c-1.24 0-2.43-.18-3.53-.5C5.55 21 2 21 2 21c2.33-2.33 2.7-3.9 2.75-4.5C3.05 15.07 2 13.13 2 11c0-4.42 4.5-8 10-8"/></svg></a><a href=https://github.com/sponsors/jmontp target=_blank rel=noopener title=Sponsor class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53z"/></svg></a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><div class=md-progress data-md-component=progress role=progressbar></div><div class=md-consent data-md-component=consent id=__consent hidden><div class=md-consent__overlay></div><aside class=md-consent__inner><form class="md-consent__form md-grid md-typeset" name=consent><h4>Cookie consent</h4><p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p><input class=md-toggle type=checkbox id=__settings><div class=md-consent__settings><ul class=task-list><li class=task-list-item><label class=task-list-control><input type=checkbox name=analytics checked><span class=task-list-indicator></span> Google Analytics </label></li><li class=task-list-item><label class=task-list-control><input type=checkbox name=github checked><span class=task-list-indicator></span> GitHub </label></li></ul></div><div class=md-consent__controls><button class="md-button md-button--primary">Accept</button><button type=reset class="md-button md-button--primary">Reject</button><label class=md-button for=__settings>Manage settings</label></div></form></aside></div><script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script><script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": {"API": "api", "Architecture": "architecture", "CSS": "css", "Discord": "discord", "HTML5": "html", "JavaScript": "js", "Python": "python", "Scrum": "scrum", "TDD": "tdd"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.13a4f30d.min.js></script><script src=https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mtml-chtml.js></script><script src=../../js/mermaid-zoom.js></script><script src=../../js/universal-search.js></script><script src=../../js/enhanced-navigation.js></script><script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body></html>