<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Human-In-The-Loop orchestration framework for AI-assisted software development"><meta name=author content="AI Agent Workflow Team"><link href=https://jmontp.github.io/agent-workflow/architecture/component-architecture/ rel=canonical><link href=../system-overview/ rel=prev><link href=../context-management-system/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>üîß Component Architecture - AI Agent TDD-Scrum Workflow</title><link rel=stylesheet href=../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{.md-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.5%207A1.5%201.5%200%200%201%204%205.5%201.5%201.5%200%200%201%205.5%204%201.5%201.5%200%200%201%207%205.5%201.5%201.5%200%200%201%205.5%207m15.91%204.58-9-9C12.05%202.22%2011.55%202%2011%202H4c-1.11%200-2%20.89-2%202v7c0%20.55.22%201.05.59%201.41l8.99%209c.37.36.87.59%201.42.59s1.05-.23%201.41-.59l7-7c.37-.36.59-.86.59-1.41%200-.56-.23-1.06-.59-1.42%22/%3E%3C/svg%3E');}.md-tag.md-tag--html{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m12%2017.56%204.07-1.13.55-6.1H9.38L9.2%208.3h7.6l.2-1.99H7l.56%206.01h6.89l-.23%202.58-2.22.6-2.22-.6-.14-1.66h-2l.29%203.19zM4.07%203h15.86L18.5%2019.2%2012%2021l-6.5-1.8z%22/%3E%3C/svg%3E');}.md-tag.md-tag--js{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M3%203h18v18H3zm4.73%2015.04c.4.85%201.19%201.55%202.54%201.55%201.5%200%202.53-.8%202.53-2.55v-5.78h-1.7V17c0%20.86-.35%201.08-.9%201.08-.58%200-.82-.4-1.09-.87zm5.98-.18c.5.98%201.51%201.73%203.09%201.73%201.6%200%202.8-.83%202.8-2.36%200-1.41-.81-2.04-2.25-2.66l-.42-.18c-.73-.31-1.04-.52-1.04-1.02%200-.41.31-.73.81-.73.48%200%20.8.21%201.09.73l1.31-.87c-.55-.96-1.33-1.33-2.4-1.33-1.51%200-2.48.96-2.48%202.23%200%201.38.81%202.03%202.03%202.55l.42.18c.78.34%201.24.55%201.24%201.13%200%20.48-.45.83-1.15.83-.83%200-1.31-.43-1.67-1.03z%22/%3E%3C/svg%3E');}.md-tag.md-tag--css{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m5%203-.65%203.34h13.59L17.5%208.5H3.92l-.66%203.33h13.59l-.76%203.81-5.48%201.81-4.75-1.81.33-1.64H2.85l-.79%204%207.85%203%209.05-3%201.2-6.03.24-1.21L21.94%203z%22/%3E%3C/svg%3E');}.md-tag.md-tag--python{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M19.14%207.5A2.86%202.86%200%200%201%2022%2010.36v3.78A2.86%202.86%200%200%201%2019.14%2017H12c0%20.39.32.96.71.96H17v1.68a2.86%202.86%200%200%201-2.86%202.86H9.86A2.86%202.86%200%200%201%207%2019.64v-3.75a2.85%202.85%200%200%201%202.86-2.85h5.25a2.85%202.85%200%200%200%202.85-2.86V7.5zm-4.28%2011.79c-.4%200-.72.3-.72.89s.32.71.72.71a.71.71%200%200%200%20.71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86%202.86%200%200%201%202%2014.64v-3.78A2.86%202.86%200%200%201%204.86%208H12c0-.39-.32-.96-.71-.96H7V5.36A2.86%202.86%200%200%201%209.86%202.5h4.28A2.86%202.86%200%200%201%2017%205.36v3.75a2.85%202.85%200%200%201-2.86%202.85H8.89a2.85%202.85%200%200%200-2.85%202.86v2.68zM9.14%205.71c.4%200%20.72-.3.72-.89s-.32-.71-.72-.71c-.39%200-.71.12-.71.71s.32.89.71.89%22/%3E%3C/svg%3E');}}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href=../../stylesheets/enhanced-navigation.css><link rel=stylesheet href=../../stylesheets/color-schemes.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head><body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off><input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off><label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#component-architecture class=md-skip> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=../.. title="AI Agent TDD-Scrum Workflow" class="md-header__button md-logo" aria-label="AI Agent TDD-Scrum Workflow" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a><label class="md-header__button md-icon" for=__drawer><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> AI Agent TDD-Scrum Workflow </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> üîß Component Architecture </span></div></div></div><form class=md-header__option data-md-component=palette><input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label><input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><div class=md-header__option><div class=md-select><button class="md-header__button md-icon" aria-label="Select language"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg></button><div class=md-select__inner><ul class=md-select__list><li class=md-select__item><a href=../../ hreflang=en class=md-select__link> English </a></li></ul></div></div></div><label class="md-header__button md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required><label class="md-search__icon md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.41 16.58 10.83 12l4.58-4.59L14 6l-6 6 6 6z"/></svg></label><nav class=md-search__options aria-label=Search><a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg></a><button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap tabindex=0 data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta> Initializing search </div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a href=https://github.com/jmontp/agent-workflow title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></div><div class=md-source__repository> jmontp/agent-workflow </div></a></div></nav><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a href=../.. class=md-tabs__link> üè† Home </a></li><li class=md-tabs__item><a href=../../getting-started/ class=md-tabs__link> ‚ö° Getting Started </a></li><li class=md-tabs__item><a href=../../user-guide/ class=md-tabs__link> üìä User Guide </a></li><li class=md-tabs__item><a href=../../concepts/ class=md-tabs__link> üéØ Core Concepts </a></li><li class="md-tabs__item md-tabs__item--active"><a href=../ class=md-tabs__link> üî• Architecture </a></li><li class=md-tabs__item><a href=../../advanced/ class=md-tabs__link> ‚ö° Advanced Topics </a></li><li class=md-tabs__item><a href=../../planning/ class=md-tabs__link> üé® Planning & Design </a></li><li class=md-tabs__item><a href=../../development/ class=md-tabs__link> üìä Development </a></li><li class=md-tabs__item><a href=../../deployment/ class=md-tabs__link> üî• Deployment </a></li><li class=md-tabs__item><a href=../../templates/ class=md-tabs__link> üìã Templates </a></li><li class=md-tabs__item><a href=../../theme-integration-guide/ class=md-tabs__link> üé® Theme Integration </a></li></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=../.. title="AI Agent TDD-Scrum Workflow" class="md-nav__button md-logo" aria-label="AI Agent TDD-Scrum Workflow" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a> AI Agent TDD-Scrum Workflow </label><div class=md-nav__source><a href=https://github.com/jmontp/agent-workflow title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></div><div class=md-source__repository> jmontp/agent-workflow </div></a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../.. class=md-nav__link><span class=md-ellipsis> üè† Home </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../getting-started/ class=md-nav__link><span class=md-ellipsis> ‚ö° Getting Started </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../user-guide/ class=md-nav__link><span class=md-ellipsis> üìä User Guide </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../concepts/ class=md-nav__link><span class=md-ellipsis> üéØ Core Concepts </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked><div class="md-nav__link md-nav__container"><a href=../ class="md-nav__link "><span class=md-ellipsis> üî• Architecture </span></a><label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span> üî• Architecture </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../system-overview/ class=md-nav__link><span class=md-ellipsis> üèóÔ∏è System Overview </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" type=checkbox id=__toc><label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> üîß Component Architecture </span><span class="md-nav__icon md-icon"></span></label><a href=./ class="md-nav__link md-nav__link--active"><span class=md-ellipsis> üîß Component Architecture </span></a><nav class="md-nav md-nav--secondary" aria-label="On this page"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> On this page </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#state-machine-components class=md-nav__link><span class=md-ellipsis> State Machine Components </span></a><nav class=md-nav aria-label="State Machine Components"><ul class=md-nav__list><li class=md-nav__item><a href=#workflow-state-machine-architecture class=md-nav__link><span class=md-ellipsis> Workflow State Machine Architecture </span></a></li><li class=md-nav__item><a href=#tdd-state-machine-implementation class=md-nav__link><span class=md-ellipsis> TDD State Machine Implementation </span></a></li></ul></nav></li><li class=md-nav__item><a href=#agent-system-architecture class=md-nav__link><span class=md-ellipsis> Agent System Architecture </span></a><nav class=md-nav aria-label="Agent System Architecture"><ul class=md-nav__list><li class=md-nav__item><a href=#agent-hierarchy-and-specialization class=md-nav__link><span class=md-ellipsis> Agent Hierarchy and Specialization </span></a></li><li class=md-nav__item><a href=#agent-lifecycle-sequence class=md-nav__link><span class=md-ellipsis> Agent Lifecycle Sequence </span></a></li></ul></nav></li><li class=md-nav__item><a href=#context-management-system class=md-nav__link><span class=md-ellipsis> Context Management System </span></a><nav class=md-nav aria-label="Context Management System"><ul class=md-nav__list><li class=md-nav__item><a href=#context-architecture class=md-nav__link><span class=md-ellipsis> Context Architecture </span></a></li><li class=md-nav__item><a href=#context-flow-implementation class=md-nav__link><span class=md-ellipsis> Context Flow Implementation </span></a></li></ul></nav></li><li class=md-nav__item><a href=#resource-management-architecture class=md-nav__link><span class=md-ellipsis> Resource Management Architecture </span></a><nav class=md-nav aria-label="Resource Management Architecture"><ul class=md-nav__list><li class=md-nav__item><a href=#resource-scheduler-design class=md-nav__link><span class=md-ellipsis> Resource Scheduler Design </span></a></li><li class=md-nav__item><a href=#resource-allocation-algorithm class=md-nav__link><span class=md-ellipsis> Resource Allocation Algorithm </span></a></li></ul></nav></li><li class=md-nav__item><a href=#security-architecture-components class=md-nav__link><span class=md-ellipsis> Security Architecture Components </span></a><nav class=md-nav aria-label="Security Architecture Components"><ul class=md-nav__list><li class=md-nav__item><a href=#security-layer-implementation class=md-nav__link><span class=md-ellipsis> Security Layer Implementation </span></a></li><li class=md-nav__item><a href=#security-enforcement-flow class=md-nav__link><span class=md-ellipsis> Security Enforcement Flow </span></a></li></ul></nav></li><li class=md-nav__item><a href=#data-flow-architecture class=md-nav__link><span class=md-ellipsis> Data Flow Architecture </span></a><nav class=md-nav aria-label="Data Flow Architecture"><ul class=md-nav__list><li class=md-nav__item><a href=#complete-system-data-flow class=md-nav__link><span class=md-ellipsis> Complete System Data Flow </span></a></li><li class=md-nav__item><a href=#data-model-relationships class=md-nav__link><span class=md-ellipsis> Data Model Relationships </span></a></li></ul></nav></li><li class=md-nav__item><a href=#performance-optimization-architecture class=md-nav__link><span class=md-ellipsis> Performance Optimization Architecture </span></a><nav class=md-nav aria-label="Performance Optimization Architecture"><ul class=md-nav__list><li class=md-nav__item><a href=#caching-strategy class=md-nav__link><span class=md-ellipsis> Caching Strategy </span></a></li><li class=md-nav__item><a href=#performance-monitoring class=md-nav__link><span class=md-ellipsis> Performance Monitoring </span></a></li></ul></nav></li><li class=md-nav__item><a href=#error-handling-and-recovery class=md-nav__link><span class=md-ellipsis> Error Handling and Recovery </span></a><nav class=md-nav aria-label="Error Handling and Recovery"><ul class=md-nav__list><li class=md-nav__item><a href=#error-handling-architecture class=md-nav__link><span class=md-ellipsis> Error Handling Architecture </span></a></li><li class=md-nav__item><a href=#recovery-sequence class=md-nav__link><span class=md-ellipsis> Recovery Sequence </span></a></li></ul></nav></li><li class=md-nav__item><a href=#summary class=md-nav__link><span class=md-ellipsis> Summary </span></a></li></ul></nav></li><li class=md-nav__item><a href=../context-management-system/ class=md-nav__link><span class=md-ellipsis> üß† Context Management </span></a></li><li class=md-nav__item><a href=../context-api-specification/ class=md-nav__link><span class=md-ellipsis> Context API Specification </span></a></li><li class=md-nav__item><a href=../context-algorithms/ class=md-nav__link><span class=md-ellipsis> Context Algorithms </span></a></li><li class=md-nav__item><a href=../context-evaluation-framework/ class=md-nav__link><span class=md-ellipsis> Context Evaluation Framework </span></a></li><li class=md-nav__item><a href=../context-implementation-plan/ class=md-nav__link><span class=md-ellipsis> Context Implementation Plan </span></a></li><li class=md-nav__item><a href=../parallel-tdd-architecture/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Design </span></a></li><li class=md-nav__item><a href=../parallel-tdd-technical-specification/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Implementation </span></a></li><li class=md-nav__item><a href=../parallel-tdd-implementation-strategy/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Implementation Strategy </span></a></li><li class=md-nav__item><a href=../parallel-tdd-comprehensive-implementation-plan/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Comprehensive Plan </span></a></li><li class=md-nav__item><a href=../parallel-tdd-testing-strategy/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Testing Strategy </span></a></li><li class=md-nav__item><a href=../parallel-context-integration/ class=md-nav__link><span class=md-ellipsis> Parallel Context Integration </span></a></li><li class=md-nav__item><a href=../parallel-agent-pool-management/ class=md-nav__link><span class=md-ellipsis> Parallel Agent Pool Management </span></a></li><li class=md-nav__item><a href=../parallel-conflict-algorithms/ class=md-nav__link><span class=md-ellipsis> Parallel Conflict Resolution </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../advanced/ class=md-nav__link><span class=md-ellipsis> ‚ö° Advanced Topics </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../planning/ class=md-nav__link><span class=md-ellipsis> üé® Planning & Design </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../development/ class=md-nav__link><span class=md-ellipsis> üìä Development </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../deployment/ class=md-nav__link><span class=md-ellipsis> üî• Deployment </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../templates/ class=md-nav__link><span class=md-ellipsis> üìã Templates </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../theme-integration-guide/ class=md-nav__link><span class=md-ellipsis> üé® Theme Integration </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a href=https://github.com/jmontp/agent-workflow/edit/master/docs/architecture/component-architecture.md title="Edit this page" class="md-content__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg></a><a href=https://github.com/jmontp/agent-workflow/raw/master/docs/architecture/component-architecture.md title="View source of this page" class="md-content__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg></a><h1 id=component-architecture>Component Architecture<a class=headerlink href=#component-architecture title="Permanent link">&para;</a></h1><p>This document provides detailed technical architecture for each major component in the AI Agent TDD-Scrum Workflow system, including class diagrams, sequence diagrams, and implementation patterns.</p><h2 id=state-machine-components>State Machine Components<a class=headerlink href=#state-machine-components title="Permanent link">&para;</a></h2><h3 id=workflow-state-machine-architecture>Workflow State Machine Architecture<a class=headerlink href=#workflow-state-machine-architecture title="Permanent link">&para;</a></h3><p>The workflow state machine manages the high-level Scrum process with sophisticated state management:</p><pre class=mermaid><code>stateDiagram-v2
    [*] --&gt; IDLE: System Start
    
    IDLE --&gt; BACKLOG_READY: /epic created
    BACKLOG_READY --&gt; SPRINT_PLANNED: /sprint plan
    SPRINT_PLANNED --&gt; SPRINT_ACTIVE: /sprint start
    SPRINT_ACTIVE --&gt; SPRINT_REVIEW: All stories complete
    SPRINT_REVIEW --&gt; BACKLOG_READY: /sprint complete
    
    SPRINT_ACTIVE --&gt; SPRINT_ACTIVE: Story TDD cycles
    
    state SPRINT_ACTIVE {
        [*] --&gt; Orchestrating
        Orchestrating --&gt; ParallelTDD: Assign stories
        ParallelTDD --&gt; Monitoring: Track progress
        Monitoring --&gt; Orchestrating: Next story
        
        state ParallelTDD {
            [*] --&gt; StoryA
            [*] --&gt; StoryB
            [*] --&gt; StoryC
            
            state StoryA {
                [*] --&gt; Design_A
                Design_A --&gt; Test_A
                Test_A --&gt; Code_A
                Code_A --&gt; Refactor_A
                Refactor_A --&gt; [*]
            }
        }
    }
    
    IDLE --&gt; IDLE: Invalid commands
    BACKLOG_READY --&gt; BACKLOG_READY: /backlog operations
    SPRINT_PLANNED --&gt; SPRINT_PLANNED: /sprint adjust
    SPRINT_REVIEW --&gt; SPRINT_REVIEW: /review operations</code></pre><h3 id=tdd-state-machine-implementation>TDD State Machine Implementation<a class=headerlink href=#tdd-state-machine-implementation title="Permanent link">&para;</a></h3><p>Detailed implementation of the TDD state machine with error handling:</p><pre class=mermaid><code>classDiagram
    class TDDStateMachine {
        -story_id: str
        -current_phase: TDDPhase
        -agents: Dict[str, BaseAgent]
        -test_results: TestResults
        -retry_count: int
        -max_retries: int = 3
        
        +__init__(story_id: str, story: Story)
        +start(): void
        +transition(): bool
        +get_current_agent(): BaseAgent
        +handle_failure(): void
        +can_proceed(): bool
        +get_progress(): float
    }
    
    class TDDPhase {
        &lt;&lt;enumeration&gt;&gt;
        DESIGN
        TEST_RED
        CODE_GREEN
        REFACTOR
        COMMIT
        FAILED
        COMPLETED
    }
    
    class TestResults {
        -total_tests: int
        -passed_tests: int
        -failed_tests: int
        -coverage: float
        -error_messages: List[str]
        
        +all_passed(): bool
        +get_failure_summary(): str
        +meets_coverage_threshold(): bool
    }
    
    class PhaseTransition {
        -from_phase: TDDPhase
        -to_phase: TDDPhase
        -condition: Callable
        -on_transition: Callable
        
        +can_transition(): bool
        +execute(): void
    }
    
    class TDDCoordinator {
        -active_machines: Dict[str, TDDStateMachine]
        -story_queue: Queue[Story]
        -max_parallel: int
        -resource_monitor: ResourceMonitor
        
        +add_story(story: Story): void
        +start_next(): void
        +handle_completion(story_id: str): void
        +get_active_count(): int
        +can_start_new(): bool
    }
    
    TDDStateMachine --&gt; TDDPhase
    TDDStateMachine --&gt; TestResults
    TDDStateMachine --&gt; PhaseTransition
    TDDCoordinator --&gt; TDDStateMachine
    PhaseTransition --&gt; TDDPhase</code></pre><h2 id=agent-system-architecture>Agent System Architecture<a class=headerlink href=#agent-system-architecture title="Permanent link">&para;</a></h2><h3 id=agent-hierarchy-and-specialization>Agent Hierarchy and Specialization<a class=headerlink href=#agent-hierarchy-and-specialization title="Permanent link">&para;</a></h3><pre class=mermaid><code>classDiagram
    class BaseAgent {
        &lt;&lt;abstract&gt;&gt;
        -agent_id: str
        -agent_type: str
        -context_manager: ContextManager
        -security_profile: SecurityProfile
        -metrics: AgentMetrics
        
        +run(task: Task, dry_run: bool): Result
        +validate_access(operation: str): bool
        +get_context(): Context
        +report_metrics(): Dict
        #execute_task(task: Task): Result
        #prepare_context(task: Task): Context
    }
    
    class OrchestatorAgent {
        -workflow_state: WorkflowStateMachine
        -tdd_coordinator: TDDCoordinator
        -approval_queue: Queue[Approval]
        
        +coordinate_sprint(sprint: Sprint): void
        +assign_stories(stories: List[Story]): void
        +handle_approval(approval: Approval): void
        +monitor_progress(): Dict
    }
    
    class DesignAgent {
        -design_patterns: Dict[str, Pattern]
        -architecture_knowledge: KnowledgeBase
        
        +create_design(story: Story): Design
        +review_architecture(): ArchReview
        +suggest_patterns(): List[Pattern]
        +generate_specs(): TechnicalSpec
    }
    
    class CodeAgent {
        -language_models: Dict[str, LanguageModel]
        -code_analyzer: CodeAnalyzer
        
        +implement_feature(spec: TechnicalSpec): Code
        +fix_test_failures(failures: List[TestFailure]): Code
        +refactor_code(code: Code, metrics: CodeMetrics): Code
        +commit_changes(message: str): CommitResult
    }
    
    class QAAgent {
        -test_frameworks: Dict[str, TestFramework]
        -coverage_analyzer: CoverageAnalyzer
        
        +write_tests(spec: TechnicalSpec): TestSuite
        +run_tests(test_suite: TestSuite): TestResults
        +analyze_coverage(): CoverageReport
        +suggest_edge_cases(): List[TestCase]
    }
    
    class DataAgent {
        -analysis_tools: Dict[str, AnalysisTool]
        -visualization: VisualizationEngine
        
        +analyze_metrics(data: MetricsData): Analysis
        +generate_reports(): List[Report]
        +create_dashboards(): Dashboard
        +predict_trends(): Predictions
    }
    
    BaseAgent &lt;|-- OrchestatorAgent
    BaseAgent &lt;|-- DesignAgent
    BaseAgent &lt;|-- CodeAgent
    BaseAgent &lt;|-- QAAgent
    BaseAgent &lt;|-- DataAgent
    
    BaseAgent --&gt; ContextManager
    BaseAgent --&gt; SecurityProfile
    BaseAgent --&gt; AgentMetrics</code></pre><h3 id=agent-lifecycle-sequence>Agent Lifecycle Sequence<a class=headerlink href=#agent-lifecycle-sequence title="Permanent link">&para;</a></h3><pre class=mermaid><code>sequenceDiagram
    participant Orchestrator
    participant AgentFactory
    participant SecurityController
    participant Agent
    participant ContextManager
    participant Task
    
    Orchestrator-&gt;&gt;AgentFactory: create_agent(type, task)
    AgentFactory-&gt;&gt;SecurityController: get_security_profile(type)
    SecurityController--&gt;&gt;AgentFactory: SecurityProfile
    
    AgentFactory-&gt;&gt;Agent: new Agent(profile)
    AgentFactory--&gt;&gt;Orchestrator: Agent instance
    
    Orchestrator-&gt;&gt;Agent: run(task)
    Agent-&gt;&gt;ContextManager: prepare_context(task)
    ContextManager-&gt;&gt;ContextManager: load relevant files
    ContextManager-&gt;&gt;ContextManager: compress context
    ContextManager--&gt;&gt;Agent: Context
    
    Agent-&gt;&gt;Agent: validate_access(task.operations)
    Agent-&gt;&gt;Task: execute()
    Task--&gt;&gt;Agent: Result
    
    Agent-&gt;&gt;ContextManager: update_context(result)
    Agent--&gt;&gt;Orchestrator: TaskResult
    
    Orchestrator-&gt;&gt;Agent: shutdown()
    Agent-&gt;&gt;ContextManager: persist_memory()
    Agent-&gt;&gt;Agent: cleanup_resources()</code></pre><h2 id=context-management-system>Context Management System<a class=headerlink href=#context-management-system title="Permanent link">&para;</a></h2><h3 id=context-architecture>Context Architecture<a class=headerlink href=#context-architecture title="Permanent link">&para;</a></h3><pre class=mermaid><code>graph TB
    subgraph "Context Management System"
        subgraph "Input Processing"
            CI[Context Indexer&lt;br/&gt;File analysis]
            CF[Context Filter&lt;br/&gt;Relevance scoring]
            TC[Token Calculator&lt;br/&gt;Size optimization]
        end
        
        subgraph "Storage Layer"
            CC[Context Cache&lt;br/&gt;LRU Cache]
            CM[Context Memory&lt;br/&gt;Persistent store]
            CDB[Context Database&lt;br/&gt;Relationships]
        end
        
        subgraph "Optimization"
            Comp[Context Compressor&lt;br/&gt;Semantic compression]
            Chunk[Context Chunker&lt;br/&gt;Smart splitting]
            Prio[Priority Manager&lt;br/&gt;Importance ranking]
        end
        
        subgraph "Output"
            Builder[Context Builder&lt;br/&gt;Agent-specific views]
            Validator[Context Validator&lt;br/&gt;Completeness check]
        end
    end
    
    CI --&gt; CF
    CF --&gt; TC
    TC --&gt; Comp
    
    Comp --&gt; CC
    CC --&gt; CM
    CM --&gt; CDB
    
    CC --&gt; Chunk
    Chunk --&gt; Prio
    Prio --&gt; Builder
    Builder --&gt; Validator
    
    style CI fill:#4dabf7,stroke:#1971c2,stroke-width:2px
    style CC fill:#51cf66,stroke:#37b24d,stroke-width:2px
    style Builder fill:#ff6b6b,stroke:#c92a2a,stroke-width:2px</code></pre><h3 id=context-flow-implementation>Context Flow Implementation<a class=headerlink href=#context-flow-implementation title="Permanent link">&para;</a></h3><pre class=mermaid><code>classDiagram
    class ContextManager {
        -indexer: ContextIndexer
        -filter: ContextFilter
        -cache: ContextCache
        -compressor: ContextCompressor
        -token_calc: TokenCalculator
        
        +prepare_context(task: Task, agent_type: str): Context
        +update_context(result: Result): void
        +get_relevant_files(query: str): List[File]
        +estimate_tokens(context: Context): int
        +optimize_for_window(context: Context, limit: int): Context
    }
    
    class ContextIndexer {
        -file_index: Dict[str, FileMetadata]
        -symbol_index: Dict[str, List[Reference]]
        -dependency_graph: Graph
        
        +index_file(path: str): void
        +find_references(symbol: str): List[Reference]
        +get_dependencies(file: str): List[str]
        +search(query: str): List[Match]
    }
    
    class ContextFilter {
        -relevance_model: RelevanceModel
        -importance_scores: Dict[str, float]
        
        +filter_files(files: List[File], task: Task): List[File]
        +score_relevance(file: File, task: Task): float
        +apply_thresholds(scores: Dict): List[File]
    }
    
    class ContextCache {
        -cache: LRUCache
        -hit_rate: float
        -miss_handler: Callable
        
        +get(key: str): Optional[Context]
        +put(key: str, context: Context): void
        +invalidate(pattern: str): void
        +get_stats(): CacheStats
    }
    
    class ContextCompressor {
        -compression_strategies: List[Strategy]
        -quality_threshold: float
        
        +compress(context: Context): CompressedContext
        +decompress(compressed: CompressedContext): Context
        +estimate_quality_loss(context: Context): float
    }
    
    class TokenCalculator {
        -encoding: tiktoken.Encoding
        -model_limits: Dict[str, int]
        
        +count_tokens(text: str): int
        +estimate_context_size(context: Context): int
        +fits_in_window(context: Context, model: str): bool
        +suggest_truncation(context: Context, limit: int): Context
    }
    
    ContextManager --&gt; ContextIndexer
    ContextManager --&gt; ContextFilter
    ContextManager --&gt; ContextCache
    ContextManager --&gt; ContextCompressor
    ContextManager --&gt; TokenCalculator</code></pre><h2 id=resource-management-architecture>Resource Management Architecture<a class=headerlink href=#resource-management-architecture title="Permanent link">&para;</a></h2><h3 id=resource-scheduler-design>Resource Scheduler Design<a class=headerlink href=#resource-scheduler-design title="Permanent link">&para;</a></h3><pre class=mermaid><code>graph TB
    subgraph "Resource Scheduler"
        subgraph "Resource Monitoring"
            CPU[CPU Monitor&lt;br/&gt;Usage tracking]
            Memory[Memory Monitor&lt;br/&gt;Allocation tracking]
            Agents[Agent Monitor&lt;br/&gt;Active count]
        end
        
        subgraph "Scheduling Algorithm"
            Queue[Priority Queue&lt;br/&gt;Task ordering]
            Allocator[Resource Allocator&lt;br/&gt;Agent assignment]
            Balancer[Load Balancer&lt;br/&gt;Distribution logic]
        end
        
        subgraph "Constraints"
            Limits[Resource Limits&lt;br/&gt;Max thresholds]
            Priorities[Task Priorities&lt;br/&gt;Importance weights]
            Fairness[Fairness Policy&lt;br/&gt;Project balance]
        end
        
        subgraph "Optimization"
            Predictor[Load Predictor&lt;br/&gt;ML-based forecast]
            Optimizer[Schedule Optimizer&lt;br/&gt;Efficiency tuning]
        end
    end
    
    CPU --&gt; Queue
    Memory --&gt; Queue
    Agents --&gt; Queue
    
    Queue --&gt; Allocator
    Allocator --&gt; Balancer
    
    Limits --&gt; Allocator
    Priorities --&gt; Queue
    Fairness --&gt; Balancer
    
    Balancer --&gt; Predictor
    Predictor --&gt; Optimizer
    Optimizer --&gt; Queue
    
    style Queue fill:#ff6b6b,stroke:#c92a2a,stroke-width:2px
    style Allocator fill:#4dabf7,stroke:#1971c2,stroke-width:2px
    style Optimizer fill:#51cf66,stroke:#37b24d,stroke-width:2px</code></pre><h3 id=resource-allocation-algorithm>Resource Allocation Algorithm<a class=headerlink href=#resource-allocation-algorithm title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>ResourceScheduler</span><span class=p>:</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>resource_pool</span> <span class=o>=</span> <span class=n>ResourcePool</span><span class=p>()</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>task_queue</span> <span class=o>=</span> <span class=n>PriorityQueue</span><span class=p>()</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>allocation_policy</span> <span class=o>=</span> <span class=n>AllocationPolicy</span><span class=p>()</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>        
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a>    <span class=k>def</span> <span class=nf>schedule_task</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>task</span><span class=p>:</span> <span class=n>Task</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Allocation</span><span class=p>]:</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Main scheduling algorithm&quot;&quot;&quot;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>        <span class=c1># 1. Check resource availability</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a>        <span class=n>available</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>resource_pool</span><span class=o>.</span><span class=n>get_available_resources</span><span class=p>()</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a>        <span class=n>required</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimate_resources</span><span class=p>(</span><span class=n>task</span><span class=p>)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a>        
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>can_allocate</span><span class=p>(</span><span class=n>available</span><span class=p>,</span> <span class=n>required</span><span class=p>):</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>            <span class=c1># 2. Try to preempt lower priority tasks</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos="15 "></span></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>allocation_policy</span><span class=o>.</span><span class=n>allows_preemption</span><span class=p>:</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos="16 "></span></a>                <span class=n>freed</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>preempt_tasks</span><span class=p>(</span><span class=n>required</span><span class=p>,</span> <span class=n>task</span><span class=o>.</span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos="17 "></span></a>                <span class=k>if</span> <span class=n>freed</span> <span class=o>&gt;=</span> <span class=n>required</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos="18 "></span></a>                    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>allocate</span><span class=p>(</span><span class=n>task</span><span class=p>,</span> <span class=n>required</span><span class=p>)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos="19 "></span></a>            
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos="20 "></span></a>            <span class=c1># 3. Queue the task</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos="21 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>task_queue</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>task</span><span class=p>,</span> <span class=n>priority</span><span class=o>=</span><span class=n>task</span><span class=o>.</span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos="22 "></span></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos="23 "></span></a>            
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos="24 "></span></a>        <span class=c1># 4. Direct allocation</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos="25 "></span></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>allocate</span><span class=p>(</span><span class=n>task</span><span class=p>,</span> <span class=n>required</span><span class=p>)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos="26 "></span></a>        
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos="27 "></span></a>    <span class=k>def</span> <span class=nf>allocate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>task</span><span class=p>:</span> <span class=n>Task</span><span class=p>,</span> <span class=n>resources</span><span class=p>:</span> <span class=n>Resources</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Allocation</span><span class=p>:</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Allocate resources to task&quot;&quot;&quot;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos="29 "></span></a>        <span class=n>allocation</span> <span class=o>=</span> <span class=n>Allocation</span><span class=p>(</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos="30 "></span></a>            <span class=n>task_id</span><span class=o>=</span><span class=n>task</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos="31 "></span></a>            <span class=n>cpu_cores</span><span class=o>=</span><span class=n>resources</span><span class=o>.</span><span class=n>cpu</span><span class=p>,</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos="32 "></span></a>            <span class=n>memory_mb</span><span class=o>=</span><span class=n>resources</span><span class=o>.</span><span class=n>memory</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos="33 "></span></a>            <span class=n>agent_slots</span><span class=o>=</span><span class=n>resources</span><span class=o>.</span><span class=n>agents</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos="34 "></span></a>        <span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos="35 "></span></a>        
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos="36 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>resource_pool</span><span class=o>.</span><span class=n>reserve</span><span class=p>(</span><span class=n>allocation</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos="37 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>start_monitoring</span><span class=p>(</span><span class=n>allocation</span><span class=p>)</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos="38 "></span></a>        
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos="39 "></span></a>        <span class=k>return</span> <span class=n>allocation</span>
</span></code></pre></div><h2 id=security-architecture-components>Security Architecture Components<a class=headerlink href=#security-architecture-components title="Permanent link">&para;</a></h2><h3 id=security-layer-implementation>Security Layer Implementation<a class=headerlink href=#security-layer-implementation title="Permanent link">&para;</a></h3><pre class=mermaid><code>classDiagram
    class SecurityController {
        -profiles: Dict[str, SecurityProfile]
        -audit_log: AuditLogger
        -policy_engine: PolicyEngine
        
        +check_access(agent: Agent, operation: Operation): bool
        +get_profile(agent_type: str): SecurityProfile
        +log_access(agent: Agent, operation: Operation, result: bool): void
        +update_policies(policies: List[Policy]): void
    }
    
    class SecurityProfile {
        -agent_type: str
        -allowed_tools: List[str]
        -blocked_tools: List[str]
        -file_permissions: FilePermissions
        -network_access: NetworkPolicy
        
        +can_use_tool(tool: str): bool
        +can_access_file(path: str, mode: str): bool
        +can_make_request(url: str): bool
        +to_cli_flags(): Dict[str, List[str]]
    }
    
    class AuditLogger {
        -log_store: LogStore
        -encryption: Encryption
        -retention_policy: RetentionPolicy
        
        +log_action(entry: AuditEntry): void
        +query_logs(filter: LogFilter): List[AuditEntry]
        +export_compliance_report(): Report
        +rotate_logs(): void
    }
    
    class PolicyEngine {
        -rules: List[SecurityRule]
        -evaluator: RuleEvaluator
        
        +evaluate(context: SecurityContext): Decision
        +add_rule(rule: SecurityRule): void
        +validate_policies(): List[Violation]
    }
    
    class ToolAccessControl {
        -tool_registry: Dict[str, ToolDefinition]
        -access_matrix: AccessMatrix
        
        +check_tool_access(agent_type: str, tool: str): bool
        +get_allowed_tools(agent_type: str): List[str]
        +register_tool(tool: ToolDefinition): void
    }
    
    SecurityController --&gt; SecurityProfile
    SecurityController --&gt; AuditLogger
    SecurityController --&gt; PolicyEngine
    SecurityProfile --&gt; ToolAccessControl
    PolicyEngine --&gt; SecurityRule
    AuditLogger --&gt; AuditEntry</code></pre><h3 id=security-enforcement-flow>Security Enforcement Flow<a class=headerlink href=#security-enforcement-flow title="Permanent link">&para;</a></h3><pre class=mermaid><code>sequenceDiagram
    participant Agent
    participant SecurityController
    participant PolicyEngine
    participant ToolAccessControl
    participant AuditLogger
    participant ClaudeCLI
    
    Agent-&gt;&gt;SecurityController: request_operation(op)
    SecurityController-&gt;&gt;PolicyEngine: evaluate(agent, op)
    PolicyEngine-&gt;&gt;PolicyEngine: check_rules()
    PolicyEngine--&gt;&gt;SecurityController: Decision
    
    alt Access Granted
        SecurityController-&gt;&gt;ToolAccessControl: get_restrictions(agent.type)
        ToolAccessControl--&gt;&gt;SecurityController: tool_list
        SecurityController-&gt;&gt;ClaudeCLI: execute_with_restrictions(op, tool_list)
        ClaudeCLI--&gt;&gt;SecurityController: result
        SecurityController-&gt;&gt;AuditLogger: log_success(agent, op)
    else Access Denied
        SecurityController-&gt;&gt;AuditLogger: log_denial(agent, op, reason)
        SecurityController--&gt;&gt;Agent: AccessDeniedError
    end
    
    AuditLogger-&gt;&gt;AuditLogger: encrypt_and_store()</code></pre><h2 id=data-flow-architecture>Data Flow Architecture<a class=headerlink href=#data-flow-architecture title="Permanent link">&para;</a></h2><h3 id=complete-system-data-flow>Complete System Data Flow<a class=headerlink href=#complete-system-data-flow title="Permanent link">&para;</a></h3><pre class=mermaid><code>graph TB
    subgraph "User Input"
        Discord[Discord Commands]
        API[REST API]
    end
    
    subgraph "Command Processing"
        CmdParser[Command Parser&lt;br/&gt;Validation]
        Router[Request Router&lt;br/&gt;Project routing]
        Queue[Command Queue&lt;br/&gt;Priority handling]
    end
    
    subgraph "State Management"
        WSM[Workflow State Machine]
        TSM[TDD State Machines]
        StateStore[State Storage]
    end
    
    subgraph "Agent Orchestration"
        Orchestrator[Main Orchestrator]
        AgentFactory[Agent Factory]
        AgentPool[Agent Pool]
    end
    
    subgraph "Execution"
        Agents[Specialized Agents]
        Context[Context System]
        Security[Security Layer]
    end
    
    subgraph "Results"
        Results[Task Results]
        Metrics[Metrics Collection]
        Notifications[User Notifications]
    end
    
    subgraph "Storage"
        ProjectFiles[Project Files]
        StateFiles[State Files]
        Logs[Audit Logs]
    end
    
    Discord --&gt; CmdParser
    API --&gt; CmdParser
    CmdParser --&gt; Router
    Router --&gt; Queue
    
    Queue --&gt; WSM
    WSM --&gt; TSM
    WSM --&gt; StateStore
    TSM --&gt; StateStore
    
    WSM --&gt; Orchestrator
    Orchestrator --&gt; AgentFactory
    AgentFactory --&gt; AgentPool
    AgentPool --&gt; Agents
    
    Agents --&gt; Context
    Agents --&gt; Security
    Security --&gt; Agents
    
    Agents --&gt; Results
    Results --&gt; Metrics
    Results --&gt; Notifications
    
    Results --&gt; ProjectFiles
    StateStore --&gt; StateFiles
    Security --&gt; Logs
    
    Notifications --&gt; Discord
    
    style Discord fill:#7b68ee,stroke:#483d8b,stroke-width:2px
    style WSM fill:#ff6b6b,stroke:#c92a2a,stroke-width:2px
    style Agents fill:#4dabf7,stroke:#1971c2,stroke-width:2px
    style Results fill:#51cf66,stroke:#37b24d,stroke-width:2px</code></pre><h3 id=data-model-relationships>Data Model Relationships<a class=headerlink href=#data-model-relationships title="Permanent link">&para;</a></h3><pre class=mermaid><code>erDiagram
    PROJECT ||--o{ EPIC : contains
    EPIC ||--o{ STORY : contains
    PROJECT ||--o{ SPRINT : has
    SPRINT ||--o{ STORY : includes
    STORY ||--|| TDD_CYCLE : triggers
    TDD_CYCLE ||--o{ TDD_PHASE : contains
    TDD_PHASE ||--|| AGENT_TASK : creates
    AGENT_TASK ||--|| AGENT : assigned_to
    AGENT ||--o{ TOOL_ACCESS : has
    AGENT_TASK ||--|| RESULT : produces
    RESULT ||--o{ METRIC : generates
    
    PROJECT {
        string id PK
        string name
        string path
        json config
        timestamp created_at
    }
    
    EPIC {
        string id PK
        string project_id FK
        string description
        string status
        int priority
    }
    
    STORY {
        string id PK
        string epic_id FK
        string sprint_id FK
        string title
        string description
        int story_points
        string status
    }
    
    SPRINT {
        string id PK
        string project_id FK
        string name
        date start_date
        date end_date
        string status
    }
    
    TDD_CYCLE {
        string id PK
        string story_id FK
        string current_phase
        json phase_results
        timestamp started_at
    }
    
    AGENT {
        string id PK
        string type
        string status
        json metrics
    }</code></pre><h2 id=performance-optimization-architecture>Performance Optimization Architecture<a class=headerlink href=#performance-optimization-architecture title="Permanent link">&para;</a></h2><h3 id=caching-strategy>Caching Strategy<a class=headerlink href=#caching-strategy title="Permanent link">&para;</a></h3><pre class=mermaid><code>graph TB
    subgraph "Multi-Level Cache"
        subgraph "L1 - Memory Cache"
            HotData[Hot Data&lt;br/&gt;Frequent access]
            ActiveContext[Active Contexts&lt;br/&gt;Current tasks]
        end
        
        subgraph "L2 - Redis Cache"
            WarmData[Warm Data&lt;br/&gt;Recent access]
            SharedContext[Shared Contexts&lt;br/&gt;Cross-agent]
        end
        
        subgraph "L3 - File Cache"
            ColdData[Cold Data&lt;br/&gt;Historical]
            ArchivedContext[Archived Contexts&lt;br/&gt;Completed tasks]
        end
    end
    
    subgraph "Cache Management"
        CacheManager[Cache Manager&lt;br/&gt;Coordination]
        Eviction[Eviction Policy&lt;br/&gt;LRU/LFU]
        Preloader[Preloader&lt;br/&gt;Predictive loading]
    end
    
    Request[Cache Request] --&gt; CacheManager
    CacheManager --&gt; HotData
    HotData -.miss.-&gt; WarmData
    WarmData -.miss.-&gt; ColdData
    
    CacheManager --&gt; Eviction
    CacheManager --&gt; Preloader
    
    style HotData fill:#ff6b6b,stroke:#c92a2a,stroke-width:2px
    style WarmData fill:#ffd43b,stroke:#fab005,stroke-width:2px
    style ColdData fill:#4dabf7,stroke:#1971c2,stroke-width:2px</code></pre><h3 id=performance-monitoring>Performance Monitoring<a class=headerlink href=#performance-monitoring title="Permanent link">&para;</a></h3><pre class=mermaid><code>classDiagram
    class PerformanceMonitor {
        -metrics_collector: MetricsCollector
        -analyzers: List[PerformanceAnalyzer]
        -alert_manager: AlertManager
        
        +collect_metrics(): void
        +analyze_performance(): PerformanceReport
        +detect_anomalies(): List[Anomaly]
        +optimize_automatically(): void
    }
    
    class MetricsCollector {
        -counters: Dict[str, Counter]
        -gauges: Dict[str, Gauge]
        -histograms: Dict[str, Histogram]
        
        +increment(metric: str, value: float): void
        +record_duration(operation: str, duration: float): void
        +get_snapshot(): MetricsSnapshot
    }
    
    class PerformanceAnalyzer {
        &lt;&lt;interface&gt;&gt;
        +analyze(metrics: MetricsSnapshot): Analysis
        +suggest_optimizations(): List[Optimization]
    }
    
    class ResourceAnalyzer {
        +analyze_cpu_usage(): CPUAnalysis
        +analyze_memory_usage(): MemoryAnalysis
        +detect_leaks(): List[MemoryLeak]
    }
    
    class LatencyAnalyzer {
        +analyze_response_times(): LatencyAnalysis
        +identify_bottlenecks(): List[Bottleneck]
        +suggest_caching(): List[CacheCandidate]
    }
    
    class ThroughputAnalyzer {
        +analyze_task_completion(): ThroughputAnalysis
        +calculate_efficiency(): float
        +recommend_parallelism(): int
    }
    
    PerformanceMonitor --&gt; MetricsCollector
    PerformanceMonitor --&gt; PerformanceAnalyzer
    PerformanceAnalyzer &lt;|-- ResourceAnalyzer
    PerformanceAnalyzer &lt;|-- LatencyAnalyzer
    PerformanceAnalyzer &lt;|-- ThroughputAnalyzer</code></pre><h2 id=error-handling-and-recovery>Error Handling and Recovery<a class=headerlink href=#error-handling-and-recovery title="Permanent link">&para;</a></h2><h3 id=error-handling-architecture>Error Handling Architecture<a class=headerlink href=#error-handling-architecture title="Permanent link">&para;</a></h3><pre class=mermaid><code>graph TB
    subgraph "Error Detection"
        Monitor[Error Monitor&lt;br/&gt;Detection]
        Classifier[Error Classifier&lt;br/&gt;Categorization]
        Severity[Severity Analyzer&lt;br/&gt;Impact assessment]
    end
    
    subgraph "Error Handling"
        Handler[Error Handler&lt;br/&gt;Routing]
        Retry[Retry Manager&lt;br/&gt;Automatic retry]
        Fallback[Fallback Strategy&lt;br/&gt;Alternative paths]
        Escalation[Escalation Manager&lt;br/&gt;Human intervention]
    end
    
    subgraph "Recovery"
        StateRecovery[State Recovery&lt;br/&gt;Rollback]
        DataRecovery[Data Recovery&lt;br/&gt;Consistency]
        AgentRecovery[Agent Recovery&lt;br/&gt;Restart]
    end
    
    subgraph "Learning"
        ErrorDB[Error Database&lt;br/&gt;Historical data]
        Pattern[Pattern Recognition&lt;br/&gt;Common failures]
        Prevention[Prevention Rules&lt;br/&gt;Proactive fixes]
    end
    
    Monitor --&gt; Classifier
    Classifier --&gt; Severity
    Severity --&gt; Handler
    
    Handler --&gt; Retry
    Handler --&gt; Fallback
    Handler --&gt; Escalation
    
    Retry --&gt; StateRecovery
    Fallback --&gt; DataRecovery
    Escalation --&gt; AgentRecovery
    
    Handler --&gt; ErrorDB
    ErrorDB --&gt; Pattern
    Pattern --&gt; Prevention
    Prevention --&gt; Monitor
    
    style Monitor fill:#ff6b6b,stroke:#c92a2a,stroke-width:2px
    style Handler fill:#4dabf7,stroke:#1971c2,stroke-width:2px
    style StateRecovery fill:#51cf66,stroke:#37b24d,stroke-width:2px</code></pre><h3 id=recovery-sequence>Recovery Sequence<a class=headerlink href=#recovery-sequence title="Permanent link">&para;</a></h3><pre class=mermaid><code>sequenceDiagram
    participant System
    participant ErrorHandler
    participant StateManager
    participant RecoveryEngine
    participant HumanOperator
    
    System-&gt;&gt;ErrorHandler: error_occurred(error)
    ErrorHandler-&gt;&gt;ErrorHandler: classify_error()
    
    alt Transient Error
        ErrorHandler-&gt;&gt;RecoveryEngine: attempt_retry(error)
        RecoveryEngine-&gt;&gt;System: retry_operation()
        System--&gt;&gt;ErrorHandler: success
    else State Corruption
        ErrorHandler-&gt;&gt;StateManager: get_last_valid_state()
        StateManager--&gt;&gt;ErrorHandler: checkpoint
        ErrorHandler-&gt;&gt;RecoveryEngine: rollback_to(checkpoint)
        RecoveryEngine-&gt;&gt;System: restore_state()
    else Critical Error
        ErrorHandler-&gt;&gt;HumanOperator: escalate(error)
        HumanOperator-&gt;&gt;RecoveryEngine: manual_intervention()
        RecoveryEngine-&gt;&gt;System: apply_fix()
    end
    
    RecoveryEngine-&gt;&gt;ErrorHandler: log_resolution()</code></pre><h2 id=summary>Summary<a class=headerlink href=#summary title="Permanent link">&para;</a></h2><p>This component architecture document details:</p><ol><li><strong>State Machines</strong>: Dual state machine implementation with comprehensive state management</li><li><strong>Agent System</strong>: Hierarchical agent architecture with specialized capabilities</li><li><strong>Context Management</strong>: Sophisticated context optimization and caching</li><li><strong>Resource Scheduling</strong>: Intelligent resource allocation and optimization</li><li><strong>Security Layers</strong>: Multi-level security enforcement and audit</li><li><strong>Data Flow</strong>: Complete system data flow and relationships</li><li><strong>Performance</strong>: Caching strategies and monitoring systems</li><li><strong>Error Handling</strong>: Comprehensive error detection and recovery</li></ol><p>Each component is designed for: - <strong>Modularity</strong>: Clear interfaces and separation of concerns - <strong>Scalability</strong>: Horizontal and vertical scaling capabilities - <strong>Reliability</strong>: Error handling and recovery mechanisms - <strong>Security</strong>: Defense in depth with audit trails - <strong>Performance</strong>: Optimization at every layer</p><aside class=md-source-file><span class=md-source-file__fact><span class=md-icon title="Last update"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 19, 2025 03:12:57 UTC">June 19, 2025 03:12:57</span></span><span class=md-source-file__fact><span class=md-icon title=Created><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 19, 2025 03:12:57 UTC">June 19, 2025 03:12:57</span></span></aside><form class=md-feedback name=feedback hidden><fieldset><legend class=md-feedback__title> Was this page helpful? </legend><div class=md-feedback__inner><div class=md-feedback__list><button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg></button><button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg></button></div><div class=md-feedback__note><div data-md-value=1 hidden> Thanks for your feedback! </div><div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by <a href="https://github.com/jmontp/agent-workflow/issues/new/?title=[Feedback]+%F0%9F%94%A7%20Component%20Architecture+-+/architecture/component-architecture/" target=_blank rel=noopener>telling us what you found confusing</a>. </div></div></div></fieldset></form></article></div><script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button type=button class="md-top md-icon" data-md-component=top hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button></main><footer class=md-footer><nav class="md-footer__inner md-grid" aria-label=Footer><a href=../system-overview/ class="md-footer__link md-footer__link--prev" aria-label="Previous: üèóÔ∏è System Overview"><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.41 16.58 10.83 12l4.58-4.59L14 6l-6 6 6 6z"/></svg></div><div class=md-footer__title><span class=md-footer__direction> Previous </span><div class=md-ellipsis> üèóÔ∏è System Overview </div></div></a><a href=../context-management-system/ class="md-footer__link md-footer__link--next" aria-label="Next: üß† Context Management"><div class=md-footer__title><span class=md-footer__direction> Next </span><div class=md-ellipsis> üß† Context Management </div></div><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright></div><div class=md-social><a href=https://github.com/jmontp/agent-workflow target=_blank rel=noopener title="GitHub Repository" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></a><a href=https://jmontp.github.io/agent-workflow/ target=_blank rel=noopener title="Documentation Site" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a><a href=https://discord.gg/your-discord-server target=_blank rel=noopener title="Discord Community" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3c5.5 0 10 3.58 10 8s-4.5 8-10 8c-1.24 0-2.43-.18-3.53-.5C5.55 21 2 21 2 21c2.33-2.33 2.7-3.9 2.75-4.5C3.05 15.07 2 13.13 2 11c0-4.42 4.5-8 10-8"/></svg></a><a href=https://github.com/sponsors/jmontp target=_blank rel=noopener title=Sponsor class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53z"/></svg></a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><div class=md-progress data-md-component=progress role=progressbar></div><div class=md-consent data-md-component=consent id=__consent hidden><div class=md-consent__overlay></div><aside class=md-consent__inner><form class="md-consent__form md-grid md-typeset" name=consent><h4>Cookie consent</h4><p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p><input class=md-toggle type=checkbox id=__settings><div class=md-consent__settings><ul class=task-list><li class=task-list-item><label class=task-list-control><input type=checkbox name=analytics checked><span class=task-list-indicator></span> Google Analytics </label></li><li class=task-list-item><label class=task-list-control><input type=checkbox name=github checked><span class=task-list-indicator></span> GitHub </label></li></ul></div><div class=md-consent__controls><button class="md-button md-button--primary">Accept</button><button type=reset class="md-button md-button--primary">Reject</button><label class=md-button for=__settings>Manage settings</label></div></form></aside></div><script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script><script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": {"API": "api", "Architecture": "architecture", "CSS": "css", "Discord": "discord", "HTML5": "html", "JavaScript": "js", "Python": "python", "Scrum": "scrum", "TDD": "tdd"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.13a4f30d.min.js></script><script src=https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mtml-chtml.js></script><script src=../../js/mermaid-zoom.js></script><script src=../../js/universal-search.js></script><script src=../../js/enhanced-navigation.js></script><script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body></html>