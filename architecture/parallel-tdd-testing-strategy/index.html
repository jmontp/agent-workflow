<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Human-In-The-Loop orchestration framework for AI-assisted software development"><meta name=author content="AI Agent Workflow Team"><link href=https://jmontp.github.io/agent-workflow/architecture/parallel-tdd-testing-strategy/ rel=canonical><link href=../parallel-tdd-comprehensive-implementation-plan/ rel=prev><link href=../parallel-context-integration/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>Parallel TDD Testing Strategy - AI Agent TDD-Scrum Workflow</title><link rel=stylesheet href=../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{.md-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.5%207A1.5%201.5%200%200%201%204%205.5%201.5%201.5%200%200%201%205.5%204%201.5%201.5%200%200%201%207%205.5%201.5%201.5%200%200%201%205.5%207m15.91%204.58-9-9C12.05%202.22%2011.55%202%2011%202H4c-1.11%200-2%20.89-2%202v7c0%20.55.22%201.05.59%201.41l8.99%209c.37.36.87.59%201.42.59s1.05-.23%201.41-.59l7-7c.37-.36.59-.86.59-1.41%200-.56-.23-1.06-.59-1.42%22/%3E%3C/svg%3E');}.md-tag.md-tag--html{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m12%2017.56%204.07-1.13.55-6.1H9.38L9.2%208.3h7.6l.2-1.99H7l.56%206.01h6.89l-.23%202.58-2.22.6-2.22-.6-.14-1.66h-2l.29%203.19zM4.07%203h15.86L18.5%2019.2%2012%2021l-6.5-1.8z%22/%3E%3C/svg%3E');}.md-tag.md-tag--js{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M3%203h18v18H3zm4.73%2015.04c.4.85%201.19%201.55%202.54%201.55%201.5%200%202.53-.8%202.53-2.55v-5.78h-1.7V17c0%20.86-.35%201.08-.9%201.08-.58%200-.82-.4-1.09-.87zm5.98-.18c.5.98%201.51%201.73%203.09%201.73%201.6%200%202.8-.83%202.8-2.36%200-1.41-.81-2.04-2.25-2.66l-.42-.18c-.73-.31-1.04-.52-1.04-1.02%200-.41.31-.73.81-.73.48%200%20.8.21%201.09.73l1.31-.87c-.55-.96-1.33-1.33-2.4-1.33-1.51%200-2.48.96-2.48%202.23%200%201.38.81%202.03%202.03%202.55l.42.18c.78.34%201.24.55%201.24%201.13%200%20.48-.45.83-1.15.83-.83%200-1.31-.43-1.67-1.03z%22/%3E%3C/svg%3E');}.md-tag.md-tag--css{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m5%203-.65%203.34h13.59L17.5%208.5H3.92l-.66%203.33h13.59l-.76%203.81-5.48%201.81-4.75-1.81.33-1.64H2.85l-.79%204%207.85%203%209.05-3%201.2-6.03.24-1.21L21.94%203z%22/%3E%3C/svg%3E');}.md-tag.md-tag--python{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M19.14%207.5A2.86%202.86%200%200%201%2022%2010.36v3.78A2.86%202.86%200%200%201%2019.14%2017H12c0%20.39.32.96.71.96H17v1.68a2.86%202.86%200%200%201-2.86%202.86H9.86A2.86%202.86%200%200%201%207%2019.64v-3.75a2.85%202.85%200%200%201%202.86-2.85h5.25a2.85%202.85%200%200%200%202.85-2.86V7.5zm-4.28%2011.79c-.4%200-.72.3-.72.89s.32.71.72.71a.71.71%200%200%200%20.71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86%202.86%200%200%201%202%2014.64v-3.78A2.86%202.86%200%200%201%204.86%208H12c0-.39-.32-.96-.71-.96H7V5.36A2.86%202.86%200%200%201%209.86%202.5h4.28A2.86%202.86%200%200%201%2017%205.36v3.75a2.85%202.85%200%200%201-2.86%202.85H8.89a2.85%202.85%200%200%200-2.85%202.86v2.68zM9.14%205.71c.4%200%20.72-.3.72-.89s-.32-.71-.72-.71c-.39%200-.71.12-.71.71s.32.89.71.89%22/%3E%3C/svg%3E');}}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href=../../stylesheets/enhanced-navigation.css><link rel=stylesheet href=../../stylesheets/color-schemes.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head><body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=black><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off><input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off><label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#parallel-tdd-comprehensive-testing-strategy class=md-skip> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=../.. title="AI Agent TDD-Scrum Workflow" class="md-header__button md-logo" aria-label="AI Agent TDD-Scrum Workflow" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a><label class="md-header__button md-icon" for=__drawer><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> AI Agent TDD-Scrum Workflow </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> Parallel TDD Testing Strategy </span></div></div></div><div class=md-header__option><div class=md-select><button class="md-header__button md-icon" aria-label="Select language"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg></button><div class=md-select__inner><ul class=md-select__list><li class=md-select__item><a href=../../ hreflang=en class=md-select__link> English </a></li></ul></div></div></div><label class="md-header__button md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required><label class="md-search__icon md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.41 16.58 10.83 12l4.58-4.59L14 6l-6 6 6 6z"/></svg></label><nav class=md-search__options aria-label=Search><a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg></a><button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap tabindex=0 data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta> Initializing search </div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a href=https://github.com/jmontp/agent-workflow title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></div><div class=md-source__repository> jmontp/agent-workflow </div></a></div></nav><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a href=../.. class=md-tabs__link> üè† Home </a></li><li class=md-tabs__item><a href=../../getting-started/ class=md-tabs__link> ‚ö° Getting Started </a></li><li class=md-tabs__item><a href=../../user-guide/ class=md-tabs__link> üìä User Guide </a></li><li class=md-tabs__item><a href=../../concepts/ class=md-tabs__link> üéØ Core Concepts </a></li><li class="md-tabs__item md-tabs__item--active"><a href=../ class=md-tabs__link> üî• Architecture </a></li><li class=md-tabs__item><a href=../../advanced/ class=md-tabs__link> ‚ö° Advanced Topics </a></li><li class=md-tabs__item><a href=../../planning/ class=md-tabs__link> üé® Planning & Design </a></li><li class=md-tabs__item><a href=../../development/ class=md-tabs__link> üìä Development </a></li><li class=md-tabs__item><a href=../../deployment/ class=md-tabs__link> üî• Deployment </a></li><li class=md-tabs__item><a href=../../templates/ class=md-tabs__link> üìã Templates </a></li><li class=md-tabs__item><a href=../../theme-integration-guide/ class=md-tabs__link> üé® Theme Integration </a></li><li class=md-tabs__item><a href=../../archive/compliance/ class=md-tabs__link> üìÅ Archive </a></li></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=../.. title="AI Agent TDD-Scrum Workflow" class="md-nav__button md-logo" aria-label="AI Agent TDD-Scrum Workflow" data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a> AI Agent TDD-Scrum Workflow </label><div class=md-nav__source><a href=https://github.com/jmontp/agent-workflow title="Go to repository" class=md-source data-md-component=source><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></div><div class=md-source__repository> jmontp/agent-workflow </div></a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../.. class=md-nav__link><span class=md-ellipsis> üè† Home </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../getting-started/ class=md-nav__link><span class=md-ellipsis> ‚ö° Getting Started </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../user-guide/ class=md-nav__link><span class=md-ellipsis> üìä User Guide </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../concepts/ class=md-nav__link><span class=md-ellipsis> üéØ Core Concepts </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked><div class="md-nav__link md-nav__container"><a href=../ class="md-nav__link "><span class=md-ellipsis> üî• Architecture </span></a><label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span> üî• Architecture </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../system-overview/ class=md-nav__link><span class=md-ellipsis> üèóÔ∏è System Overview </span></a></li><li class=md-nav__item><a href=../component-architecture/ class=md-nav__link><span class=md-ellipsis> üîß Component Architecture </span></a></li><li class=md-nav__item><a href=../context-management-system/ class=md-nav__link><span class=md-ellipsis> üß† Context Management </span></a></li><li class=md-nav__item><a href=../context-api-specification/ class=md-nav__link><span class=md-ellipsis> Context API Specification </span></a></li><li class=md-nav__item><a href=../context-algorithms/ class=md-nav__link><span class=md-ellipsis> Context Algorithms </span></a></li><li class=md-nav__item><a href=../context-evaluation-framework/ class=md-nav__link><span class=md-ellipsis> Context Evaluation Framework </span></a></li><li class=md-nav__item><a href=../context-implementation-plan/ class=md-nav__link><span class=md-ellipsis> Context Implementation Plan </span></a></li><li class=md-nav__item><a href=../parallel-tdd-architecture/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Design </span></a></li><li class=md-nav__item><a href=../parallel-tdd-technical-specification/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Implementation </span></a></li><li class=md-nav__item><a href=../parallel-tdd-implementation-strategy/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Implementation Strategy </span></a></li><li class=md-nav__item><a href=../parallel-tdd-comprehensive-implementation-plan/ class=md-nav__link><span class=md-ellipsis> Parallel TDD Comprehensive Plan </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" type=checkbox id=__toc><label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> Parallel TDD Testing Strategy </span><span class="md-nav__icon md-icon"></span></label><a href=./ class="md-nav__link md-nav__link--active"><span class=md-ellipsis> Parallel TDD Testing Strategy </span></a><nav class="md-nav md-nav--secondary" aria-label="On this page"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> On this page </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#executive-summary class=md-nav__link><span class=md-ellipsis> Executive Summary </span></a></li><li class=md-nav__item><a href=#testing-framework-architecture class=md-nav__link><span class=md-ellipsis> Testing Framework Architecture </span></a><nav class=md-nav aria-label="Testing Framework Architecture"><ul class=md-nav__list><li class=md-nav__item><a href=#1-test-pyramid-for-parallel-tdd class=md-nav__link><span class=md-ellipsis> 1. Test Pyramid for Parallel TDD </span></a></li><li class=md-nav__item><a href=#2-testing-infrastructure class=md-nav__link><span class=md-ellipsis> 2. Testing Infrastructure </span></a></li></ul></nav></li><li class=md-nav__item><a href=#unit-testing-strategy class=md-nav__link><span class=md-ellipsis> Unit Testing Strategy </span></a><nav class=md-nav aria-label="Unit Testing Strategy"><ul class=md-nav__list><li class=md-nav__item><a href=#1-component-level-unit-tests class=md-nav__link><span class=md-ellipsis> 1. Component-Level Unit Tests </span></a></li></ul></nav></li><li class=md-nav__item><a href=#integration-testing-strategy class=md-nav__link><span class=md-ellipsis> Integration Testing Strategy </span></a><nav class=md-nav aria-label="Integration Testing Strategy"><ul class=md-nav__list><li class=md-nav__item><a href=#1-component-integration-tests class=md-nav__link><span class=md-ellipsis> 1. Component Integration Tests </span></a></li></ul></nav></li><li class=md-nav__item><a href=#performance-testing-strategy class=md-nav__link><span class=md-ellipsis> Performance Testing Strategy </span></a><nav class=md-nav aria-label="Performance Testing Strategy"><ul class=md-nav__list><li class=md-nav__item><a href=#1-load-testing class=md-nav__link><span class=md-ellipsis> 1. Load Testing </span></a></li></ul></nav></li><li class=md-nav__item><a href=#security-testing-strategy class=md-nav__link><span class=md-ellipsis> Security Testing Strategy </span></a><nav class=md-nav aria-label="Security Testing Strategy"><ul class=md-nav__list><li class=md-nav__item><a href=#1-agent-isolation-testing class=md-nav__link><span class=md-ellipsis> 1. Agent Isolation Testing </span></a></li></ul></nav></li><li class=md-nav__item><a href=#chaos-engineering-strategy class=md-nav__link><span class=md-ellipsis> Chaos Engineering Strategy </span></a><nav class=md-nav aria-label="Chaos Engineering Strategy"><ul class=md-nav__list><li class=md-nav__item><a href=#1-fault-injection-testing class=md-nav__link><span class=md-ellipsis> 1. Fault Injection Testing </span></a></li></ul></nav></li><li class=md-nav__item><a href=#continuous-testing-pipeline class=md-nav__link><span class=md-ellipsis> Continuous Testing Pipeline </span></a><nav class=md-nav aria-label="Continuous Testing Pipeline"><ul class=md-nav__list><li class=md-nav__item><a href=#1-automated-test-execution class=md-nav__link><span class=md-ellipsis> 1. Automated Test Execution </span></a></li><li class=md-nav__item><a href=#2-test-metrics-and-reporting class=md-nav__link><span class=md-ellipsis> 2. Test Metrics and Reporting </span></a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a href=../parallel-context-integration/ class=md-nav__link><span class=md-ellipsis> Parallel Context Integration </span></a></li><li class=md-nav__item><a href=../parallel-agent-pool-management/ class=md-nav__link><span class=md-ellipsis> Parallel Agent Pool Management </span></a></li><li class=md-nav__item><a href=../parallel-conflict-algorithms/ class=md-nav__link><span class=md-ellipsis> Parallel Conflict Resolution </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../advanced/ class=md-nav__link><span class=md-ellipsis> ‚ö° Advanced Topics </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../planning/ class=md-nav__link><span class=md-ellipsis> üé® Planning & Design </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../development/ class=md-nav__link><span class=md-ellipsis> üìä Development </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../deployment/ class=md-nav__link><span class=md-ellipsis> üî• Deployment </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../templates/ class=md-nav__link><span class=md-ellipsis> üìã Templates </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../theme-integration-guide/ class=md-nav__link><span class=md-ellipsis> üé® Theme Integration </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href=../../archive/compliance/ class=md-nav__link><span class=md-ellipsis> üìÅ Archive </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><a href=https://github.com/jmontp/agent-workflow/edit/master/docs/architecture/parallel-tdd-testing-strategy.md title="Edit this page" class="md-content__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg></a><a href=https://github.com/jmontp/agent-workflow/raw/master/docs/architecture/parallel-tdd-testing-strategy.md title="View source of this page" class="md-content__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg></a><h1 id=parallel-tdd-comprehensive-testing-strategy>Parallel TDD Comprehensive Testing Strategy<a class=headerlink href=#parallel-tdd-comprehensive-testing-strategy title="Permanent link">&para;</a></h1><h2 id=executive-summary>Executive Summary<a class=headerlink href=#executive-summary title="Permanent link">&para;</a></h2><p>This document outlines a comprehensive testing strategy for the Parallel TDD Execution system. The strategy encompasses unit testing, integration testing, performance testing, security testing, and chaos engineering to ensure the system meets quality, performance, and reliability requirements while maintaining the integrity of the TDD workflow.</p><h2 id=testing-framework-architecture>Testing Framework Architecture<a class=headerlink href=#testing-framework-architecture title="Permanent link">&para;</a></h2><h3 id=1-test-pyramid-for-parallel-tdd>1. Test Pyramid for Parallel TDD<a class=headerlink href=#1-test-pyramid-for-parallel-tdd title="Permanent link">&para;</a></h3><div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos=" 1 "></span></a>                 /\
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos=" 2 "></span></a>                /  \
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos=" 3 "></span></a>               /    \
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos=" 4 "></span></a>              /      \
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos=" 5 "></span></a>             /  E2E   \
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos=" 6 "></span></a>            /  Tests   \
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos=" 7 "></span></a>           /____________\
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos=" 8 "></span></a>          /              \
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos=" 9 "></span></a>         /   Integration  \
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos="10 "></span></a>        /     Tests       \
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos="11 "></span></a>       /__________________\
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos="12 "></span></a>      /                    \
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos="13 "></span></a>     /     Unit Tests       \
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos="14 "></span></a>    /________________________\
</span></code></pre></div><p><strong>Distribution Target:</strong> - Unit Tests: 70% (Fast feedback, comprehensive coverage) - Integration Tests: 20% (Component interaction validation) - End-to-End Tests: 10% (Complete workflow validation)</p><h3 id=2-testing-infrastructure>2. Testing Infrastructure<a class=headerlink href=#2-testing-infrastructure title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><a href=#__codelineno-1-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>ParallelTDDTestFramework</span><span class=p>:</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a><a href=#__codelineno-1-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Comprehensive testing framework for parallel TDD system&quot;&quot;&quot;</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a><a href=#__codelineno-1-3><span class=linenos data-linenos=" 3 "></span></a>    
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a><a href=#__codelineno-1-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5></a><a href=#__codelineno-1-5><span class=linenos data-linenos=" 5 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>test_environments</span> <span class=o>=</span> <span class=n>TestEnvironmentManager</span><span class=p>()</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6></a><a href=#__codelineno-1-6><span class=linenos data-linenos=" 6 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>mock_factory</span> <span class=o>=</span> <span class=n>MockFactory</span><span class=p>()</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7></a><a href=#__codelineno-1-7><span class=linenos data-linenos=" 7 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>data_factory</span> <span class=o>=</span> <span class=n>TestDataFactory</span><span class=p>()</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8></a><a href=#__codelineno-1-8><span class=linenos data-linenos=" 8 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>performance_profiler</span> <span class=o>=</span> <span class=n>PerformanceProfiler</span><span class=p>()</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9></a><a href=#__codelineno-1-9><span class=linenos data-linenos=" 9 "></span></a>        <span class=bp>self</span><span class=o>.</span><span class=n>chaos_engine</span> <span class=o>=</span> <span class=n>ChaosTestingEngine</span><span class=p>()</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10></a><a href=#__codelineno-1-10><span class=linenos data-linenos="10 "></span></a>        
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11></a><a href=#__codelineno-1-11><span class=linenos data-linenos="11 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>setup_test_environment</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>test_type</span><span class=p>:</span> <span class=n>TestType</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TestEnvironment</span><span class=p>:</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12></a><a href=#__codelineno-1-12><span class=linenos data-linenos="12 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Set up isolated test environment&quot;&quot;&quot;</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13></a><a href=#__codelineno-1-13><span class=linenos data-linenos="13 "></span></a>        <span class=k>if</span> <span class=n>test_type</span> <span class=o>==</span> <span class=n>TestType</span><span class=o>.</span><span class=n>UNIT</span><span class=p>:</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14></a><a href=#__codelineno-1-14><span class=linenos data-linenos="14 "></span></a>            <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_unit_test_env</span><span class=p>()</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15></a><a href=#__codelineno-1-15><span class=linenos data-linenos="15 "></span></a>        <span class=k>elif</span> <span class=n>test_type</span> <span class=o>==</span> <span class=n>TestType</span><span class=o>.</span><span class=n>INTEGRATION</span><span class=p>:</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16></a><a href=#__codelineno-1-16><span class=linenos data-linenos="16 "></span></a>            <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_integration_test_env</span><span class=p>()</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17></a><a href=#__codelineno-1-17><span class=linenos data-linenos="17 "></span></a>        <span class=k>elif</span> <span class=n>test_type</span> <span class=o>==</span> <span class=n>TestType</span><span class=o>.</span><span class=n>E2E</span><span class=p>:</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18></a><a href=#__codelineno-1-18><span class=linenos data-linenos="18 "></span></a>            <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_e2e_test_env</span><span class=p>()</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19></a><a href=#__codelineno-1-19><span class=linenos data-linenos="19 "></span></a>        <span class=k>elif</span> <span class=n>test_type</span> <span class=o>==</span> <span class=n>TestType</span><span class=o>.</span><span class=n>PERFORMANCE</span><span class=p>:</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20></a><a href=#__codelineno-1-20><span class=linenos data-linenos="20 "></span></a>            <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_performance_test_env</span><span class=p>()</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21></a><a href=#__codelineno-1-21><span class=linenos data-linenos="21 "></span></a>            
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22></a><a href=#__codelineno-1-22><span class=linenos data-linenos="22 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_setup_integration_test_env</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TestEnvironment</span><span class=p>:</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23></a><a href=#__codelineno-1-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Set up environment for integration testing&quot;&quot;&quot;</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24></a><a href=#__codelineno-1-24><span class=linenos data-linenos="24 "></span></a>        <span class=n>env</span> <span class=o>=</span> <span class=n>TestEnvironment</span><span class=p>(</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25></a><a href=#__codelineno-1-25><span class=linenos data-linenos="25 "></span></a>            <span class=n>test_type</span><span class=o>=</span><span class=n>TestType</span><span class=o>.</span><span class=n>INTEGRATION</span><span class=p>,</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26></a><a href=#__codelineno-1-26><span class=linenos data-linenos="26 "></span></a>            <span class=n>isolation_level</span><span class=o>=</span><span class=n>IsolationLevel</span><span class=o>.</span><span class=n>CONTAINER</span><span class=p>,</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27></a><a href=#__codelineno-1-27><span class=linenos data-linenos="27 "></span></a>            <span class=n>resource_limits</span><span class=o>=</span><span class=n>ResourceLimits</span><span class=p>(</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28></a><a href=#__codelineno-1-28><span class=linenos data-linenos="28 "></span></a>                <span class=n>memory_mb</span><span class=o>=</span><span class=mi>4096</span><span class=p>,</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29></a><a href=#__codelineno-1-29><span class=linenos data-linenos="29 "></span></a>                <span class=n>cpu_cores</span><span class=o>=</span><span class=mf>4.0</span><span class=p>,</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30></a><a href=#__codelineno-1-30><span class=linenos data-linenos="30 "></span></a>                <span class=n>disk_gb</span><span class=o>=</span><span class=mi>10</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31></a><a href=#__codelineno-1-31><span class=linenos data-linenos="31 "></span></a>            <span class=p>)</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32></a><a href=#__codelineno-1-32><span class=linenos data-linenos="32 "></span></a>        <span class=p>)</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33></a><a href=#__codelineno-1-33><span class=linenos data-linenos="33 "></span></a>        
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34></a><a href=#__codelineno-1-34><span class=linenos data-linenos="34 "></span></a>        <span class=c1># Set up test databases</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35></a><a href=#__codelineno-1-35><span class=linenos data-linenos="35 "></span></a>        <span class=k>await</span> <span class=n>env</span><span class=o>.</span><span class=n>create_test_database</span><span class=p>()</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36></a><a href=#__codelineno-1-36><span class=linenos data-linenos="36 "></span></a>        
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37></a><a href=#__codelineno-1-37><span class=linenos data-linenos="37 "></span></a>        <span class=c1># Set up mock external services</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38></a><a href=#__codelineno-1-38><span class=linenos data-linenos="38 "></span></a>        <span class=k>await</span> <span class=n>env</span><span class=o>.</span><span class=n>setup_mock_services</span><span class=p>([</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39></a><a href=#__codelineno-1-39><span class=linenos data-linenos="39 "></span></a>            <span class=s1>&#39;discord_api&#39;</span><span class=p>,</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40></a><a href=#__codelineno-1-40><span class=linenos data-linenos="40 "></span></a>            <span class=s1>&#39;github_api&#39;</span><span class=p>,</span> 
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41></a><a href=#__codelineno-1-41><span class=linenos data-linenos="41 "></span></a>            <span class=s1>&#39;claude_code_cli&#39;</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42></a><a href=#__codelineno-1-42><span class=linenos data-linenos="42 "></span></a>        <span class=p>])</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43></a><a href=#__codelineno-1-43><span class=linenos data-linenos="43 "></span></a>        
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44></a><a href=#__codelineno-1-44><span class=linenos data-linenos="44 "></span></a>        <span class=c1># Initialize test data</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45></a><a href=#__codelineno-1-45><span class=linenos data-linenos="45 "></span></a>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_factory</span><span class=o>.</span><span class=n>populate_test_data</span><span class=p>(</span><span class=n>env</span><span class=p>)</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46></a><a href=#__codelineno-1-46><span class=linenos data-linenos="46 "></span></a>        
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47></a><a href=#__codelineno-1-47><span class=linenos data-linenos="47 "></span></a>        <span class=k>return</span> <span class=n>env</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48></a><a href=#__codelineno-1-48><span class=linenos data-linenos="48 "></span></a>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49></a><a href=#__codelineno-1-49><span class=linenos data-linenos="49 "></span></a><span class=k>class</span> <span class=nc>TestDataFactory</span><span class=p>:</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50></a><a href=#__codelineno-1-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Generate realistic test data for parallel TDD testing&quot;&quot;&quot;</span>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51></a><a href=#__codelineno-1-51><span class=linenos data-linenos="51 "></span></a>    
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52></a><a href=#__codelineno-1-52><span class=linenos data-linenos="52 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create_parallel_test_scenario</span><span class=p>(</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53></a><a href=#__codelineno-1-53><span class=linenos data-linenos="53 "></span></a>        <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54></a><a href=#__codelineno-1-54><span class=linenos data-linenos="54 "></span></a>        <span class=n>num_cycles</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55></a><a href=#__codelineno-1-55><span class=linenos data-linenos="55 "></span></a>        <span class=n>conflict_probability</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.2</span><span class=p>,</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56></a><a href=#__codelineno-1-56><span class=linenos data-linenos="56 "></span></a>        <span class=n>complexity_distribution</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;normal&quot;</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57></a><a href=#__codelineno-1-57><span class=linenos data-linenos="57 "></span></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ParallelTestScenario</span><span class=p>:</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58></a><a href=#__codelineno-1-58><span class=linenos data-linenos="58 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Create realistic parallel execution test scenario&quot;&quot;&quot;</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59></a><a href=#__codelineno-1-59><span class=linenos data-linenos="59 "></span></a>        
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60></a><a href=#__codelineno-1-60><span class=linenos data-linenos="60 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61></a><a href=#__codelineno-1-61><span class=linenos data-linenos="61 "></span></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_cycles</span><span class=p>):</span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62></a><a href=#__codelineno-1-62><span class=linenos data-linenos="62 "></span></a>            <span class=n>story</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_test_story</span><span class=p>(</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63></a><a href=#__codelineno-1-63><span class=linenos data-linenos="63 "></span></a>                <span class=n>story_id</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;test_story_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64></a><a href=#__codelineno-1-64><span class=linenos data-linenos="64 "></span></a>                <span class=n>complexity</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_sample_complexity</span><span class=p>(</span><span class=n>complexity_distribution</span><span class=p>),</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65></a><a href=#__codelineno-1-65><span class=linenos data-linenos="65 "></span></a>                <span class=n>files</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_generate_story_files</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>conflict_probability</span><span class=p>)</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66></a><a href=#__codelineno-1-66><span class=linenos data-linenos="66 "></span></a>            <span class=p>)</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67></a><a href=#__codelineno-1-67><span class=linenos data-linenos="67 "></span></a>            <span class=n>stories</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>story</span><span class=p>)</span>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68></a><a href=#__codelineno-1-68><span class=linenos data-linenos="68 "></span></a>            
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69></a><a href=#__codelineno-1-69><span class=linenos data-linenos="69 "></span></a>        <span class=k>return</span> <span class=n>ParallelTestScenario</span><span class=p>(</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70></a><a href=#__codelineno-1-70><span class=linenos data-linenos="70 "></span></a>            <span class=n>stories</span><span class=o>=</span><span class=n>stories</span><span class=p>,</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71></a><a href=#__codelineno-1-71><span class=linenos data-linenos="71 "></span></a>            <span class=n>expected_conflicts</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_calculate_expected_conflicts</span><span class=p>(</span><span class=n>stories</span><span class=p>),</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72></a><a href=#__codelineno-1-72><span class=linenos data-linenos="72 "></span></a>            <span class=n>expected_duration</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_estimate_execution_time</span><span class=p>(</span><span class=n>stories</span><span class=p>),</span>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73></a><a href=#__codelineno-1-73><span class=linenos data-linenos="73 "></span></a>            <span class=n>success_criteria</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_define_success_criteria</span><span class=p>(</span><span class=n>stories</span><span class=p>)</span>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74></a><a href=#__codelineno-1-74><span class=linenos data-linenos="74 "></span></a>        <span class=p>)</span>
</span></code></pre></div><h2 id=unit-testing-strategy>Unit Testing Strategy<a class=headerlink href=#unit-testing-strategy title="Permanent link">&para;</a></h2><h3 id=1-component-level-unit-tests>1. Component-Level Unit Tests<a class=headerlink href=#1-component-level-unit-tests title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><a href=#__codelineno-2-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>TestParallelCoordinator</span><span class=p>:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2></a><a href=#__codelineno-2-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Comprehensive unit tests for ParallelCoordinator&quot;&quot;&quot;</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3></a><a href=#__codelineno-2-3><span class=linenos data-linenos="  3 "></span></a>    
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4></a><a href=#__codelineno-2-4><span class=linenos data-linenos="  4 "></span></a>    <span class=nd>@pytest</span><span class=o>.</span><span class=n>fixture</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5></a><a href=#__codelineno-2-5><span class=linenos data-linenos="  5 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>coordinator</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6></a><a href=#__codelineno-2-6><span class=linenos data-linenos="  6 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Set up coordinator with mocked dependencies&quot;&quot;&quot;</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7></a><a href=#__codelineno-2-7><span class=linenos data-linenos="  7 "></span></a>        <span class=n>mock_storage</span> <span class=o>=</span> <span class=n>Mock</span><span class=p>(</span><span class=n>spec</span><span class=o>=</span><span class=n>ProjectStorage</span><span class=p>)</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8></a><a href=#__codelineno-2-8><span class=linenos data-linenos="  8 "></span></a>        <span class=n>mock_agent_pool</span> <span class=o>=</span> <span class=n>Mock</span><span class=p>(</span><span class=n>spec</span><span class=o>=</span><span class=n>AgentPoolManager</span><span class=p>)</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9></a><a href=#__codelineno-2-9><span class=linenos data-linenos="  9 "></span></a>        <span class=n>mock_context_manager</span> <span class=o>=</span> <span class=n>Mock</span><span class=p>(</span><span class=n>spec</span><span class=o>=</span><span class=n>ParallelContextManager</span><span class=p>)</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10></a><a href=#__codelineno-2-10><span class=linenos data-linenos=" 10 "></span></a>        
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11></a><a href=#__codelineno-2-11><span class=linenos data-linenos=" 11 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>ParallelCoordinator</span><span class=p>(</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12></a><a href=#__codelineno-2-12><span class=linenos data-linenos=" 12 "></span></a>            <span class=n>max_parallel</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13></a><a href=#__codelineno-2-13><span class=linenos data-linenos=" 13 "></span></a>            <span class=n>storage</span><span class=o>=</span><span class=n>mock_storage</span><span class=p>,</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14></a><a href=#__codelineno-2-14><span class=linenos data-linenos=" 14 "></span></a>            <span class=n>agent_pool_manager</span><span class=o>=</span><span class=n>mock_agent_pool</span><span class=p>,</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15></a><a href=#__codelineno-2-15><span class=linenos data-linenos=" 15 "></span></a>            <span class=n>context_manager</span><span class=o>=</span><span class=n>mock_context_manager</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16></a><a href=#__codelineno-2-16><span class=linenos data-linenos=" 16 "></span></a>        <span class=p>)</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17></a><a href=#__codelineno-2-17><span class=linenos data-linenos=" 17 "></span></a>        <span class=k>return</span> <span class=n>coordinator</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18></a><a href=#__codelineno-2-18><span class=linenos data-linenos=" 18 "></span></a>        
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19></a><a href=#__codelineno-2-19><span class=linenos data-linenos=" 19 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_can_start_cycle_with_available_resources</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>coordinator</span><span class=p>):</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20></a><a href=#__codelineno-2-20><span class=linenos data-linenos=" 20 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test cycle can start when resources are available&quot;&quot;&quot;</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21></a><a href=#__codelineno-2-21><span class=linenos data-linenos=" 21 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22></a><a href=#__codelineno-2-22><span class=linenos data-linenos=" 22 "></span></a>        <span class=n>story</span> <span class=o>=</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_simple_story</span><span class=p>()</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23></a><a href=#__codelineno-2-23><span class=linenos data-linenos=" 23 "></span></a>        <span class=n>coordinator</span><span class=o>.</span><span class=n>active_cycles</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24></a><a href=#__codelineno-2-24><span class=linenos data-linenos=" 24 "></span></a>        <span class=n>coordinator</span><span class=o>.</span><span class=n>resource_allocator</span><span class=o>.</span><span class=n>check_availability</span><span class=o>.</span><span class=n>return_value</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25></a><a href=#__codelineno-2-25><span class=linenos data-linenos=" 25 "></span></a>        
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26></a><a href=#__codelineno-2-26><span class=linenos data-linenos=" 26 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27></a><a href=#__codelineno-2-27><span class=linenos data-linenos=" 27 "></span></a>        <span class=n>can_start</span><span class=p>,</span> <span class=n>reason</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>can_start_cycle</span><span class=p>(</span><span class=n>story</span><span class=p>)</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28></a><a href=#__codelineno-2-28><span class=linenos data-linenos=" 28 "></span></a>        
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29></a><a href=#__codelineno-2-29><span class=linenos data-linenos=" 29 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30></a><a href=#__codelineno-2-30><span class=linenos data-linenos=" 30 "></span></a>        <span class=k>assert</span> <span class=n>can_start</span> <span class=ow>is</span> <span class=kc>True</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31></a><a href=#__codelineno-2-31><span class=linenos data-linenos=" 31 "></span></a>        <span class=k>assert</span> <span class=n>reason</span> <span class=ow>is</span> <span class=kc>None</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32></a><a href=#__codelineno-2-32><span class=linenos data-linenos=" 32 "></span></a>        
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33></a><a href=#__codelineno-2-33><span class=linenos data-linenos=" 33 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_cannot_start_cycle_when_max_parallel_reached</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>coordinator</span><span class=p>):</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34></a><a href=#__codelineno-2-34><span class=linenos data-linenos=" 34 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test cycle cannot start when max parallel limit reached&quot;&quot;&quot;</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35></a><a href=#__codelineno-2-35><span class=linenos data-linenos=" 35 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36></a><a href=#__codelineno-2-36><span class=linenos data-linenos=" 36 "></span></a>        <span class=n>story</span> <span class=o>=</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_simple_story</span><span class=p>()</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37></a><a href=#__codelineno-2-37><span class=linenos data-linenos=" 37 "></span></a>        <span class=n>coordinator</span><span class=o>.</span><span class=n>active_cycles</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-2-38><a id=__codelineno-2-38 name=__codelineno-2-38></a><a href=#__codelineno-2-38><span class=linenos data-linenos=" 38 "></span></a>            <span class=s1>&#39;cycle1&#39;</span><span class=p>:</span> <span class=n>Mock</span><span class=p>(),</span>
</span><span id=__span-2-39><a id=__codelineno-2-39 name=__codelineno-2-39></a><a href=#__codelineno-2-39><span class=linenos data-linenos=" 39 "></span></a>            <span class=s1>&#39;cycle2&#39;</span><span class=p>:</span> <span class=n>Mock</span><span class=p>(),</span> 
</span><span id=__span-2-40><a id=__codelineno-2-40 name=__codelineno-2-40></a><a href=#__codelineno-2-40><span class=linenos data-linenos=" 40 "></span></a>            <span class=s1>&#39;cycle3&#39;</span><span class=p>:</span> <span class=n>Mock</span><span class=p>()</span>
</span><span id=__span-2-41><a id=__codelineno-2-41 name=__codelineno-2-41></a><a href=#__codelineno-2-41><span class=linenos data-linenos=" 41 "></span></a>        <span class=p>}</span>
</span><span id=__span-2-42><a id=__codelineno-2-42 name=__codelineno-2-42></a><a href=#__codelineno-2-42><span class=linenos data-linenos=" 42 "></span></a>        
</span><span id=__span-2-43><a id=__codelineno-2-43 name=__codelineno-2-43></a><a href=#__codelineno-2-43><span class=linenos data-linenos=" 43 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-44><a id=__codelineno-2-44 name=__codelineno-2-44></a><a href=#__codelineno-2-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=n>can_start</span><span class=p>,</span> <span class=n>reason</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>can_start_cycle</span><span class=p>(</span><span class=n>story</span><span class=p>)</span>
</span><span id=__span-2-45><a id=__codelineno-2-45 name=__codelineno-2-45></a><a href=#__codelineno-2-45><span class=linenos data-linenos=" 45 "></span></a>        
</span><span id=__span-2-46><a id=__codelineno-2-46 name=__codelineno-2-46></a><a href=#__codelineno-2-46><span class=linenos data-linenos=" 46 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-47><a id=__codelineno-2-47 name=__codelineno-2-47></a><a href=#__codelineno-2-47><span class=linenos data-linenos=" 47 "></span></a>        <span class=k>assert</span> <span class=n>can_start</span> <span class=ow>is</span> <span class=kc>False</span>
</span><span id=__span-2-48><a id=__codelineno-2-48 name=__codelineno-2-48></a><a href=#__codelineno-2-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;Max parallel cycles reached&quot;</span> <span class=ow>in</span> <span class=n>reason</span>
</span><span id=__span-2-49><a id=__codelineno-2-49 name=__codelineno-2-49></a><a href=#__codelineno-2-49><span class=linenos data-linenos=" 49 "></span></a>        
</span><span id=__span-2-50><a id=__codelineno-2-50 name=__codelineno-2-50></a><a href=#__codelineno-2-50><span class=linenos data-linenos=" 50 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_conflict_detection_identifies_file_overlap</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>coordinator</span><span class=p>):</span>
</span><span id=__span-2-51><a id=__codelineno-2-51 name=__codelineno-2-51></a><a href=#__codelineno-2-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test conflict detection identifies overlapping files&quot;&quot;&quot;</span>
</span><span id=__span-2-52><a id=__codelineno-2-52 name=__codelineno-2-52></a><a href=#__codelineno-2-52><span class=linenos data-linenos=" 52 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-53><a id=__codelineno-2-53 name=__codelineno-2-53></a><a href=#__codelineno-2-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=n>cycle1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_test_cycle</span><span class=p>(</span><span class=n>files</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;user.py&quot;</span><span class=p>,</span> <span class=s2>&quot;auth.py&quot;</span><span class=p>])</span>
</span><span id=__span-2-54><a id=__codelineno-2-54 name=__codelineno-2-54></a><a href=#__codelineno-2-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=n>cycle2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_test_cycle</span><span class=p>(</span><span class=n>files</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;auth.py&quot;</span><span class=p>,</span> <span class=s2>&quot;db.py&quot;</span><span class=p>])</span>
</span><span id=__span-2-55><a id=__codelineno-2-55 name=__codelineno-2-55></a><a href=#__codelineno-2-55><span class=linenos data-linenos=" 55 "></span></a>        
</span><span id=__span-2-56><a id=__codelineno-2-56 name=__codelineno-2-56></a><a href=#__codelineno-2-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-57><a id=__codelineno-2-57 name=__codelineno-2-57></a><a href=#__codelineno-2-57><span class=linenos data-linenos=" 57 "></span></a>        <span class=n>conflicts</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>detect_conflicts</span><span class=p>(</span><span class=n>cycle1</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=n>cycle2</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-2-58><a id=__codelineno-2-58 name=__codelineno-2-58></a><a href=#__codelineno-2-58><span class=linenos data-linenos=" 58 "></span></a>        
</span><span id=__span-2-59><a id=__codelineno-2-59 name=__codelineno-2-59></a><a href=#__codelineno-2-59><span class=linenos data-linenos=" 59 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-60><a id=__codelineno-2-60 name=__codelineno-2-60></a><a href=#__codelineno-2-60><span class=linenos data-linenos=" 60 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>conflicts</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>
</span><span id=__span-2-61><a id=__codelineno-2-61 name=__codelineno-2-61></a><a href=#__codelineno-2-61><span class=linenos data-linenos=" 61 "></span></a>        <span class=k>assert</span> <span class=n>conflicts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=n>ConflictType</span><span class=o>.</span><span class=n>FILE_OVERLAP</span>
</span><span id=__span-2-62><a id=__codelineno-2-62 name=__codelineno-2-62></a><a href=#__codelineno-2-62><span class=linenos data-linenos=" 62 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;auth.py&quot;</span> <span class=ow>in</span> <span class=n>conflicts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>resources</span>
</span><span id=__span-2-63><a id=__codelineno-2-63 name=__codelineno-2-63></a><a href=#__codelineno-2-63><span class=linenos data-linenos=" 63 "></span></a>        
</span><span id=__span-2-64><a id=__codelineno-2-64 name=__codelineno-2-64></a><a href=#__codelineno-2-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_graceful_degradation_on_agent_failure</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>coordinator</span><span class=p>):</span>
</span><span id=__span-2-65><a id=__codelineno-2-65 name=__codelineno-2-65></a><a href=#__codelineno-2-65><span class=linenos data-linenos=" 65 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system degrades gracefully when agents fail&quot;&quot;&quot;</span>
</span><span id=__span-2-66><a id=__codelineno-2-66 name=__codelineno-2-66></a><a href=#__codelineno-2-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-67><a id=__codelineno-2-67 name=__codelineno-2-67></a><a href=#__codelineno-2-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>story</span> <span class=o>=</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_simple_story</span><span class=p>()</span>
</span><span id=__span-2-68><a id=__codelineno-2-68 name=__codelineno-2-68></a><a href=#__codelineno-2-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=n>coordinator</span><span class=o>.</span><span class=n>agent_pool_manager</span><span class=o>.</span><span class=n>acquire_agent</span><span class=o>.</span><span class=n>side_effect</span> <span class=o>=</span> <span class=n>AgentPoolExhausted</span><span class=p>()</span>
</span><span id=__span-2-69><a id=__codelineno-2-69 name=__codelineno-2-69></a><a href=#__codelineno-2-69><span class=linenos data-linenos=" 69 "></span></a>        
</span><span id=__span-2-70><a id=__codelineno-2-70 name=__codelineno-2-70></a><a href=#__codelineno-2-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=c1># Act &amp; Assert</span>
</span><span id=__span-2-71><a id=__codelineno-2-71 name=__codelineno-2-71></a><a href=#__codelineno-2-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=k>with</span> <span class=n>pytest</span><span class=o>.</span><span class=n>raises</span><span class=p>(</span><span class=n>AgentPoolExhausted</span><span class=p>):</span>
</span><span id=__span-2-72><a id=__codelineno-2-72 name=__codelineno-2-72></a><a href=#__codelineno-2-72><span class=linenos data-linenos=" 72 "></span></a>            <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>start_cycle</span><span class=p>(</span><span class=n>story</span><span class=p>)</span>
</span><span id=__span-2-73><a id=__codelineno-2-73 name=__codelineno-2-73></a><a href=#__codelineno-2-73><span class=linenos data-linenos=" 73 "></span></a>            
</span><span id=__span-2-74><a id=__codelineno-2-74 name=__codelineno-2-74></a><a href=#__codelineno-2-74><span class=linenos data-linenos=" 74 "></span></a>        <span class=c1># Verify fallback mechanisms triggered</span>
</span><span id=__span-2-75><a id=__codelineno-2-75 name=__codelineno-2-75></a><a href=#__codelineno-2-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=k>assert</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>fallback_triggered</span> <span class=ow>is</span> <span class=kc>True</span>
</span><span id=__span-2-76><a id=__codelineno-2-76 name=__codelineno-2-76></a><a href=#__codelineno-2-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-2-77><a id=__codelineno-2-77 name=__codelineno-2-77></a><a href=#__codelineno-2-77><span class=linenos data-linenos=" 77 "></span></a><span class=k>class</span> <span class=nc>TestConflictResolver</span><span class=p>:</span>
</span><span id=__span-2-78><a id=__codelineno-2-78 name=__codelineno-2-78></a><a href=#__codelineno-2-78><span class=linenos data-linenos=" 78 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Unit tests for conflict resolution algorithms&quot;&quot;&quot;</span>
</span><span id=__span-2-79><a id=__codelineno-2-79 name=__codelineno-2-79></a><a href=#__codelineno-2-79><span class=linenos data-linenos=" 79 "></span></a>    
</span><span id=__span-2-80><a id=__codelineno-2-80 name=__codelineno-2-80></a><a href=#__codelineno-2-80><span class=linenos data-linenos=" 80 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_ast_merge_resolves_non_overlapping_changes</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-2-81><a id=__codelineno-2-81 name=__codelineno-2-81></a><a href=#__codelineno-2-81><span class=linenos data-linenos=" 81 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test AST merge successfully resolves non-overlapping changes&quot;&quot;&quot;</span>
</span><span id=__span-2-82><a id=__codelineno-2-82 name=__codelineno-2-82></a><a href=#__codelineno-2-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-83><a id=__codelineno-2-83 name=__codelineno-2-83></a><a href=#__codelineno-2-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>base_code</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-84><a id=__codelineno-2-84 name=__codelineno-2-84></a><a href=#__codelineno-2-84><span class=linenos data-linenos=" 84 "></span></a><span class=s1>def function_a():</span>
</span><span id=__span-2-85><a id=__codelineno-2-85 name=__codelineno-2-85></a><a href=#__codelineno-2-85><span class=linenos data-linenos=" 85 "></span></a><span class=s1>    pass</span>
</span><span id=__span-2-86><a id=__codelineno-2-86 name=__codelineno-2-86></a><a href=#__codelineno-2-86><span class=linenos data-linenos=" 86 "></span></a><span class=s1>    </span>
</span><span id=__span-2-87><a id=__codelineno-2-87 name=__codelineno-2-87></a><a href=#__codelineno-2-87><span class=linenos data-linenos=" 87 "></span></a><span class=s1>def function_b():</span>
</span><span id=__span-2-88><a id=__codelineno-2-88 name=__codelineno-2-88></a><a href=#__codelineno-2-88><span class=linenos data-linenos=" 88 "></span></a><span class=s1>    pass</span>
</span><span id=__span-2-89><a id=__codelineno-2-89 name=__codelineno-2-89></a><a href=#__codelineno-2-89><span class=linenos data-linenos=" 89 "></span></a><span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-90><a id=__codelineno-2-90 name=__codelineno-2-90></a><a href=#__codelineno-2-90><span class=linenos data-linenos=" 90 "></span></a>        
</span><span id=__span-2-91><a id=__codelineno-2-91 name=__codelineno-2-91></a><a href=#__codelineno-2-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=n>version1</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-92><a id=__codelineno-2-92 name=__codelineno-2-92></a><a href=#__codelineno-2-92><span class=linenos data-linenos=" 92 "></span></a><span class=s1>def function_a():</span>
</span><span id=__span-2-93><a id=__codelineno-2-93 name=__codelineno-2-93></a><a href=#__codelineno-2-93><span class=linenos data-linenos=" 93 "></span></a><span class=s1>    return &quot;modified_a&quot;</span>
</span><span id=__span-2-94><a id=__codelineno-2-94 name=__codelineno-2-94></a><a href=#__codelineno-2-94><span class=linenos data-linenos=" 94 "></span></a><span class=s1>    </span>
</span><span id=__span-2-95><a id=__codelineno-2-95 name=__codelineno-2-95></a><a href=#__codelineno-2-95><span class=linenos data-linenos=" 95 "></span></a><span class=s1>def function_b():</span>
</span><span id=__span-2-96><a id=__codelineno-2-96 name=__codelineno-2-96></a><a href=#__codelineno-2-96><span class=linenos data-linenos=" 96 "></span></a><span class=s1>    pass</span>
</span><span id=__span-2-97><a id=__codelineno-2-97 name=__codelineno-2-97></a><a href=#__codelineno-2-97><span class=linenos data-linenos=" 97 "></span></a><span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-98><a id=__codelineno-2-98 name=__codelineno-2-98></a><a href=#__codelineno-2-98><span class=linenos data-linenos=" 98 "></span></a>        
</span><span id=__span-2-99><a id=__codelineno-2-99 name=__codelineno-2-99></a><a href=#__codelineno-2-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>version2</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-100><a id=__codelineno-2-100 name=__codelineno-2-100></a><a href=#__codelineno-2-100><span class=linenos data-linenos="100 "></span></a><span class=s1>def function_a():</span>
</span><span id=__span-2-101><a id=__codelineno-2-101 name=__codelineno-2-101></a><a href=#__codelineno-2-101><span class=linenos data-linenos="101 "></span></a><span class=s1>    pass</span>
</span><span id=__span-2-102><a id=__codelineno-2-102 name=__codelineno-2-102></a><a href=#__codelineno-2-102><span class=linenos data-linenos="102 "></span></a><span class=s1>    </span>
</span><span id=__span-2-103><a id=__codelineno-2-103 name=__codelineno-2-103></a><a href=#__codelineno-2-103><span class=linenos data-linenos="103 "></span></a><span class=s1>def function_b():</span>
</span><span id=__span-2-104><a id=__codelineno-2-104 name=__codelineno-2-104></a><a href=#__codelineno-2-104><span class=linenos data-linenos="104 "></span></a><span class=s1>    return &quot;modified_b&quot;</span>
</span><span id=__span-2-105><a id=__codelineno-2-105 name=__codelineno-2-105></a><a href=#__codelineno-2-105><span class=linenos data-linenos="105 "></span></a><span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-106><a id=__codelineno-2-106 name=__codelineno-2-106></a><a href=#__codelineno-2-106><span class=linenos data-linenos="106 "></span></a>        
</span><span id=__span-2-107><a id=__codelineno-2-107 name=__codelineno-2-107></a><a href=#__codelineno-2-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>conflict</span> <span class=o>=</span> <span class=n>Conflict</span><span class=p>(</span>
</span><span id=__span-2-108><a id=__codelineno-2-108 name=__codelineno-2-108></a><a href=#__codelineno-2-108><span class=linenos data-linenos="108 "></span></a>            <span class=nb>type</span><span class=o>=</span><span class=n>ConflictType</span><span class=o>.</span><span class=n>FILE_OVERLAP</span><span class=p>,</span>
</span><span id=__span-2-109><a id=__codelineno-2-109 name=__codelineno-2-109></a><a href=#__codelineno-2-109><span class=linenos data-linenos="109 "></span></a>            <span class=n>resource</span><span class=o>=</span><span class=s2>&quot;test_file.py&quot;</span><span class=p>,</span>
</span><span id=__span-2-110><a id=__codelineno-2-110 name=__codelineno-2-110></a><a href=#__codelineno-2-110><span class=linenos data-linenos="110 "></span></a>            <span class=n>cycles</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;cycle1&quot;</span><span class=p>,</span> <span class=s2>&quot;cycle2&quot;</span><span class=p>]</span>
</span><span id=__span-2-111><a id=__codelineno-2-111 name=__codelineno-2-111></a><a href=#__codelineno-2-111><span class=linenos data-linenos="111 "></span></a>        <span class=p>)</span>
</span><span id=__span-2-112><a id=__codelineno-2-112 name=__codelineno-2-112></a><a href=#__codelineno-2-112><span class=linenos data-linenos="112 "></span></a>        
</span><span id=__span-2-113><a id=__codelineno-2-113 name=__codelineno-2-113></a><a href=#__codelineno-2-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>resolver</span> <span class=o>=</span> <span class=n>AutoMergeResolver</span><span class=p>()</span>
</span><span id=__span-2-114><a id=__codelineno-2-114 name=__codelineno-2-114></a><a href=#__codelineno-2-114><span class=linenos data-linenos="114 "></span></a>        
</span><span id=__span-2-115><a id=__codelineno-2-115 name=__codelineno-2-115></a><a href=#__codelineno-2-115><span class=linenos data-linenos="115 "></span></a>        <span class=c1># Mock file versions</span>
</span><span id=__span-2-116><a id=__codelineno-2-116 name=__codelineno-2-116></a><a href=#__codelineno-2-116><span class=linenos data-linenos="116 "></span></a>        <span class=n>resolver</span><span class=o>.</span><span class=n>_get_cycle_file_version</span> <span class=o>=</span> <span class=n>AsyncMock</span><span class=p>(</span><span class=n>side_effect</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-2-117><a id=__codelineno-2-117 name=__codelineno-2-117></a><a href=#__codelineno-2-117><span class=linenos data-linenos="117 "></span></a>            <span class=n>FileVersion</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>version1</span><span class=p>),</span>
</span><span id=__span-2-118><a id=__codelineno-2-118 name=__codelineno-2-118></a><a href=#__codelineno-2-118><span class=linenos data-linenos="118 "></span></a>            <span class=n>FileVersion</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>version2</span><span class=p>)</span>
</span><span id=__span-2-119><a id=__codelineno-2-119 name=__codelineno-2-119></a><a href=#__codelineno-2-119><span class=linenos data-linenos="119 "></span></a>        <span class=p>])</span>
</span><span id=__span-2-120><a id=__codelineno-2-120 name=__codelineno-2-120></a><a href=#__codelineno-2-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>resolver</span><span class=o>.</span><span class=n>_get_base_file_version</span> <span class=o>=</span> <span class=n>AsyncMock</span><span class=p>(</span><span class=n>return_value</span><span class=o>=</span><span class=n>FileVersion</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>base_code</span><span class=p>))</span>
</span><span id=__span-2-121><a id=__codelineno-2-121 name=__codelineno-2-121></a><a href=#__codelineno-2-121><span class=linenos data-linenos="121 "></span></a>        
</span><span id=__span-2-122><a id=__codelineno-2-122 name=__codelineno-2-122></a><a href=#__codelineno-2-122><span class=linenos data-linenos="122 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-123><a id=__codelineno-2-123 name=__codelineno-2-123></a><a href=#__codelineno-2-123><span class=linenos data-linenos="123 "></span></a>        <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>resolver</span><span class=o>.</span><span class=n>_try_ast_merge</span><span class=p>(</span><span class=n>conflict</span><span class=p>)</span>
</span><span id=__span-2-124><a id=__codelineno-2-124 name=__codelineno-2-124></a><a href=#__codelineno-2-124><span class=linenos data-linenos="124 "></span></a>        
</span><span id=__span-2-125><a id=__codelineno-2-125 name=__codelineno-2-125></a><a href=#__codelineno-2-125><span class=linenos data-linenos="125 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-126><a id=__codelineno-2-126 name=__codelineno-2-126></a><a href=#__codelineno-2-126><span class=linenos data-linenos="126 "></span></a>        <span class=k>assert</span> <span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=ow>is</span> <span class=kc>True</span>
</span><span id=__span-2-127><a id=__codelineno-2-127 name=__codelineno-2-127></a><a href=#__codelineno-2-127><span class=linenos data-linenos="127 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;return </span><span class=se>\&quot;</span><span class=s2>modified_a</span><span class=se>\&quot;</span><span class=s2>&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>merged_content</span>
</span><span id=__span-2-128><a id=__codelineno-2-128 name=__codelineno-2-128></a><a href=#__codelineno-2-128><span class=linenos data-linenos="128 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;return </span><span class=se>\&quot;</span><span class=s2>modified_b</span><span class=se>\&quot;</span><span class=s2>&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>merged_content</span>
</span><span id=__span-2-129><a id=__codelineno-2-129 name=__codelineno-2-129></a><a href=#__codelineno-2-129><span class=linenos data-linenos="129 "></span></a>        
</span><span id=__span-2-130><a id=__codelineno-2-130 name=__codelineno-2-130></a><a href=#__codelineno-2-130><span class=linenos data-linenos="130 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_ast_merge_fails_on_conflicting_changes</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-2-131><a id=__codelineno-2-131 name=__codelineno-2-131></a><a href=#__codelineno-2-131><span class=linenos data-linenos="131 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test AST merge fails when changes conflict&quot;&quot;&quot;</span>
</span><span id=__span-2-132><a id=__codelineno-2-132 name=__codelineno-2-132></a><a href=#__codelineno-2-132><span class=linenos data-linenos="132 "></span></a>        <span class=c1># Arrange - both cycles modify the same function</span>
</span><span id=__span-2-133><a id=__codelineno-2-133 name=__codelineno-2-133></a><a href=#__codelineno-2-133><span class=linenos data-linenos="133 "></span></a>        <span class=n>base_code</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-134><a id=__codelineno-2-134 name=__codelineno-2-134></a><a href=#__codelineno-2-134><span class=linenos data-linenos="134 "></span></a><span class=s1>def function_a():</span>
</span><span id=__span-2-135><a id=__codelineno-2-135 name=__codelineno-2-135></a><a href=#__codelineno-2-135><span class=linenos data-linenos="135 "></span></a><span class=s1>    pass</span>
</span><span id=__span-2-136><a id=__codelineno-2-136 name=__codelineno-2-136></a><a href=#__codelineno-2-136><span class=linenos data-linenos="136 "></span></a><span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-137><a id=__codelineno-2-137 name=__codelineno-2-137></a><a href=#__codelineno-2-137><span class=linenos data-linenos="137 "></span></a>        
</span><span id=__span-2-138><a id=__codelineno-2-138 name=__codelineno-2-138></a><a href=#__codelineno-2-138><span class=linenos data-linenos="138 "></span></a>        <span class=n>version1</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-139><a id=__codelineno-2-139 name=__codelineno-2-139></a><a href=#__codelineno-2-139><span class=linenos data-linenos="139 "></span></a><span class=s1>def function_a():</span>
</span><span id=__span-2-140><a id=__codelineno-2-140 name=__codelineno-2-140></a><a href=#__codelineno-2-140><span class=linenos data-linenos="140 "></span></a><span class=s1>    return &quot;version_1&quot;</span>
</span><span id=__span-2-141><a id=__codelineno-2-141 name=__codelineno-2-141></a><a href=#__codelineno-2-141><span class=linenos data-linenos="141 "></span></a><span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-142><a id=__codelineno-2-142 name=__codelineno-2-142></a><a href=#__codelineno-2-142><span class=linenos data-linenos="142 "></span></a>        
</span><span id=__span-2-143><a id=__codelineno-2-143 name=__codelineno-2-143></a><a href=#__codelineno-2-143><span class=linenos data-linenos="143 "></span></a>        <span class=n>version2</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-144><a id=__codelineno-2-144 name=__codelineno-2-144></a><a href=#__codelineno-2-144><span class=linenos data-linenos="144 "></span></a><span class=s1>def function_a():</span>
</span><span id=__span-2-145><a id=__codelineno-2-145 name=__codelineno-2-145></a><a href=#__codelineno-2-145><span class=linenos data-linenos="145 "></span></a><span class=s1>    return &quot;version_2&quot;</span>
</span><span id=__span-2-146><a id=__codelineno-2-146 name=__codelineno-2-146></a><a href=#__codelineno-2-146><span class=linenos data-linenos="146 "></span></a><span class=s1>&#39;&#39;&#39;</span>
</span><span id=__span-2-147><a id=__codelineno-2-147 name=__codelineno-2-147></a><a href=#__codelineno-2-147><span class=linenos data-linenos="147 "></span></a>        
</span><span id=__span-2-148><a id=__codelineno-2-148 name=__codelineno-2-148></a><a href=#__codelineno-2-148><span class=linenos data-linenos="148 "></span></a>        <span class=n>conflict</span> <span class=o>=</span> <span class=n>Conflict</span><span class=p>(</span>
</span><span id=__span-2-149><a id=__codelineno-2-149 name=__codelineno-2-149></a><a href=#__codelineno-2-149><span class=linenos data-linenos="149 "></span></a>            <span class=nb>type</span><span class=o>=</span><span class=n>ConflictType</span><span class=o>.</span><span class=n>FILE_OVERLAP</span><span class=p>,</span>
</span><span id=__span-2-150><a id=__codelineno-2-150 name=__codelineno-2-150></a><a href=#__codelineno-2-150><span class=linenos data-linenos="150 "></span></a>            <span class=n>resource</span><span class=o>=</span><span class=s2>&quot;test_file.py&quot;</span><span class=p>,</span>
</span><span id=__span-2-151><a id=__codelineno-2-151 name=__codelineno-2-151></a><a href=#__codelineno-2-151><span class=linenos data-linenos="151 "></span></a>            <span class=n>cycles</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;cycle1&quot;</span><span class=p>,</span> <span class=s2>&quot;cycle2&quot;</span><span class=p>]</span>
</span><span id=__span-2-152><a id=__codelineno-2-152 name=__codelineno-2-152></a><a href=#__codelineno-2-152><span class=linenos data-linenos="152 "></span></a>        <span class=p>)</span>
</span><span id=__span-2-153><a id=__codelineno-2-153 name=__codelineno-2-153></a><a href=#__codelineno-2-153><span class=linenos data-linenos="153 "></span></a>        
</span><span id=__span-2-154><a id=__codelineno-2-154 name=__codelineno-2-154></a><a href=#__codelineno-2-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>resolver</span> <span class=o>=</span> <span class=n>AutoMergeResolver</span><span class=p>()</span>
</span><span id=__span-2-155><a id=__codelineno-2-155 name=__codelineno-2-155></a><a href=#__codelineno-2-155><span class=linenos data-linenos="155 "></span></a>        <span class=n>resolver</span><span class=o>.</span><span class=n>_get_cycle_file_version</span> <span class=o>=</span> <span class=n>AsyncMock</span><span class=p>(</span><span class=n>side_effect</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-2-156><a id=__codelineno-2-156 name=__codelineno-2-156></a><a href=#__codelineno-2-156><span class=linenos data-linenos="156 "></span></a>            <span class=n>FileVersion</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>version1</span><span class=p>),</span>
</span><span id=__span-2-157><a id=__codelineno-2-157 name=__codelineno-2-157></a><a href=#__codelineno-2-157><span class=linenos data-linenos="157 "></span></a>            <span class=n>FileVersion</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>version2</span><span class=p>)</span>
</span><span id=__span-2-158><a id=__codelineno-2-158 name=__codelineno-2-158></a><a href=#__codelineno-2-158><span class=linenos data-linenos="158 "></span></a>        <span class=p>])</span>
</span><span id=__span-2-159><a id=__codelineno-2-159 name=__codelineno-2-159></a><a href=#__codelineno-2-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>resolver</span><span class=o>.</span><span class=n>_get_base_file_version</span> <span class=o>=</span> <span class=n>AsyncMock</span><span class=p>(</span><span class=n>return_value</span><span class=o>=</span><span class=n>FileVersion</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>base_code</span><span class=p>))</span>
</span><span id=__span-2-160><a id=__codelineno-2-160 name=__codelineno-2-160></a><a href=#__codelineno-2-160><span class=linenos data-linenos="160 "></span></a>        
</span><span id=__span-2-161><a id=__codelineno-2-161 name=__codelineno-2-161></a><a href=#__codelineno-2-161><span class=linenos data-linenos="161 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-162><a id=__codelineno-2-162 name=__codelineno-2-162></a><a href=#__codelineno-2-162><span class=linenos data-linenos="162 "></span></a>        <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>resolver</span><span class=o>.</span><span class=n>_try_ast_merge</span><span class=p>(</span><span class=n>conflict</span><span class=p>)</span>
</span><span id=__span-2-163><a id=__codelineno-2-163 name=__codelineno-2-163></a><a href=#__codelineno-2-163><span class=linenos data-linenos="163 "></span></a>        
</span><span id=__span-2-164><a id=__codelineno-2-164 name=__codelineno-2-164></a><a href=#__codelineno-2-164><span class=linenos data-linenos="164 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-165><a id=__codelineno-2-165 name=__codelineno-2-165></a><a href=#__codelineno-2-165><span class=linenos data-linenos="165 "></span></a>        <span class=k>assert</span> <span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=ow>is</span> <span class=kc>False</span>
</span><span id=__span-2-166><a id=__codelineno-2-166 name=__codelineno-2-166></a><a href=#__codelineno-2-166><span class=linenos data-linenos="166 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;conflict&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>reason</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-2-167><a id=__codelineno-2-167 name=__codelineno-2-167></a><a href=#__codelineno-2-167><span class=linenos data-linenos="167 "></span></a>
</span><span id=__span-2-168><a id=__codelineno-2-168 name=__codelineno-2-168></a><a href=#__codelineno-2-168><span class=linenos data-linenos="168 "></span></a><span class=k>class</span> <span class=nc>TestAgentPoolManager</span><span class=p>:</span>
</span><span id=__span-2-169><a id=__codelineno-2-169 name=__codelineno-2-169></a><a href=#__codelineno-2-169><span class=linenos data-linenos="169 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Unit tests for agent pool management&quot;&quot;&quot;</span>
</span><span id=__span-2-170><a id=__codelineno-2-170 name=__codelineno-2-170></a><a href=#__codelineno-2-170><span class=linenos data-linenos="170 "></span></a>    
</span><span id=__span-2-171><a id=__codelineno-2-171 name=__codelineno-2-171></a><a href=#__codelineno-2-171><span class=linenos data-linenos="171 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_dynamic_scaling_increases_pool_on_high_demand</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-2-172><a id=__codelineno-2-172 name=__codelineno-2-172></a><a href=#__codelineno-2-172><span class=linenos data-linenos="172 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test pool scales up when demand is high&quot;&quot;&quot;</span>
</span><span id=__span-2-173><a id=__codelineno-2-173 name=__codelineno-2-173></a><a href=#__codelineno-2-173><span class=linenos data-linenos="173 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-174><a id=__codelineno-2-174 name=__codelineno-2-174></a><a href=#__codelineno-2-174><span class=linenos data-linenos="174 "></span></a>        <span class=n>pool</span> <span class=o>=</span> <span class=n>DynamicAgentPool</span><span class=p>(</span><span class=n>AgentType</span><span class=o>.</span><span class=n>CODE</span><span class=p>,</span> <span class=n>min_size</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>max_size</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-2-175><a id=__codelineno-2-175 name=__codelineno-2-175></a><a href=#__codelineno-2-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>pool</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>utilization</span> <span class=o>=</span> <span class=mf>0.9</span>
</span><span id=__span-2-176><a id=__codelineno-2-176 name=__codelineno-2-176></a><a href=#__codelineno-2-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>pool</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>average_wait_time</span> <span class=o>=</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span><span id=__span-2-177><a id=__codelineno-2-177 name=__codelineno-2-177></a><a href=#__codelineno-2-177><span class=linenos data-linenos="177 "></span></a>        
</span><span id=__span-2-178><a id=__codelineno-2-178 name=__codelineno-2-178></a><a href=#__codelineno-2-178><span class=linenos data-linenos="178 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-179><a id=__codelineno-2-179 name=__codelineno-2-179></a><a href=#__codelineno-2-179><span class=linenos data-linenos="179 "></span></a>        <span class=k>await</span> <span class=n>pool</span><span class=o>.</span><span class=n>auto_scale</span><span class=p>()</span>
</span><span id=__span-2-180><a id=__codelineno-2-180 name=__codelineno-2-180></a><a href=#__codelineno-2-180><span class=linenos data-linenos="180 "></span></a>        
</span><span id=__span-2-181><a id=__codelineno-2-181 name=__codelineno-2-181></a><a href=#__codelineno-2-181><span class=linenos data-linenos="181 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-182><a id=__codelineno-2-182 name=__codelineno-2-182></a><a href=#__codelineno-2-182><span class=linenos data-linenos="182 "></span></a>        <span class=k>assert</span> <span class=n>pool</span><span class=o>.</span><span class=n>target_size</span> <span class=o>&gt;</span> <span class=n>pool</span><span class=o>.</span><span class=n>current_size</span>
</span><span id=__span-2-183><a id=__codelineno-2-183 name=__codelineno-2-183></a><a href=#__codelineno-2-183><span class=linenos data-linenos="183 "></span></a>        
</span><span id=__span-2-184><a id=__codelineno-2-184 name=__codelineno-2-184></a><a href=#__codelineno-2-184><span class=linenos data-linenos="184 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_agent_allocation_respects_requirements</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-2-185><a id=__codelineno-2-185 name=__codelineno-2-185></a><a href=#__codelineno-2-185><span class=linenos data-linenos="185 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test agent allocation considers specific requirements&quot;&quot;&quot;</span>
</span><span id=__span-2-186><a id=__codelineno-2-186 name=__codelineno-2-186></a><a href=#__codelineno-2-186><span class=linenos data-linenos="186 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-187><a id=__codelineno-2-187 name=__codelineno-2-187></a><a href=#__codelineno-2-187><span class=linenos data-linenos="187 "></span></a>        <span class=n>pool_manager</span> <span class=o>=</span> <span class=n>AgentPoolManager</span><span class=p>()</span>
</span><span id=__span-2-188><a id=__codelineno-2-188 name=__codelineno-2-188></a><a href=#__codelineno-2-188><span class=linenos data-linenos="188 "></span></a>        <span class=n>requirements</span> <span class=o>=</span> <span class=n>AgentRequirements</span><span class=p>(</span>
</span><span id=__span-2-189><a id=__codelineno-2-189 name=__codelineno-2-189></a><a href=#__codelineno-2-189><span class=linenos data-linenos="189 "></span></a>            <span class=n>memory_mb</span><span class=o>=</span><span class=mi>2048</span><span class=p>,</span>
</span><span id=__span-2-190><a id=__codelineno-2-190 name=__codelineno-2-190></a><a href=#__codelineno-2-190><span class=linenos data-linenos="190 "></span></a>            <span class=n>cpu_cores</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
</span><span id=__span-2-191><a id=__codelineno-2-191 name=__codelineno-2-191></a><a href=#__codelineno-2-191><span class=linenos data-linenos="191 "></span></a>            <span class=n>special_tools</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;advanced_testing&quot;</span><span class=p>]</span>
</span><span id=__span-2-192><a id=__codelineno-2-192 name=__codelineno-2-192></a><a href=#__codelineno-2-192><span class=linenos data-linenos="192 "></span></a>        <span class=p>)</span>
</span><span id=__span-2-193><a id=__codelineno-2-193 name=__codelineno-2-193></a><a href=#__codelineno-2-193><span class=linenos data-linenos="193 "></span></a>        
</span><span id=__span-2-194><a id=__codelineno-2-194 name=__codelineno-2-194></a><a href=#__codelineno-2-194><span class=linenos data-linenos="194 "></span></a>        <span class=c1># Mock agent pool</span>
</span><span id=__span-2-195><a id=__codelineno-2-195 name=__codelineno-2-195></a><a href=#__codelineno-2-195><span class=linenos data-linenos="195 "></span></a>        <span class=n>mock_pool</span> <span class=o>=</span> <span class=n>Mock</span><span class=p>()</span>
</span><span id=__span-2-196><a id=__codelineno-2-196 name=__codelineno-2-196></a><a href=#__codelineno-2-196><span class=linenos data-linenos="196 "></span></a>        <span class=n>suitable_agent</span> <span class=o>=</span> <span class=n>Mock</span><span class=p>()</span>
</span><span id=__span-2-197><a id=__codelineno-2-197 name=__codelineno-2-197></a><a href=#__codelineno-2-197><span class=linenos data-linenos="197 "></span></a>        <span class=n>suitable_agent</span><span class=o>.</span><span class=n>max_memory_mb</span> <span class=o>=</span> <span class=mi>4096</span>
</span><span id=__span-2-198><a id=__codelineno-2-198 name=__codelineno-2-198></a><a href=#__codelineno-2-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>suitable_agent</span><span class=o>.</span><span class=n>max_cpu_cores</span> <span class=o>=</span> <span class=mf>4.0</span>
</span><span id=__span-2-199><a id=__codelineno-2-199 name=__codelineno-2-199></a><a href=#__codelineno-2-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>suitable_agent</span><span class=o>.</span><span class=n>available_tools</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;basic_tools&quot;</span><span class=p>,</span> <span class=s2>&quot;advanced_testing&quot;</span><span class=p>]</span>
</span><span id=__span-2-200><a id=__codelineno-2-200 name=__codelineno-2-200></a><a href=#__codelineno-2-200><span class=linenos data-linenos="200 "></span></a>        
</span><span id=__span-2-201><a id=__codelineno-2-201 name=__codelineno-2-201></a><a href=#__codelineno-2-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>mock_pool</span><span class=o>.</span><span class=n>acquire_with_requirements</span><span class=o>.</span><span class=n>return_value</span> <span class=o>=</span> <span class=n>suitable_agent</span>
</span><span id=__span-2-202><a id=__codelineno-2-202 name=__codelineno-2-202></a><a href=#__codelineno-2-202><span class=linenos data-linenos="202 "></span></a>        <span class=n>pool_manager</span><span class=o>.</span><span class=n>pools</span><span class=p>[</span><span class=n>AgentType</span><span class=o>.</span><span class=n>CODE</span><span class=p>]</span> <span class=o>=</span> <span class=n>mock_pool</span>
</span><span id=__span-2-203><a id=__codelineno-2-203 name=__codelineno-2-203></a><a href=#__codelineno-2-203><span class=linenos data-linenos="203 "></span></a>        
</span><span id=__span-2-204><a id=__codelineno-2-204 name=__codelineno-2-204></a><a href=#__codelineno-2-204><span class=linenos data-linenos="204 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-205><a id=__codelineno-2-205 name=__codelineno-2-205></a><a href=#__codelineno-2-205><span class=linenos data-linenos="205 "></span></a>        <span class=n>allocation</span> <span class=o>=</span> <span class=k>await</span> <span class=n>pool_manager</span><span class=o>.</span><span class=n>acquire_agent</span><span class=p>(</span>
</span><span id=__span-2-206><a id=__codelineno-2-206 name=__codelineno-2-206></a><a href=#__codelineno-2-206><span class=linenos data-linenos="206 "></span></a>            <span class=n>AgentType</span><span class=o>.</span><span class=n>CODE</span><span class=p>,</span> <span class=s2>&quot;test_cycle&quot;</span><span class=p>,</span> <span class=n>requirements</span>
</span><span id=__span-2-207><a id=__codelineno-2-207 name=__codelineno-2-207></a><a href=#__codelineno-2-207><span class=linenos data-linenos="207 "></span></a>        <span class=p>)</span>
</span><span id=__span-2-208><a id=__codelineno-2-208 name=__codelineno-2-208></a><a href=#__codelineno-2-208><span class=linenos data-linenos="208 "></span></a>        
</span><span id=__span-2-209><a id=__codelineno-2-209 name=__codelineno-2-209></a><a href=#__codelineno-2-209><span class=linenos data-linenos="209 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-210><a id=__codelineno-2-210 name=__codelineno-2-210></a><a href=#__codelineno-2-210><span class=linenos data-linenos="210 "></span></a>        <span class=k>assert</span> <span class=n>allocation</span><span class=o>.</span><span class=n>agent</span> <span class=o>==</span> <span class=n>suitable_agent</span>
</span><span id=__span-2-211><a id=__codelineno-2-211 name=__codelineno-2-211></a><a href=#__codelineno-2-211><span class=linenos data-linenos="211 "></span></a>        <span class=n>mock_pool</span><span class=o>.</span><span class=n>acquire_with_requirements</span><span class=o>.</span><span class=n>assert_called_once_with</span><span class=p>(</span><span class=s2>&quot;test_cycle&quot;</span><span class=p>,</span> <span class=n>requirements</span><span class=p>)</span>
</span><span id=__span-2-212><a id=__codelineno-2-212 name=__codelineno-2-212></a><a href=#__codelineno-2-212><span class=linenos data-linenos="212 "></span></a>
</span><span id=__span-2-213><a id=__codelineno-2-213 name=__codelineno-2-213></a><a href=#__codelineno-2-213><span class=linenos data-linenos="213 "></span></a><span class=k>class</span> <span class=nc>TestContextManagement</span><span class=p>:</span>
</span><span id=__span-2-214><a id=__codelineno-2-214 name=__codelineno-2-214></a><a href=#__codelineno-2-214><span class=linenos data-linenos="214 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Unit tests for parallel context management&quot;&quot;&quot;</span>
</span><span id=__span-2-215><a id=__codelineno-2-215 name=__codelineno-2-215></a><a href=#__codelineno-2-215><span class=linenos data-linenos="215 "></span></a>    
</span><span id=__span-2-216><a id=__codelineno-2-216 name=__codelineno-2-216></a><a href=#__codelineno-2-216><span class=linenos data-linenos="216 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_token_budget_allocation_across_cycles</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-2-217><a id=__codelineno-2-217 name=__codelineno-2-217></a><a href=#__codelineno-2-217><span class=linenos data-linenos="217 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test token budget is allocated optimally across cycles&quot;&quot;&quot;</span>
</span><span id=__span-2-218><a id=__codelineno-2-218 name=__codelineno-2-218></a><a href=#__codelineno-2-218><span class=linenos data-linenos="218 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-219><a id=__codelineno-2-219 name=__codelineno-2-219></a><a href=#__codelineno-2-219><span class=linenos data-linenos="219 "></span></a>        <span class=n>budget_manager</span> <span class=o>=</span> <span class=n>ParallelTokenBudgetManager</span><span class=p>(</span><span class=n>total_budget</span><span class=o>=</span><span class=mi>200000</span><span class=p>)</span>
</span><span id=__span-2-220><a id=__codelineno-2-220 name=__codelineno-2-220></a><a href=#__codelineno-2-220><span class=linenos data-linenos="220 "></span></a>        <span class=n>parallel_group</span> <span class=o>=</span> <span class=n>ParallelGroup</span><span class=p>(</span><span class=n>cycles</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;cycle1&quot;</span><span class=p>,</span> <span class=s2>&quot;cycle2&quot;</span><span class=p>,</span> <span class=s2>&quot;cycle3&quot;</span><span class=p>])</span>
</span><span id=__span-2-221><a id=__codelineno-2-221 name=__codelineno-2-221></a><a href=#__codelineno-2-221><span class=linenos data-linenos="221 "></span></a>        
</span><span id=__span-2-222><a id=__codelineno-2-222 name=__codelineno-2-222></a><a href=#__codelineno-2-222><span class=linenos data-linenos="222 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-223><a id=__codelineno-2-223 name=__codelineno-2-223></a><a href=#__codelineno-2-223><span class=linenos data-linenos="223 "></span></a>        <span class=n>allocation1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>budget_manager</span><span class=o>.</span><span class=n>allocate_for_cycle</span><span class=p>(</span><span class=s2>&quot;cycle1&quot;</span><span class=p>,</span> <span class=n>parallel_group</span><span class=p>)</span>
</span><span id=__span-2-224><a id=__codelineno-2-224 name=__codelineno-2-224></a><a href=#__codelineno-2-224><span class=linenos data-linenos="224 "></span></a>        <span class=n>allocation2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>budget_manager</span><span class=o>.</span><span class=n>allocate_for_cycle</span><span class=p>(</span><span class=s2>&quot;cycle2&quot;</span><span class=p>,</span> <span class=n>parallel_group</span><span class=p>)</span>
</span><span id=__span-2-225><a id=__codelineno-2-225 name=__codelineno-2-225></a><a href=#__codelineno-2-225><span class=linenos data-linenos="225 "></span></a>        <span class=n>allocation3</span> <span class=o>=</span> <span class=k>await</span> <span class=n>budget_manager</span><span class=o>.</span><span class=n>allocate_for_cycle</span><span class=p>(</span><span class=s2>&quot;cycle3&quot;</span><span class=p>,</span> <span class=n>parallel_group</span><span class=p>)</span>
</span><span id=__span-2-226><a id=__codelineno-2-226 name=__codelineno-2-226></a><a href=#__codelineno-2-226><span class=linenos data-linenos="226 "></span></a>        
</span><span id=__span-2-227><a id=__codelineno-2-227 name=__codelineno-2-227></a><a href=#__codelineno-2-227><span class=linenos data-linenos="227 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-228><a id=__codelineno-2-228 name=__codelineno-2-228></a><a href=#__codelineno-2-228><span class=linenos data-linenos="228 "></span></a>        <span class=n>total_allocated</span> <span class=o>=</span> <span class=p>(</span><span class=n>allocation1</span><span class=o>.</span><span class=n>allocated_tokens</span> <span class=o>+</span> 
</span><span id=__span-2-229><a id=__codelineno-2-229 name=__codelineno-2-229></a><a href=#__codelineno-2-229><span class=linenos data-linenos="229 "></span></a>                          <span class=n>allocation2</span><span class=o>.</span><span class=n>allocated_tokens</span> <span class=o>+</span> 
</span><span id=__span-2-230><a id=__codelineno-2-230 name=__codelineno-2-230></a><a href=#__codelineno-2-230><span class=linenos data-linenos="230 "></span></a>                          <span class=n>allocation3</span><span class=o>.</span><span class=n>allocated_tokens</span><span class=p>)</span>
</span><span id=__span-2-231><a id=__codelineno-2-231 name=__codelineno-2-231></a><a href=#__codelineno-2-231><span class=linenos data-linenos="231 "></span></a>        
</span><span id=__span-2-232><a id=__codelineno-2-232 name=__codelineno-2-232></a><a href=#__codelineno-2-232><span class=linenos data-linenos="232 "></span></a>        <span class=c1># Should not exceed 90% of total budget (10% reserve)</span>
</span><span id=__span-2-233><a id=__codelineno-2-233 name=__codelineno-2-233></a><a href=#__codelineno-2-233><span class=linenos data-linenos="233 "></span></a>        <span class=k>assert</span> <span class=n>total_allocated</span> <span class=o>&lt;=</span> <span class=mi>180000</span>
</span><span id=__span-2-234><a id=__codelineno-2-234 name=__codelineno-2-234></a><a href=#__codelineno-2-234><span class=linenos data-linenos="234 "></span></a>        
</span><span id=__span-2-235><a id=__codelineno-2-235 name=__codelineno-2-235></a><a href=#__codelineno-2-235><span class=linenos data-linenos="235 "></span></a>        <span class=c1># Each allocation should be reasonable</span>
</span><span id=__span-2-236><a id=__codelineno-2-236 name=__codelineno-2-236></a><a href=#__codelineno-2-236><span class=linenos data-linenos="236 "></span></a>        <span class=k>assert</span> <span class=n>allocation1</span><span class=o>.</span><span class=n>allocated_tokens</span> <span class=o>&gt;=</span> <span class=mi>30000</span>
</span><span id=__span-2-237><a id=__codelineno-2-237 name=__codelineno-2-237></a><a href=#__codelineno-2-237><span class=linenos data-linenos="237 "></span></a>        <span class=k>assert</span> <span class=n>allocation2</span><span class=o>.</span><span class=n>allocated_tokens</span> <span class=o>&gt;=</span> <span class=mi>30000</span>
</span><span id=__span-2-238><a id=__codelineno-2-238 name=__codelineno-2-238></a><a href=#__codelineno-2-238><span class=linenos data-linenos="238 "></span></a>        <span class=k>assert</span> <span class=n>allocation3</span><span class=o>.</span><span class=n>allocated_tokens</span> <span class=o>&gt;=</span> <span class=mi>30000</span>
</span><span id=__span-2-239><a id=__codelineno-2-239 name=__codelineno-2-239></a><a href=#__codelineno-2-239><span class=linenos data-linenos="239 "></span></a>        
</span><span id=__span-2-240><a id=__codelineno-2-240 name=__codelineno-2-240></a><a href=#__codelineno-2-240><span class=linenos data-linenos="240 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_context_compression_maintains_relevance</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-2-241><a id=__codelineno-2-241 name=__codelineno-2-241></a><a href=#__codelineno-2-241><span class=linenos data-linenos="241 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test context compression maintains relevance while reducing size&quot;&quot;&quot;</span>
</span><span id=__span-2-242><a id=__codelineno-2-242 name=__codelineno-2-242></a><a href=#__codelineno-2-242><span class=linenos data-linenos="242 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-2-243><a id=__codelineno-2-243 name=__codelineno-2-243></a><a href=#__codelineno-2-243><span class=linenos data-linenos="243 "></span></a>        <span class=n>context</span> <span class=o>=</span> <span class=n>IsolatedCycleContext</span><span class=p>(</span>
</span><span id=__span-2-244><a id=__codelineno-2-244 name=__codelineno-2-244></a><a href=#__codelineno-2-244><span class=linenos data-linenos="244 "></span></a>            <span class=n>cycle_id</span><span class=o>=</span><span class=s2>&quot;test_cycle&quot;</span><span class=p>,</span>
</span><span id=__span-2-245><a id=__codelineno-2-245 name=__codelineno-2-245></a><a href=#__codelineno-2-245><span class=linenos data-linenos="245 "></span></a>            <span class=n>story_id</span><span class=o>=</span><span class=s2>&quot;test_story&quot;</span><span class=p>,</span>
</span><span id=__span-2-246><a id=__codelineno-2-246 name=__codelineno-2-246></a><a href=#__codelineno-2-246><span class=linenos data-linenos="246 "></span></a>            <span class=n>token_budget</span><span class=o>=</span><span class=mi>50000</span><span class=p>,</span>
</span><span id=__span-2-247><a id=__codelineno-2-247 name=__codelineno-2-247></a><a href=#__codelineno-2-247><span class=linenos data-linenos="247 "></span></a>            <span class=n>scope</span><span class=o>=</span><span class=n>ContextScope</span><span class=p>(</span><span class=n>core_files</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;large_file.py&quot;</span><span class=p>])</span>
</span><span id=__span-2-248><a id=__codelineno-2-248 name=__codelineno-2-248></a><a href=#__codelineno-2-248><span class=linenos data-linenos="248 "></span></a>        <span class=p>)</span>
</span><span id=__span-2-249><a id=__codelineno-2-249 name=__codelineno-2-249></a><a href=#__codelineno-2-249><span class=linenos data-linenos="249 "></span></a>        
</span><span id=__span-2-250><a id=__codelineno-2-250 name=__codelineno-2-250></a><a href=#__codelineno-2-250><span class=linenos data-linenos="250 "></span></a>        <span class=c1># Mock large file content</span>
</span><span id=__span-2-251><a id=__codelineno-2-251 name=__codelineno-2-251></a><a href=#__codelineno-2-251><span class=linenos data-linenos="251 "></span></a>        <span class=n>large_content</span> <span class=o>=</span> <span class=s2>&quot;def function():</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;    pass</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>*</span> <span class=mi>1000</span>  <span class=c1># Large file</span>
</span><span id=__span-2-252><a id=__codelineno-2-252 name=__codelineno-2-252></a><a href=#__codelineno-2-252><span class=linenos data-linenos="252 "></span></a>        <span class=n>context</span><span class=o>.</span><span class=n>file_content_cache</span><span class=p>[</span><span class=s2>&quot;large_file.py&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>large_content</span>
</span><span id=__span-2-253><a id=__codelineno-2-253 name=__codelineno-2-253></a><a href=#__codelineno-2-253><span class=linenos data-linenos="253 "></span></a>        
</span><span id=__span-2-254><a id=__codelineno-2-254 name=__codelineno-2-254></a><a href=#__codelineno-2-254><span class=linenos data-linenos="254 "></span></a>        <span class=n>compressor</span> <span class=o>=</span> <span class=n>ContextCompressor</span><span class=p>()</span>
</span><span id=__span-2-255><a id=__codelineno-2-255 name=__codelineno-2-255></a><a href=#__codelineno-2-255><span class=linenos data-linenos="255 "></span></a>        
</span><span id=__span-2-256><a id=__codelineno-2-256 name=__codelineno-2-256></a><a href=#__codelineno-2-256><span class=linenos data-linenos="256 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-2-257><a id=__codelineno-2-257 name=__codelineno-2-257></a><a href=#__codelineno-2-257><span class=linenos data-linenos="257 "></span></a>        <span class=n>compressed_context</span> <span class=o>=</span> <span class=k>await</span> <span class=n>context</span><span class=o>.</span><span class=n>_compress_context_for_agent</span><span class=p>(</span>
</span><span id=__span-2-258><a id=__codelineno-2-258 name=__codelineno-2-258></a><a href=#__codelineno-2-258><span class=linenos data-linenos="258 "></span></a>            <span class=p>[</span><span class=n>RelevantFile</span><span class=p>(</span><span class=n>file_path</span><span class=o>=</span><span class=s2>&quot;large_file.py&quot;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=n>large_content</span><span class=p>,</span> <span class=n>relevance_score</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)],</span>
</span><span id=__span-2-259><a id=__codelineno-2-259 name=__codelineno-2-259></a><a href=#__codelineno-2-259><span class=linenos data-linenos="259 "></span></a>            <span class=n>AgentType</span><span class=o>.</span><span class=n>CODE</span><span class=p>,</span>
</span><span id=__span-2-260><a id=__codelineno-2-260 name=__codelineno-2-260></a><a href=#__codelineno-2-260><span class=linenos data-linenos="260 "></span></a>            <span class=n>ContextNeeds</span><span class=p>(</span><span class=n>preferred_token_count</span><span class=o>=</span><span class=mi>40000</span><span class=p>)</span>
</span><span id=__span-2-261><a id=__codelineno-2-261 name=__codelineno-2-261></a><a href=#__codelineno-2-261><span class=linenos data-linenos="261 "></span></a>        <span class=p>)</span>
</span><span id=__span-2-262><a id=__codelineno-2-262 name=__codelineno-2-262></a><a href=#__codelineno-2-262><span class=linenos data-linenos="262 "></span></a>        
</span><span id=__span-2-263><a id=__codelineno-2-263 name=__codelineno-2-263></a><a href=#__codelineno-2-263><span class=linenos data-linenos="263 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-2-264><a id=__codelineno-2-264 name=__codelineno-2-264></a><a href=#__codelineno-2-264><span class=linenos data-linenos="264 "></span></a>        <span class=k>assert</span> <span class=n>compressed_context</span><span class=o>.</span><span class=n>token_count</span> <span class=o>&lt;=</span> <span class=mi>40000</span>
</span><span id=__span-2-265><a id=__codelineno-2-265 name=__codelineno-2-265></a><a href=#__codelineno-2-265><span class=linenos data-linenos="265 "></span></a>        <span class=k>assert</span> <span class=n>compressed_context</span><span class=o>.</span><span class=n>overall_relevance</span> <span class=o>&gt;=</span> <span class=mf>0.8</span>
</span><span id=__span-2-266><a id=__codelineno-2-266 name=__codelineno-2-266></a><a href=#__codelineno-2-266><span class=linenos data-linenos="266 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>compressed_context</span><span class=o>.</span><span class=n>files</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>
</span><span id=__span-2-267><a id=__codelineno-2-267 name=__codelineno-2-267></a><a href=#__codelineno-2-267><span class=linenos data-linenos="267 "></span></a>        <span class=k>assert</span> <span class=n>compressed_context</span><span class=o>.</span><span class=n>files</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>compression_ratio</span> <span class=o>&lt;</span> <span class=mf>1.0</span>
</span></code></pre></div><h2 id=integration-testing-strategy>Integration Testing Strategy<a class=headerlink href=#integration-testing-strategy title="Permanent link">&para;</a></h2><h3 id=1-component-integration-tests>1. Component Integration Tests<a class=headerlink href=#1-component-integration-tests title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><a href=#__codelineno-3-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>TestParallelExecutionIntegration</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a><a href=#__codelineno-3-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Integration tests for complete parallel execution flow&quot;&quot;&quot;</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><a href=#__codelineno-3-3><span class=linenos data-linenos="  3 "></span></a>    
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4></a><a href=#__codelineno-3-4><span class=linenos data-linenos="  4 "></span></a>    <span class=nd>@pytest</span><span class=o>.</span><span class=n>fixture</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5></a><a href=#__codelineno-3-5><span class=linenos data-linenos="  5 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_environment</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6></a><a href=#__codelineno-3-6><span class=linenos data-linenos="  6 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Set up complete test environment&quot;&quot;&quot;</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7></a><a href=#__codelineno-3-7><span class=linenos data-linenos="  7 "></span></a>        <span class=n>env</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestEnvironmentSetup</span><span class=o>.</span><span class=n>create_integration_environment</span><span class=p>()</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8></a><a href=#__codelineno-3-8><span class=linenos data-linenos="  8 "></span></a>        
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9></a><a href=#__codelineno-3-9><span class=linenos data-linenos="  9 "></span></a>        <span class=c1># Initialize all components</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10></a><a href=#__codelineno-3-10><span class=linenos data-linenos=" 10 "></span></a>        <span class=k>await</span> <span class=n>env</span><span class=o>.</span><span class=n>initialize_components</span><span class=p>([</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11></a><a href=#__codelineno-3-11><span class=linenos data-linenos=" 11 "></span></a>            <span class=s1>&#39;parallel_coordinator&#39;</span><span class=p>,</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12></a><a href=#__codelineno-3-12><span class=linenos data-linenos=" 12 "></span></a>            <span class=s1>&#39;agent_pool_manager&#39;</span><span class=p>,</span> 
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13></a><a href=#__codelineno-3-13><span class=linenos data-linenos=" 13 "></span></a>            <span class=s1>&#39;context_manager&#39;</span><span class=p>,</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14></a><a href=#__codelineno-3-14><span class=linenos data-linenos=" 14 "></span></a>            <span class=s1>&#39;conflict_resolver&#39;</span><span class=p>,</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15></a><a href=#__codelineno-3-15><span class=linenos data-linenos=" 15 "></span></a>            <span class=s1>&#39;storage_system&#39;</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16></a><a href=#__codelineno-3-16><span class=linenos data-linenos=" 16 "></span></a>        <span class=p>])</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17></a><a href=#__codelineno-3-17><span class=linenos data-linenos=" 17 "></span></a>        
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18></a><a href=#__codelineno-3-18><span class=linenos data-linenos=" 18 "></span></a>        <span class=k>yield</span> <span class=n>env</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19></a><a href=#__codelineno-3-19><span class=linenos data-linenos=" 19 "></span></a>        
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20></a><a href=#__codelineno-3-20><span class=linenos data-linenos=" 20 "></span></a>        <span class=c1># Cleanup</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21></a><a href=#__codelineno-3-21><span class=linenos data-linenos=" 21 "></span></a>        <span class=k>await</span> <span class=n>env</span><span class=o>.</span><span class=n>cleanup</span><span class=p>()</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22></a><a href=#__codelineno-3-22><span class=linenos data-linenos=" 22 "></span></a>        
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23></a><a href=#__codelineno-3-23><span class=linenos data-linenos=" 23 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_two_independent_parallel_cycles</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>test_environment</span><span class=p>):</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24></a><a href=#__codelineno-3-24><span class=linenos data-linenos=" 24 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test two completely independent cycles run in parallel&quot;&quot;&quot;</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25></a><a href=#__codelineno-3-25><span class=linenos data-linenos=" 25 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26></a><a href=#__codelineno-3-26><span class=linenos data-linenos=" 26 "></span></a>        <span class=n>story1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story</span><span class=p>(</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27></a><a href=#__codelineno-3-27><span class=linenos data-linenos=" 27 "></span></a>            <span class=s2>&quot;feature_a&quot;</span><span class=p>,</span> 
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28></a><a href=#__codelineno-3-28><span class=linenos data-linenos=" 28 "></span></a>            <span class=n>files</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;feature_a.py&quot;</span><span class=p>,</span> <span class=s2>&quot;test_feature_a.py&quot;</span><span class=p>]</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29></a><a href=#__codelineno-3-29><span class=linenos data-linenos=" 29 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30></a><a href=#__codelineno-3-30><span class=linenos data-linenos=" 30 "></span></a>        <span class=n>story2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story</span><span class=p>(</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31></a><a href=#__codelineno-3-31><span class=linenos data-linenos=" 31 "></span></a>            <span class=s2>&quot;feature_b&quot;</span><span class=p>,</span> 
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32></a><a href=#__codelineno-3-32><span class=linenos data-linenos=" 32 "></span></a>            <span class=n>files</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;feature_b.py&quot;</span><span class=p>,</span> <span class=s2>&quot;test_feature_b.py&quot;</span><span class=p>]</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33></a><a href=#__codelineno-3-33><span class=linenos data-linenos=" 33 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34></a><a href=#__codelineno-3-34><span class=linenos data-linenos=" 34 "></span></a>        
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35></a><a href=#__codelineno-3-35><span class=linenos data-linenos=" 35 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>test_environment</span><span class=o>.</span><span class=n>get_component</span><span class=p>(</span><span class=s1>&#39;parallel_coordinator&#39;</span><span class=p>)</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36></a><a href=#__codelineno-3-36><span class=linenos data-linenos=" 36 "></span></a>        
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37></a><a href=#__codelineno-3-37><span class=linenos data-linenos=" 37 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38></a><a href=#__codelineno-3-38><span class=linenos data-linenos=" 38 "></span></a>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39></a><a href=#__codelineno-3-39><span class=linenos data-linenos=" 39 "></span></a>        
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40></a><a href=#__codelineno-3-40><span class=linenos data-linenos=" 40 "></span></a>        <span class=c1># Start both cycles</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41></a><a href=#__codelineno-3-41><span class=linenos data-linenos=" 41 "></span></a>        <span class=n>cycle1_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>coordinator</span><span class=o>.</span><span class=n>execute_story</span><span class=p>(</span><span class=n>story1</span><span class=p>))</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42></a><a href=#__codelineno-3-42><span class=linenos data-linenos=" 42 "></span></a>        <span class=n>cycle2_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>coordinator</span><span class=o>.</span><span class=n>execute_story</span><span class=p>(</span><span class=n>story2</span><span class=p>))</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43></a><a href=#__codelineno-3-43><span class=linenos data-linenos=" 43 "></span></a>        
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44></a><a href=#__codelineno-3-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=c1># Wait for completion</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45></a><a href=#__codelineno-3-45><span class=linenos data-linenos=" 45 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=n>cycle1_task</span><span class=p>,</span> <span class=n>cycle2_task</span><span class=p>)</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46></a><a href=#__codelineno-3-46><span class=linenos data-linenos=" 46 "></span></a>        
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47></a><a href=#__codelineno-3-47><span class=linenos data-linenos=" 47 "></span></a>        <span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-3-48><a id=__codelineno-3-48 name=__codelineno-3-48></a><a href=#__codelineno-3-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span><span id=__span-3-49><a id=__codelineno-3-49 name=__codelineno-3-49></a><a href=#__codelineno-3-49><span class=linenos data-linenos=" 49 "></span></a>        
</span><span id=__span-3-50><a id=__codelineno-3-50 name=__codelineno-3-50></a><a href=#__codelineno-3-50><span class=linenos data-linenos=" 50 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-3-51><a id=__codelineno-3-51 name=__codelineno-3-51></a><a href=#__codelineno-3-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-3-52><a id=__codelineno-3-52 name=__codelineno-3-52></a><a href=#__codelineno-3-52><span class=linenos data-linenos=" 52 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>coordinator</span><span class=o>.</span><span class=n>active_cycles</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span>  <span class=c1># All cycles completed</span>
</span><span id=__span-3-53><a id=__codelineno-3-53 name=__codelineno-3-53></a><a href=#__codelineno-3-53><span class=linenos data-linenos=" 53 "></span></a>        
</span><span id=__span-3-54><a id=__codelineno-3-54 name=__codelineno-3-54></a><a href=#__codelineno-3-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=c1># Performance assertion - should be faster than sequential</span>
</span><span id=__span-3-55><a id=__codelineno-3-55 name=__codelineno-3-55></a><a href=#__codelineno-3-55><span class=linenos data-linenos=" 55 "></span></a>        <span class=n>sequential_estimate</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_estimate_sequential_time</span><span class=p>([</span><span class=n>story1</span><span class=p>,</span> <span class=n>story2</span><span class=p>])</span>
</span><span id=__span-3-56><a id=__codelineno-3-56 name=__codelineno-3-56></a><a href=#__codelineno-3-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=k>assert</span> <span class=n>execution_time</span> <span class=o>&lt;</span> <span class=n>sequential_estimate</span> <span class=o>*</span> <span class=mf>0.7</span>  <span class=c1># At least 30% faster</span>
</span><span id=__span-3-57><a id=__codelineno-3-57 name=__codelineno-3-57></a><a href=#__codelineno-3-57><span class=linenos data-linenos=" 57 "></span></a>        
</span><span id=__span-3-58><a id=__codelineno-3-58 name=__codelineno-3-58></a><a href=#__codelineno-3-58><span class=linenos data-linenos=" 58 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_conflicting_cycles_resolution</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>test_environment</span><span class=p>):</span>
</span><span id=__span-3-59><a id=__codelineno-3-59 name=__codelineno-3-59></a><a href=#__codelineno-3-59><span class=linenos data-linenos=" 59 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test conflicting cycles are properly resolved&quot;&quot;&quot;</span>
</span><span id=__span-3-60><a id=__codelineno-3-60 name=__codelineno-3-60></a><a href=#__codelineno-3-60><span class=linenos data-linenos=" 60 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-3-61><a id=__codelineno-3-61 name=__codelineno-3-61></a><a href=#__codelineno-3-61><span class=linenos data-linenos=" 61 "></span></a>        <span class=n>shared_file</span> <span class=o>=</span> <span class=s2>&quot;shared_module.py&quot;</span>
</span><span id=__span-3-62><a id=__codelineno-3-62 name=__codelineno-3-62></a><a href=#__codelineno-3-62><span class=linenos data-linenos=" 62 "></span></a>        <span class=n>story1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story</span><span class=p>(</span>
</span><span id=__span-3-63><a id=__codelineno-3-63 name=__codelineno-3-63></a><a href=#__codelineno-3-63><span class=linenos data-linenos=" 63 "></span></a>            <span class=s2>&quot;feature_c&quot;</span><span class=p>,</span>
</span><span id=__span-3-64><a id=__codelineno-3-64 name=__codelineno-3-64></a><a href=#__codelineno-3-64><span class=linenos data-linenos=" 64 "></span></a>            <span class=n>files</span><span class=o>=</span><span class=p>[</span><span class=n>shared_file</span><span class=p>,</span> <span class=s2>&quot;feature_c.py&quot;</span><span class=p>],</span>
</span><span id=__span-3-65><a id=__codelineno-3-65 name=__codelineno-3-65></a><a href=#__codelineno-3-65><span class=linenos data-linenos=" 65 "></span></a>            <span class=n>modifications</span><span class=o>=</span><span class=p>{</span><span class=n>shared_file</span><span class=p>:</span> <span class=s2>&quot;add_function_c&quot;</span><span class=p>}</span>
</span><span id=__span-3-66><a id=__codelineno-3-66 name=__codelineno-3-66></a><a href=#__codelineno-3-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-67><a id=__codelineno-3-67 name=__codelineno-3-67></a><a href=#__codelineno-3-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>story2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story</span><span class=p>(</span>
</span><span id=__span-3-68><a id=__codelineno-3-68 name=__codelineno-3-68></a><a href=#__codelineno-3-68><span class=linenos data-linenos=" 68 "></span></a>            <span class=s2>&quot;feature_d&quot;</span><span class=p>,</span> 
</span><span id=__span-3-69><a id=__codelineno-3-69 name=__codelineno-3-69></a><a href=#__codelineno-3-69><span class=linenos data-linenos=" 69 "></span></a>            <span class=n>files</span><span class=o>=</span><span class=p>[</span><span class=n>shared_file</span><span class=p>,</span> <span class=s2>&quot;feature_d.py&quot;</span><span class=p>],</span>
</span><span id=__span-3-70><a id=__codelineno-3-70 name=__codelineno-3-70></a><a href=#__codelineno-3-70><span class=linenos data-linenos=" 70 "></span></a>            <span class=n>modifications</span><span class=o>=</span><span class=p>{</span><span class=n>shared_file</span><span class=p>:</span> <span class=s2>&quot;add_function_d&quot;</span><span class=p>}</span>
</span><span id=__span-3-71><a id=__codelineno-3-71 name=__codelineno-3-71></a><a href=#__codelineno-3-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-72><a id=__codelineno-3-72 name=__codelineno-3-72></a><a href=#__codelineno-3-72><span class=linenos data-linenos=" 72 "></span></a>        
</span><span id=__span-3-73><a id=__codelineno-3-73 name=__codelineno-3-73></a><a href=#__codelineno-3-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>test_environment</span><span class=o>.</span><span class=n>get_component</span><span class=p>(</span><span class=s1>&#39;parallel_coordinator&#39;</span><span class=p>)</span>
</span><span id=__span-3-74><a id=__codelineno-3-74 name=__codelineno-3-74></a><a href=#__codelineno-3-74><span class=linenos data-linenos=" 74 "></span></a>        
</span><span id=__span-3-75><a id=__codelineno-3-75 name=__codelineno-3-75></a><a href=#__codelineno-3-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-3-76><a id=__codelineno-3-76 name=__codelineno-3-76></a><a href=#__codelineno-3-76><span class=linenos data-linenos=" 76 "></span></a>        <span class=n>cycle1_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>coordinator</span><span class=o>.</span><span class=n>execute_story</span><span class=p>(</span><span class=n>story1</span><span class=p>))</span>
</span><span id=__span-3-77><a id=__codelineno-3-77 name=__codelineno-3-77></a><a href=#__codelineno-3-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=n>cycle2_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>coordinator</span><span class=o>.</span><span class=n>execute_story</span><span class=p>(</span><span class=n>story2</span><span class=p>))</span>
</span><span id=__span-3-78><a id=__codelineno-3-78 name=__codelineno-3-78></a><a href=#__codelineno-3-78><span class=linenos data-linenos=" 78 "></span></a>        
</span><span id=__span-3-79><a id=__codelineno-3-79 name=__codelineno-3-79></a><a href=#__codelineno-3-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=n>cycle1_task</span><span class=p>,</span> <span class=n>cycle2_task</span><span class=p>)</span>
</span><span id=__span-3-80><a id=__codelineno-3-80 name=__codelineno-3-80></a><a href=#__codelineno-3-80><span class=linenos data-linenos=" 80 "></span></a>        
</span><span id=__span-3-81><a id=__codelineno-3-81 name=__codelineno-3-81></a><a href=#__codelineno-3-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-3-82><a id=__codelineno-3-82 name=__codelineno-3-82></a><a href=#__codelineno-3-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-3-83><a id=__codelineno-3-83 name=__codelineno-3-83></a><a href=#__codelineno-3-83><span class=linenos data-linenos=" 83 "></span></a>        
</span><span id=__span-3-84><a id=__codelineno-3-84 name=__codelineno-3-84></a><a href=#__codelineno-3-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=c1># Verify conflict was detected and resolved</span>
</span><span id=__span-3-85><a id=__codelineno-3-85 name=__codelineno-3-85></a><a href=#__codelineno-3-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>conflicts</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>get_resolved_conflicts</span><span class=p>()</span>
</span><span id=__span-3-86><a id=__codelineno-3-86 name=__codelineno-3-86></a><a href=#__codelineno-3-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>conflicts</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>1</span>
</span><span id=__span-3-87><a id=__codelineno-3-87 name=__codelineno-3-87></a><a href=#__codelineno-3-87><span class=linenos data-linenos=" 87 "></span></a>        <span class=k>assert</span> <span class=nb>any</span><span class=p>(</span><span class=n>shared_file</span> <span class=ow>in</span> <span class=n>c</span><span class=o>.</span><span class=n>resources</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>conflicts</span><span class=p>)</span>
</span><span id=__span-3-88><a id=__codelineno-3-88 name=__codelineno-3-88></a><a href=#__codelineno-3-88><span class=linenos data-linenos=" 88 "></span></a>        
</span><span id=__span-3-89><a id=__codelineno-3-89 name=__codelineno-3-89></a><a href=#__codelineno-3-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=c1># Verify final state is consistent</span>
</span><span id=__span-3-90><a id=__codelineno-3-90 name=__codelineno-3-90></a><a href=#__codelineno-3-90><span class=linenos data-linenos=" 90 "></span></a>        <span class=n>final_file_content</span> <span class=o>=</span> <span class=k>await</span> <span class=n>test_environment</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>shared_file</span><span class=p>)</span>
</span><span id=__span-3-91><a id=__codelineno-3-91 name=__codelineno-3-91></a><a href=#__codelineno-3-91><span class=linenos data-linenos=" 91 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;add_function_c&quot;</span> <span class=ow>in</span> <span class=n>final_file_content</span>
</span><span id=__span-3-92><a id=__codelineno-3-92 name=__codelineno-3-92></a><a href=#__codelineno-3-92><span class=linenos data-linenos=" 92 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;add_function_d&quot;</span> <span class=ow>in</span> <span class=n>final_file_content</span>
</span><span id=__span-3-93><a id=__codelineno-3-93 name=__codelineno-3-93></a><a href=#__codelineno-3-93><span class=linenos data-linenos=" 93 "></span></a>        
</span><span id=__span-3-94><a id=__codelineno-3-94 name=__codelineno-3-94></a><a href=#__codelineno-3-94><span class=linenos data-linenos=" 94 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_agent_pool_scaling_under_load</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>test_environment</span><span class=p>):</span>
</span><span id=__span-3-95><a id=__codelineno-3-95 name=__codelineno-3-95></a><a href=#__codelineno-3-95><span class=linenos data-linenos=" 95 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test agent pool scales appropriately under load&quot;&quot;&quot;</span>
</span><span id=__span-3-96><a id=__codelineno-3-96 name=__codelineno-3-96></a><a href=#__codelineno-3-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-3-97><a id=__codelineno-3-97 name=__codelineno-3-97></a><a href=#__codelineno-3-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-3-98><a id=__codelineno-3-98 name=__codelineno-3-98></a><a href=#__codelineno-3-98><span class=linenos data-linenos=" 98 "></span></a>            <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;story_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-3-99><a id=__codelineno-3-99 name=__codelineno-3-99></a><a href=#__codelineno-3-99><span class=linenos data-linenos=" 99 "></span></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>  <span class=c1># More stories than initial agent pool</span>
</span><span id=__span-3-100><a id=__codelineno-3-100 name=__codelineno-3-100></a><a href=#__codelineno-3-100><span class=linenos data-linenos="100 "></span></a>        <span class=p>]</span>
</span><span id=__span-3-101><a id=__codelineno-3-101 name=__codelineno-3-101></a><a href=#__codelineno-3-101><span class=linenos data-linenos="101 "></span></a>        
</span><span id=__span-3-102><a id=__codelineno-3-102 name=__codelineno-3-102></a><a href=#__codelineno-3-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>test_environment</span><span class=o>.</span><span class=n>get_component</span><span class=p>(</span><span class=s1>&#39;parallel_coordinator&#39;</span><span class=p>)</span>
</span><span id=__span-3-103><a id=__codelineno-3-103 name=__codelineno-3-103></a><a href=#__codelineno-3-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>agent_pool_manager</span> <span class=o>=</span> <span class=n>test_environment</span><span class=o>.</span><span class=n>get_component</span><span class=p>(</span><span class=s1>&#39;agent_pool_manager&#39;</span><span class=p>)</span>
</span><span id=__span-3-104><a id=__codelineno-3-104 name=__codelineno-3-104></a><a href=#__codelineno-3-104><span class=linenos data-linenos="104 "></span></a>        
</span><span id=__span-3-105><a id=__codelineno-3-105 name=__codelineno-3-105></a><a href=#__codelineno-3-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>initial_pool_sizes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-3-106><a id=__codelineno-3-106 name=__codelineno-3-106></a><a href=#__codelineno-3-106><span class=linenos data-linenos="106 "></span></a>            <span class=n>agent_type</span><span class=p>:</span> <span class=n>pool</span><span class=o>.</span><span class=n>current_size</span> 
</span><span id=__span-3-107><a id=__codelineno-3-107 name=__codelineno-3-107></a><a href=#__codelineno-3-107><span class=linenos data-linenos="107 "></span></a>            <span class=k>for</span> <span class=n>agent_type</span><span class=p>,</span> <span class=n>pool</span> <span class=ow>in</span> <span class=n>agent_pool_manager</span><span class=o>.</span><span class=n>pools</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span><span id=__span-3-108><a id=__codelineno-3-108 name=__codelineno-3-108></a><a href=#__codelineno-3-108><span class=linenos data-linenos="108 "></span></a>        <span class=p>}</span>
</span><span id=__span-3-109><a id=__codelineno-3-109 name=__codelineno-3-109></a><a href=#__codelineno-3-109><span class=linenos data-linenos="109 "></span></a>        
</span><span id=__span-3-110><a id=__codelineno-3-110 name=__codelineno-3-110></a><a href=#__codelineno-3-110><span class=linenos data-linenos="110 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-3-111><a id=__codelineno-3-111 name=__codelineno-3-111></a><a href=#__codelineno-3-111><span class=linenos data-linenos="111 "></span></a>        <span class=n>tasks</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-3-112><a id=__codelineno-3-112 name=__codelineno-3-112></a><a href=#__codelineno-3-112><span class=linenos data-linenos="112 "></span></a>            <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>coordinator</span><span class=o>.</span><span class=n>execute_story</span><span class=p>(</span><span class=n>story</span><span class=p>))</span>
</span><span id=__span-3-113><a id=__codelineno-3-113 name=__codelineno-3-113></a><a href=#__codelineno-3-113><span class=linenos data-linenos="113 "></span></a>            <span class=k>for</span> <span class=n>story</span> <span class=ow>in</span> <span class=n>stories</span>
</span><span id=__span-3-114><a id=__codelineno-3-114 name=__codelineno-3-114></a><a href=#__codelineno-3-114><span class=linenos data-linenos="114 "></span></a>        <span class=p>]</span>
</span><span id=__span-3-115><a id=__codelineno-3-115 name=__codelineno-3-115></a><a href=#__codelineno-3-115><span class=linenos data-linenos="115 "></span></a>        
</span><span id=__span-3-116><a id=__codelineno-3-116 name=__codelineno-3-116></a><a href=#__codelineno-3-116><span class=linenos data-linenos="116 "></span></a>        <span class=c1># Monitor pool scaling during execution</span>
</span><span id=__span-3-117><a id=__codelineno-3-117 name=__codelineno-3-117></a><a href=#__codelineno-3-117><span class=linenos data-linenos="117 "></span></a>        <span class=n>scaling_events</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-3-118><a id=__codelineno-3-118 name=__codelineno-3-118></a><a href=#__codelineno-3-118><span class=linenos data-linenos="118 "></span></a>        <span class=k>async</span> <span class=k>def</span> <span class=nf>monitor_scaling</span><span class=p>():</span>
</span><span id=__span-3-119><a id=__codelineno-3-119 name=__codelineno-3-119></a><a href=#__codelineno-3-119><span class=linenos data-linenos="119 "></span></a>            <span class=k>while</span> <span class=nb>any</span><span class=p>(</span><span class=ow>not</span> <span class=n>task</span><span class=o>.</span><span class=n>done</span><span class=p>()</span> <span class=k>for</span> <span class=n>task</span> <span class=ow>in</span> <span class=n>tasks</span><span class=p>):</span>
</span><span id=__span-3-120><a id=__codelineno-3-120 name=__codelineno-3-120></a><a href=#__codelineno-3-120><span class=linenos data-linenos="120 "></span></a>                <span class=n>current_sizes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-3-121><a id=__codelineno-3-121 name=__codelineno-3-121></a><a href=#__codelineno-3-121><span class=linenos data-linenos="121 "></span></a>                    <span class=n>agent_type</span><span class=p>:</span> <span class=n>pool</span><span class=o>.</span><span class=n>current_size</span>
</span><span id=__span-3-122><a id=__codelineno-3-122 name=__codelineno-3-122></a><a href=#__codelineno-3-122><span class=linenos data-linenos="122 "></span></a>                    <span class=k>for</span> <span class=n>agent_type</span><span class=p>,</span> <span class=n>pool</span> <span class=ow>in</span> <span class=n>agent_pool_manager</span><span class=o>.</span><span class=n>pools</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span><span id=__span-3-123><a id=__codelineno-3-123 name=__codelineno-3-123></a><a href=#__codelineno-3-123><span class=linenos data-linenos="123 "></span></a>                <span class=p>}</span>
</span><span id=__span-3-124><a id=__codelineno-3-124 name=__codelineno-3-124></a><a href=#__codelineno-3-124><span class=linenos data-linenos="124 "></span></a>                <span class=k>if</span> <span class=n>current_sizes</span> <span class=o>!=</span> <span class=n>initial_pool_sizes</span><span class=p>:</span>
</span><span id=__span-3-125><a id=__codelineno-3-125 name=__codelineno-3-125></a><a href=#__codelineno-3-125><span class=linenos data-linenos="125 "></span></a>                    <span class=n>scaling_events</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-3-126><a id=__codelineno-3-126 name=__codelineno-3-126></a><a href=#__codelineno-3-126><span class=linenos data-linenos="126 "></span></a>                        <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>(),</span>
</span><span id=__span-3-127><a id=__codelineno-3-127 name=__codelineno-3-127></a><a href=#__codelineno-3-127><span class=linenos data-linenos="127 "></span></a>                        <span class=s1>&#39;pool_sizes&#39;</span><span class=p>:</span> <span class=n>current_sizes</span>
</span><span id=__span-3-128><a id=__codelineno-3-128 name=__codelineno-3-128></a><a href=#__codelineno-3-128><span class=linenos data-linenos="128 "></span></a>                    <span class=p>})</span>
</span><span id=__span-3-129><a id=__codelineno-3-129 name=__codelineno-3-129></a><a href=#__codelineno-3-129><span class=linenos data-linenos="129 "></span></a>                <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-3-130><a id=__codelineno-3-130 name=__codelineno-3-130></a><a href=#__codelineno-3-130><span class=linenos data-linenos="130 "></span></a>                
</span><span id=__span-3-131><a id=__codelineno-3-131 name=__codelineno-3-131></a><a href=#__codelineno-3-131><span class=linenos data-linenos="131 "></span></a>        <span class=n>monitor_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>monitor_scaling</span><span class=p>())</span>
</span><span id=__span-3-132><a id=__codelineno-3-132 name=__codelineno-3-132></a><a href=#__codelineno-3-132><span class=linenos data-linenos="132 "></span></a>        
</span><span id=__span-3-133><a id=__codelineno-3-133 name=__codelineno-3-133></a><a href=#__codelineno-3-133><span class=linenos data-linenos="133 "></span></a>        <span class=c1># Wait for execution completion</span>
</span><span id=__span-3-134><a id=__codelineno-3-134 name=__codelineno-3-134></a><a href=#__codelineno-3-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>)</span>
</span><span id=__span-3-135><a id=__codelineno-3-135 name=__codelineno-3-135></a><a href=#__codelineno-3-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>monitor_task</span><span class=o>.</span><span class=n>cancel</span><span class=p>()</span>
</span><span id=__span-3-136><a id=__codelineno-3-136 name=__codelineno-3-136></a><a href=#__codelineno-3-136><span class=linenos data-linenos="136 "></span></a>        
</span><span id=__span-3-137><a id=__codelineno-3-137 name=__codelineno-3-137></a><a href=#__codelineno-3-137><span class=linenos data-linenos="137 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-3-138><a id=__codelineno-3-138 name=__codelineno-3-138></a><a href=#__codelineno-3-138><span class=linenos data-linenos="138 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-3-139><a id=__codelineno-3-139 name=__codelineno-3-139></a><a href=#__codelineno-3-139><span class=linenos data-linenos="139 "></span></a>        
</span><span id=__span-3-140><a id=__codelineno-3-140 name=__codelineno-3-140></a><a href=#__codelineno-3-140><span class=linenos data-linenos="140 "></span></a>        <span class=c1># Verify scaling occurred</span>
</span><span id=__span-3-141><a id=__codelineno-3-141 name=__codelineno-3-141></a><a href=#__codelineno-3-141><span class=linenos data-linenos="141 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>scaling_events</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-3-142><a id=__codelineno-3-142 name=__codelineno-3-142></a><a href=#__codelineno-3-142><span class=linenos data-linenos="142 "></span></a>        
</span><span id=__span-3-143><a id=__codelineno-3-143 name=__codelineno-3-143></a><a href=#__codelineno-3-143><span class=linenos data-linenos="143 "></span></a>        <span class=c1># Verify pools scaled back down after execution</span>
</span><span id=__span-3-144><a id=__codelineno-3-144 name=__codelineno-3-144></a><a href=#__codelineno-3-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>final_pool_sizes</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-3-145><a id=__codelineno-3-145 name=__codelineno-3-145></a><a href=#__codelineno-3-145><span class=linenos data-linenos="145 "></span></a>            <span class=n>agent_type</span><span class=p>:</span> <span class=n>pool</span><span class=o>.</span><span class=n>current_size</span>
</span><span id=__span-3-146><a id=__codelineno-3-146 name=__codelineno-3-146></a><a href=#__codelineno-3-146><span class=linenos data-linenos="146 "></span></a>            <span class=k>for</span> <span class=n>agent_type</span><span class=p>,</span> <span class=n>pool</span> <span class=ow>in</span> <span class=n>agent_pool_manager</span><span class=o>.</span><span class=n>pools</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span><span id=__span-3-147><a id=__codelineno-3-147 name=__codelineno-3-147></a><a href=#__codelineno-3-147><span class=linenos data-linenos="147 "></span></a>        <span class=p>}</span>
</span><span id=__span-3-148><a id=__codelineno-3-148 name=__codelineno-3-148></a><a href=#__codelineno-3-148><span class=linenos data-linenos="148 "></span></a>        
</span><span id=__span-3-149><a id=__codelineno-3-149 name=__codelineno-3-149></a><a href=#__codelineno-3-149><span class=linenos data-linenos="149 "></span></a>        <span class=c1># Pool sizes should be close to initial sizes (may not be exact due to cooldown)</span>
</span><span id=__span-3-150><a id=__codelineno-3-150 name=__codelineno-3-150></a><a href=#__codelineno-3-150><span class=linenos data-linenos="150 "></span></a>        <span class=k>for</span> <span class=n>agent_type</span><span class=p>,</span> <span class=n>initial_size</span> <span class=ow>in</span> <span class=n>initial_pool_sizes</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-3-151><a id=__codelineno-3-151 name=__codelineno-3-151></a><a href=#__codelineno-3-151><span class=linenos data-linenos="151 "></span></a>            <span class=k>assert</span> <span class=nb>abs</span><span class=p>(</span><span class=n>final_pool_sizes</span><span class=p>[</span><span class=n>agent_type</span><span class=p>]</span> <span class=o>-</span> <span class=n>initial_size</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>1</span>
</span><span id=__span-3-152><a id=__codelineno-3-152 name=__codelineno-3-152></a><a href=#__codelineno-3-152><span class=linenos data-linenos="152 "></span></a>
</span><span id=__span-3-153><a id=__codelineno-3-153 name=__codelineno-3-153></a><a href=#__codelineno-3-153><span class=linenos data-linenos="153 "></span></a><span class=k>class</span> <span class=nc>TestContextSharingIntegration</span><span class=p>:</span>
</span><span id=__span-3-154><a id=__codelineno-3-154 name=__codelineno-3-154></a><a href=#__codelineno-3-154><span class=linenos data-linenos="154 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Integration tests for context sharing between cycles&quot;&quot;&quot;</span>
</span><span id=__span-3-155><a id=__codelineno-3-155 name=__codelineno-3-155></a><a href=#__codelineno-3-155><span class=linenos data-linenos="155 "></span></a>    
</span><span id=__span-3-156><a id=__codelineno-3-156 name=__codelineno-3-156></a><a href=#__codelineno-3-156><span class=linenos data-linenos="156 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_context_sharing_improves_efficiency</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>test_environment</span><span class=p>):</span>
</span><span id=__span-3-157><a id=__codelineno-3-157 name=__codelineno-3-157></a><a href=#__codelineno-3-157><span class=linenos data-linenos="157 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test context sharing reduces token usage and improves efficiency&quot;&quot;&quot;</span>
</span><span id=__span-3-158><a id=__codelineno-3-158 name=__codelineno-3-158></a><a href=#__codelineno-3-158><span class=linenos data-linenos="158 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-3-159><a id=__codelineno-3-159 name=__codelineno-3-159></a><a href=#__codelineno-3-159><span class=linenos data-linenos="159 "></span></a>        <span class=n>shared_files</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;common_utils.py&quot;</span><span class=p>,</span> <span class=s2>&quot;shared_models.py&quot;</span><span class=p>]</span>
</span><span id=__span-3-160><a id=__codelineno-3-160 name=__codelineno-3-160></a><a href=#__codelineno-3-160><span class=linenos data-linenos="160 "></span></a>        
</span><span id=__span-3-161><a id=__codelineno-3-161 name=__codelineno-3-161></a><a href=#__codelineno-3-161><span class=linenos data-linenos="161 "></span></a>        <span class=n>story1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story</span><span class=p>(</span>
</span><span id=__span-3-162><a id=__codelineno-3-162 name=__codelineno-3-162></a><a href=#__codelineno-3-162><span class=linenos data-linenos="162 "></span></a>            <span class=s2>&quot;feature_e&quot;</span><span class=p>,</span>
</span><span id=__span-3-163><a id=__codelineno-3-163 name=__codelineno-3-163></a><a href=#__codelineno-3-163><span class=linenos data-linenos="163 "></span></a>            <span class=n>files</span><span class=o>=</span><span class=n>shared_files</span> <span class=o>+</span> <span class=p>[</span><span class=s2>&quot;feature_e.py&quot;</span><span class=p>]</span>
</span><span id=__span-3-164><a id=__codelineno-3-164 name=__codelineno-3-164></a><a href=#__codelineno-3-164><span class=linenos data-linenos="164 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-165><a id=__codelineno-3-165 name=__codelineno-3-165></a><a href=#__codelineno-3-165><span class=linenos data-linenos="165 "></span></a>        <span class=n>story2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story</span><span class=p>(</span>
</span><span id=__span-3-166><a id=__codelineno-3-166 name=__codelineno-3-166></a><a href=#__codelineno-3-166><span class=linenos data-linenos="166 "></span></a>            <span class=s2>&quot;feature_f&quot;</span><span class=p>,</span>
</span><span id=__span-3-167><a id=__codelineno-3-167 name=__codelineno-3-167></a><a href=#__codelineno-3-167><span class=linenos data-linenos="167 "></span></a>            <span class=n>files</span><span class=o>=</span><span class=n>shared_files</span> <span class=o>+</span> <span class=p>[</span><span class=s2>&quot;feature_f.py&quot;</span><span class=p>]</span>
</span><span id=__span-3-168><a id=__codelineno-3-168 name=__codelineno-3-168></a><a href=#__codelineno-3-168><span class=linenos data-linenos="168 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-169><a id=__codelineno-3-169 name=__codelineno-3-169></a><a href=#__codelineno-3-169><span class=linenos data-linenos="169 "></span></a>        
</span><span id=__span-3-170><a id=__codelineno-3-170 name=__codelineno-3-170></a><a href=#__codelineno-3-170><span class=linenos data-linenos="170 "></span></a>        <span class=n>context_manager</span> <span class=o>=</span> <span class=n>test_environment</span><span class=o>.</span><span class=n>get_component</span><span class=p>(</span><span class=s1>&#39;context_manager&#39;</span><span class=p>)</span>
</span><span id=__span-3-171><a id=__codelineno-3-171 name=__codelineno-3-171></a><a href=#__codelineno-3-171><span class=linenos data-linenos="171 "></span></a>        
</span><span id=__span-3-172><a id=__codelineno-3-172 name=__codelineno-3-172></a><a href=#__codelineno-3-172><span class=linenos data-linenos="172 "></span></a>        <span class=c1># Act - Execute with context sharing enabled</span>
</span><span id=__span-3-173><a id=__codelineno-3-173 name=__codelineno-3-173></a><a href=#__codelineno-3-173><span class=linenos data-linenos="173 "></span></a>        <span class=n>parallel_group</span> <span class=o>=</span> <span class=n>ParallelGroup</span><span class=p>(</span><span class=n>cycles</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;cycle1&quot;</span><span class=p>,</span> <span class=s2>&quot;cycle2&quot;</span><span class=p>])</span>
</span><span id=__span-3-174><a id=__codelineno-3-174 name=__codelineno-3-174></a><a href=#__codelineno-3-174><span class=linenos data-linenos="174 "></span></a>        
</span><span id=__span-3-175><a id=__codelineno-3-175 name=__codelineno-3-175></a><a href=#__codelineno-3-175><span class=linenos data-linenos="175 "></span></a>        <span class=n>context1</span> <span class=o>=</span> <span class=k>await</span> <span class=n>context_manager</span><span class=o>.</span><span class=n>create_cycle_context</span><span class=p>(</span><span class=s2>&quot;cycle1&quot;</span><span class=p>,</span> <span class=n>story1</span><span class=p>,</span> <span class=n>parallel_group</span><span class=p>)</span>
</span><span id=__span-3-176><a id=__codelineno-3-176 name=__codelineno-3-176></a><a href=#__codelineno-3-176><span class=linenos data-linenos="176 "></span></a>        <span class=n>context2</span> <span class=o>=</span> <span class=k>await</span> <span class=n>context_manager</span><span class=o>.</span><span class=n>create_cycle_context</span><span class=p>(</span><span class=s2>&quot;cycle2&quot;</span><span class=p>,</span> <span class=n>story2</span><span class=p>,</span> <span class=n>parallel_group</span><span class=p>)</span>
</span><span id=__span-3-177><a id=__codelineno-3-177 name=__codelineno-3-177></a><a href=#__codelineno-3-177><span class=linenos data-linenos="177 "></span></a>        
</span><span id=__span-3-178><a id=__codelineno-3-178 name=__codelineno-3-178></a><a href=#__codelineno-3-178><span class=linenos data-linenos="178 "></span></a>        <span class=c1># Enable context sharing for common files</span>
</span><span id=__span-3-179><a id=__codelineno-3-179 name=__codelineno-3-179></a><a href=#__codelineno-3-179><span class=linenos data-linenos="179 "></span></a>        <span class=k>await</span> <span class=n>context_manager</span><span class=o>.</span><span class=n>share_context</span><span class=p>(</span>
</span><span id=__span-3-180><a id=__codelineno-3-180 name=__codelineno-3-180></a><a href=#__codelineno-3-180><span class=linenos data-linenos="180 "></span></a>            <span class=n>from_cycle</span><span class=o>=</span><span class=s2>&quot;cycle1&quot;</span><span class=p>,</span>
</span><span id=__span-3-181><a id=__codelineno-3-181 name=__codelineno-3-181></a><a href=#__codelineno-3-181><span class=linenos data-linenos="181 "></span></a>            <span class=n>to_cycle</span><span class=o>=</span><span class=s2>&quot;cycle2&quot;</span><span class=p>,</span> 
</span><span id=__span-3-182><a id=__codelineno-3-182 name=__codelineno-3-182></a><a href=#__codelineno-3-182><span class=linenos data-linenos="182 "></span></a>            <span class=n>context_keys</span><span class=o>=</span><span class=n>shared_files</span><span class=p>,</span>
</span><span id=__span-3-183><a id=__codelineno-3-183 name=__codelineno-3-183></a><a href=#__codelineno-3-183><span class=linenos data-linenos="183 "></span></a>            <span class=n>sharing_mode</span><span class=o>=</span><span class=n>SharingMode</span><span class=o>.</span><span class=n>READ_ONLY</span>
</span><span id=__span-3-184><a id=__codelineno-3-184 name=__codelineno-3-184></a><a href=#__codelineno-3-184><span class=linenos data-linenos="184 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-185><a id=__codelineno-3-185 name=__codelineno-3-185></a><a href=#__codelineno-3-185><span class=linenos data-linenos="185 "></span></a>        
</span><span id=__span-3-186><a id=__codelineno-3-186 name=__codelineno-3-186></a><a href=#__codelineno-3-186><span class=linenos data-linenos="186 "></span></a>        <span class=c1># Execute both cycles</span>
</span><span id=__span-3-187><a id=__codelineno-3-187 name=__codelineno-3-187></a><a href=#__codelineno-3-187><span class=linenos data-linenos="187 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>test_environment</span><span class=o>.</span><span class=n>get_component</span><span class=p>(</span><span class=s1>&#39;parallel_coordinator&#39;</span><span class=p>)</span>
</span><span id=__span-3-188><a id=__codelineno-3-188 name=__codelineno-3-188></a><a href=#__codelineno-3-188><span class=linenos data-linenos="188 "></span></a>        
</span><span id=__span-3-189><a id=__codelineno-3-189 name=__codelineno-3-189></a><a href=#__codelineno-3-189><span class=linenos data-linenos="189 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span>
</span><span id=__span-3-190><a id=__codelineno-3-190 name=__codelineno-3-190></a><a href=#__codelineno-3-190><span class=linenos data-linenos="190 "></span></a>            <span class=n>coordinator</span><span class=o>.</span><span class=n>execute_story_with_context</span><span class=p>(</span><span class=n>story1</span><span class=p>,</span> <span class=n>context1</span><span class=p>),</span>
</span><span id=__span-3-191><a id=__codelineno-3-191 name=__codelineno-3-191></a><a href=#__codelineno-3-191><span class=linenos data-linenos="191 "></span></a>            <span class=n>coordinator</span><span class=o>.</span><span class=n>execute_story_with_context</span><span class=p>(</span><span class=n>story2</span><span class=p>,</span> <span class=n>context2</span><span class=p>)</span>
</span><span id=__span-3-192><a id=__codelineno-3-192 name=__codelineno-3-192></a><a href=#__codelineno-3-192><span class=linenos data-linenos="192 "></span></a>        <span class=p>)</span>
</span><span id=__span-3-193><a id=__codelineno-3-193 name=__codelineno-3-193></a><a href=#__codelineno-3-193><span class=linenos data-linenos="193 "></span></a>        
</span><span id=__span-3-194><a id=__codelineno-3-194 name=__codelineno-3-194></a><a href=#__codelineno-3-194><span class=linenos data-linenos="194 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-3-195><a id=__codelineno-3-195 name=__codelineno-3-195></a><a href=#__codelineno-3-195><span class=linenos data-linenos="195 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-3-196><a id=__codelineno-3-196 name=__codelineno-3-196></a><a href=#__codelineno-3-196><span class=linenos data-linenos="196 "></span></a>        
</span><span id=__span-3-197><a id=__codelineno-3-197 name=__codelineno-3-197></a><a href=#__codelineno-3-197><span class=linenos data-linenos="197 "></span></a>        <span class=c1># Verify token efficiency improvement</span>
</span><span id=__span-3-198><a id=__codelineno-3-198 name=__codelineno-3-198></a><a href=#__codelineno-3-198><span class=linenos data-linenos="198 "></span></a>        <span class=n>total_tokens_used</span> <span class=o>=</span> <span class=n>context1</span><span class=o>.</span><span class=n>tokens_used</span> <span class=o>+</span> <span class=n>context2</span><span class=o>.</span><span class=n>tokens_used</span>
</span><span id=__span-3-199><a id=__codelineno-3-199 name=__codelineno-3-199></a><a href=#__codelineno-3-199><span class=linenos data-linenos="199 "></span></a>        <span class=n>estimated_individual_usage</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_estimate_individual_token_usage</span><span class=p>([</span><span class=n>story1</span><span class=p>,</span> <span class=n>story2</span><span class=p>])</span>
</span><span id=__span-3-200><a id=__codelineno-3-200 name=__codelineno-3-200></a><a href=#__codelineno-3-200><span class=linenos data-linenos="200 "></span></a>        
</span><span id=__span-3-201><a id=__codelineno-3-201 name=__codelineno-3-201></a><a href=#__codelineno-3-201><span class=linenos data-linenos="201 "></span></a>        <span class=n>efficiency_improvement</span> <span class=o>=</span> <span class=p>(</span><span class=n>estimated_individual_usage</span> <span class=o>-</span> <span class=n>total_tokens_used</span><span class=p>)</span> <span class=o>/</span> <span class=n>estimated_individual_usage</span>
</span><span id=__span-3-202><a id=__codelineno-3-202 name=__codelineno-3-202></a><a href=#__codelineno-3-202><span class=linenos data-linenos="202 "></span></a>        <span class=k>assert</span> <span class=n>efficiency_improvement</span> <span class=o>&gt;=</span> <span class=mf>0.1</span>  <span class=c1># At least 10% improvement</span>
</span><span id=__span-3-203><a id=__codelineno-3-203 name=__codelineno-3-203></a><a href=#__codelineno-3-203><span class=linenos data-linenos="203 "></span></a>        
</span><span id=__span-3-204><a id=__codelineno-3-204 name=__codelineno-3-204></a><a href=#__codelineno-3-204><span class=linenos data-linenos="204 "></span></a>        <span class=c1># Verify shared context was actually used</span>
</span><span id=__span-3-205><a id=__codelineno-3-205 name=__codelineno-3-205></a><a href=#__codelineno-3-205><span class=linenos data-linenos="205 "></span></a>        <span class=n>shared_contexts</span> <span class=o>=</span> <span class=k>await</span> <span class=n>context_manager</span><span class=o>.</span><span class=n>get_shared_contexts</span><span class=p>(</span><span class=n>parallel_group</span><span class=p>)</span>
</span><span id=__span-3-206><a id=__codelineno-3-206 name=__codelineno-3-206></a><a href=#__codelineno-3-206><span class=linenos data-linenos="206 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>shared_contexts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-3-207><a id=__codelineno-3-207 name=__codelineno-3-207></a><a href=#__codelineno-3-207><span class=linenos data-linenos="207 "></span></a>        <span class=k>assert</span> <span class=nb>any</span><span class=p>(</span><span class=n>shared_file</span> <span class=ow>in</span> <span class=n>sc</span><span class=o>.</span><span class=n>elements</span> <span class=k>for</span> <span class=n>sc</span> <span class=ow>in</span> <span class=n>shared_contexts</span> <span class=k>for</span> <span class=n>shared_file</span> <span class=ow>in</span> <span class=n>shared_files</span><span class=p>)</span>
</span></code></pre></div><h2 id=performance-testing-strategy>Performance Testing Strategy<a class=headerlink href=#performance-testing-strategy title="Permanent link">&para;</a></h2><h3 id=1-load-testing>1. Load Testing<a class=headerlink href=#1-load-testing title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><a href=#__codelineno-4-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>PerformanceTestSuite</span><span class=p>:</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><a href=#__codelineno-4-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Comprehensive performance testing for parallel TDD system&quot;&quot;&quot;</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a><a href=#__codelineno-4-3><span class=linenos data-linenos="  3 "></span></a>    
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a><a href=#__codelineno-4-4><span class=linenos data-linenos="  4 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_throughput_scaling</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><a href=#__codelineno-4-5><span class=linenos data-linenos="  5 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test throughput scaling with increasing parallel cycles&quot;&quot;&quot;</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a><a href=#__codelineno-4-6><span class=linenos data-linenos="  6 "></span></a>        <span class=n>test_cases</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a><a href=#__codelineno-4-7><span class=linenos data-linenos="  7 "></span></a>            <span class=p>{</span><span class=s1>&#39;parallel_cycles&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;expected_throughput_multiplier&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>},</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8></a><a href=#__codelineno-4-8><span class=linenos data-linenos="  8 "></span></a>            <span class=p>{</span><span class=s1>&#39;parallel_cycles&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;expected_throughput_multiplier&#39;</span><span class=p>:</span> <span class=mf>1.8</span><span class=p>},</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9></a><a href=#__codelineno-4-9><span class=linenos data-linenos="  9 "></span></a>            <span class=p>{</span><span class=s1>&#39;parallel_cycles&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;expected_throughput_multiplier&#39;</span><span class=p>:</span> <span class=mf>2.5</span><span class=p>},</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10></a><a href=#__codelineno-4-10><span class=linenos data-linenos=" 10 "></span></a>            <span class=p>{</span><span class=s1>&#39;parallel_cycles&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;expected_throughput_multiplier&#39;</span><span class=p>:</span> <span class=mf>3.5</span><span class=p>}</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11></a><a href=#__codelineno-4-11><span class=linenos data-linenos=" 11 "></span></a>        <span class=p>]</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12></a><a href=#__codelineno-4-12><span class=linenos data-linenos=" 12 "></span></a>        
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13></a><a href=#__codelineno-4-13><span class=linenos data-linenos=" 13 "></span></a>        <span class=n>baseline_throughput</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_measure_sequential_throughput</span><span class=p>()</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14></a><a href=#__codelineno-4-14><span class=linenos data-linenos=" 14 "></span></a>        
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15></a><a href=#__codelineno-4-15><span class=linenos data-linenos=" 15 "></span></a>        <span class=k>for</span> <span class=n>test_case</span> <span class=ow>in</span> <span class=n>test_cases</span><span class=p>:</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16></a><a href=#__codelineno-4-16><span class=linenos data-linenos=" 16 "></span></a>            <span class=c1># Arrange</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17></a><a href=#__codelineno-4-17><span class=linenos data-linenos=" 17 "></span></a>            <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_independent_stories</span><span class=p>(</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18></a><a href=#__codelineno-4-18><span class=linenos data-linenos=" 18 "></span></a>                <span class=n>count</span><span class=o>=</span><span class=n>test_case</span><span class=p>[</span><span class=s1>&#39;parallel_cycles&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>  <span class=c1># 2x stories to keep system busy</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19></a><a href=#__codelineno-4-19><span class=linenos data-linenos=" 19 "></span></a>            <span class=p>)</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20></a><a href=#__codelineno-4-20><span class=linenos data-linenos=" 20 "></span></a>            
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21></a><a href=#__codelineno-4-21><span class=linenos data-linenos=" 21 "></span></a>            <span class=c1># Act</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22></a><a href=#__codelineno-4-22><span class=linenos data-linenos=" 22 "></span></a>            <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23></a><a href=#__codelineno-4-23><span class=linenos data-linenos=" 23 "></span></a>            <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_execute_parallel_stories</span><span class=p>(</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24></a><a href=#__codelineno-4-24><span class=linenos data-linenos=" 24 "></span></a>                <span class=n>stories</span><span class=p>,</span> 
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25></a><a href=#__codelineno-4-25><span class=linenos data-linenos=" 25 "></span></a>                <span class=n>max_parallel</span><span class=o>=</span><span class=n>test_case</span><span class=p>[</span><span class=s1>&#39;parallel_cycles&#39;</span><span class=p>]</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26></a><a href=#__codelineno-4-26><span class=linenos data-linenos=" 26 "></span></a>            <span class=p>)</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27></a><a href=#__codelineno-4-27><span class=linenos data-linenos=" 27 "></span></a>            <span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28></a><a href=#__codelineno-4-28><span class=linenos data-linenos=" 28 "></span></a>            
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29></a><a href=#__codelineno-4-29><span class=linenos data-linenos=" 29 "></span></a>            <span class=c1># Calculate throughput</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30></a><a href=#__codelineno-4-30><span class=linenos data-linenos=" 30 "></span></a>            <span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31></a><a href=#__codelineno-4-31><span class=linenos data-linenos=" 31 "></span></a>            <span class=n>actual_throughput</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>stories</span><span class=p>)</span> <span class=o>/</span> <span class=n>execution_time</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32></a><a href=#__codelineno-4-32><span class=linenos data-linenos=" 32 "></span></a>            <span class=n>throughput_multiplier</span> <span class=o>=</span> <span class=n>actual_throughput</span> <span class=o>/</span> <span class=n>baseline_throughput</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33></a><a href=#__codelineno-4-33><span class=linenos data-linenos=" 33 "></span></a>            
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34></a><a href=#__codelineno-4-34><span class=linenos data-linenos=" 34 "></span></a>            <span class=c1># Assert</span>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35></a><a href=#__codelineno-4-35><span class=linenos data-linenos=" 35 "></span></a>            <span class=n>expected_multiplier</span> <span class=o>=</span> <span class=n>test_case</span><span class=p>[</span><span class=s1>&#39;expected_throughput_multiplier&#39;</span><span class=p>]</span>
</span><span id=__span-4-36><a id=__codelineno-4-36 name=__codelineno-4-36></a><a href=#__codelineno-4-36><span class=linenos data-linenos=" 36 "></span></a>            <span class=k>assert</span> <span class=n>throughput_multiplier</span> <span class=o>&gt;=</span> <span class=n>expected_multiplier</span> <span class=o>*</span> <span class=mf>0.9</span>  <span class=c1># 10% tolerance</span>
</span><span id=__span-4-37><a id=__codelineno-4-37 name=__codelineno-4-37></a><a href=#__codelineno-4-37><span class=linenos data-linenos=" 37 "></span></a>            
</span><span id=__span-4-38><a id=__codelineno-4-38 name=__codelineno-4-38></a><a href=#__codelineno-4-38><span class=linenos data-linenos=" 38 "></span></a>            <span class=c1># Verify quality wasn&#39;t compromised</span>
</span><span id=__span-4-39><a id=__codelineno-4-39 name=__codelineno-4-39></a><a href=#__codelineno-4-39><span class=linenos data-linenos=" 39 "></span></a>            <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-4-40><a id=__codelineno-4-40 name=__codelineno-4-40></a><a href=#__codelineno-4-40><span class=linenos data-linenos=" 40 "></span></a>            <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>test_pass_rate</span> <span class=o>&gt;=</span> <span class=mf>0.95</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-4-41><a id=__codelineno-4-41 name=__codelineno-4-41></a><a href=#__codelineno-4-41><span class=linenos data-linenos=" 41 "></span></a>            
</span><span id=__span-4-42><a id=__codelineno-4-42 name=__codelineno-4-42></a><a href=#__codelineno-4-42><span class=linenos data-linenos=" 42 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_resource_utilization_efficiency</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-4-43><a id=__codelineno-4-43 name=__codelineno-4-43></a><a href=#__codelineno-4-43><span class=linenos data-linenos=" 43 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test resource utilization remains efficient under load&quot;&quot;&quot;</span>
</span><span id=__span-4-44><a id=__codelineno-4-44 name=__codelineno-4-44></a><a href=#__codelineno-4-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-4-45><a id=__codelineno-4-45 name=__codelineno-4-45></a><a href=#__codelineno-4-45><span class=linenos data-linenos=" 45 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_mixed_complexity_stories</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-4-46><a id=__codelineno-4-46 name=__codelineno-4-46></a><a href=#__codelineno-4-46><span class=linenos data-linenos=" 46 "></span></a>        <span class=n>resource_monitor</span> <span class=o>=</span> <span class=n>ResourceMonitor</span><span class=p>()</span>
</span><span id=__span-4-47><a id=__codelineno-4-47 name=__codelineno-4-47></a><a href=#__codelineno-4-47><span class=linenos data-linenos=" 47 "></span></a>        
</span><span id=__span-4-48><a id=__codelineno-4-48 name=__codelineno-4-48></a><a href=#__codelineno-4-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-4-49><a id=__codelineno-4-49 name=__codelineno-4-49></a><a href=#__codelineno-4-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=k>await</span> <span class=n>resource_monitor</span><span class=o>.</span><span class=n>start_monitoring</span><span class=p>()</span>
</span><span id=__span-4-50><a id=__codelineno-4-50 name=__codelineno-4-50></a><a href=#__codelineno-4-50><span class=linenos data-linenos=" 50 "></span></a>        
</span><span id=__span-4-51><a id=__codelineno-4-51 name=__codelineno-4-51></a><a href=#__codelineno-4-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_execute_parallel_stories</span><span class=p>(</span><span class=n>stories</span><span class=p>,</span> <span class=n>max_parallel</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-4-52><a id=__codelineno-4-52 name=__codelineno-4-52></a><a href=#__codelineno-4-52><span class=linenos data-linenos=" 52 "></span></a>        
</span><span id=__span-4-53><a id=__codelineno-4-53 name=__codelineno-4-53></a><a href=#__codelineno-4-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=n>resource_stats</span> <span class=o>=</span> <span class=k>await</span> <span class=n>resource_monitor</span><span class=o>.</span><span class=n>stop_and_get_stats</span><span class=p>()</span>
</span><span id=__span-4-54><a id=__codelineno-4-54 name=__codelineno-4-54></a><a href=#__codelineno-4-54><span class=linenos data-linenos=" 54 "></span></a>        
</span><span id=__span-4-55><a id=__codelineno-4-55 name=__codelineno-4-55></a><a href=#__codelineno-4-55><span class=linenos data-linenos=" 55 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-4-56><a id=__codelineno-4-56 name=__codelineno-4-56></a><a href=#__codelineno-4-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=k>assert</span> <span class=n>resource_stats</span><span class=o>.</span><span class=n>cpu_utilization</span> <span class=o>&gt;=</span> <span class=mf>0.7</span>  <span class=c1># Good CPU utilization</span>
</span><span id=__span-4-57><a id=__codelineno-4-57 name=__codelineno-4-57></a><a href=#__codelineno-4-57><span class=linenos data-linenos=" 57 "></span></a>        <span class=k>assert</span> <span class=n>resource_stats</span><span class=o>.</span><span class=n>cpu_utilization</span> <span class=o>&lt;=</span> <span class=mf>0.9</span>  <span class=c1># Not overloaded</span>
</span><span id=__span-4-58><a id=__codelineno-4-58 name=__codelineno-4-58></a><a href=#__codelineno-4-58><span class=linenos data-linenos=" 58 "></span></a>        <span class=k>assert</span> <span class=n>resource_stats</span><span class=o>.</span><span class=n>memory_utilization</span> <span class=o>&lt;=</span> <span class=mf>0.8</span>  <span class=c1># Reasonable memory usage</span>
</span><span id=__span-4-59><a id=__codelineno-4-59 name=__codelineno-4-59></a><a href=#__codelineno-4-59><span class=linenos data-linenos=" 59 "></span></a>        <span class=k>assert</span> <span class=n>resource_stats</span><span class=o>.</span><span class=n>agent_utilization</span> <span class=o>&gt;=</span> <span class=mf>0.8</span>  <span class=c1># Agents being used efficiently</span>
</span><span id=__span-4-60><a id=__codelineno-4-60 name=__codelineno-4-60></a><a href=#__codelineno-4-60><span class=linenos data-linenos=" 60 "></span></a>        
</span><span id=__span-4-61><a id=__codelineno-4-61 name=__codelineno-4-61></a><a href=#__codelineno-4-61><span class=linenos data-linenos=" 61 "></span></a>        <span class=c1># No resource exhaustion events</span>
</span><span id=__span-4-62><a id=__codelineno-4-62 name=__codelineno-4-62></a><a href=#__codelineno-4-62><span class=linenos data-linenos=" 62 "></span></a>        <span class=k>assert</span> <span class=n>resource_stats</span><span class=o>.</span><span class=n>resource_exhaustion_events</span> <span class=o>==</span> <span class=mi>0</span>
</span><span id=__span-4-63><a id=__codelineno-4-63 name=__codelineno-4-63></a><a href=#__codelineno-4-63><span class=linenos data-linenos=" 63 "></span></a>        
</span><span id=__span-4-64><a id=__codelineno-4-64 name=__codelineno-4-64></a><a href=#__codelineno-4-64><span class=linenos data-linenos=" 64 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_token_budget_efficiency</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-4-65><a id=__codelineno-4-65 name=__codelineno-4-65></a><a href=#__codelineno-4-65><span class=linenos data-linenos=" 65 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test token budget is used efficiently across parallel cycles&quot;&quot;&quot;</span>
</span><span id=__span-4-66><a id=__codelineno-4-66 name=__codelineno-4-66></a><a href=#__codelineno-4-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-4-67><a id=__codelineno-4-67 name=__codelineno-4-67></a><a href=#__codelineno-4-67><span class=linenos data-linenos=" 67 "></span></a>        <span class=n>total_budget</span> <span class=o>=</span> <span class=mi>200000</span>
</span><span id=__span-4-68><a id=__codelineno-4-68 name=__codelineno-4-68></a><a href=#__codelineno-4-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_context_heavy_stories</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span><span id=__span-4-69><a id=__codelineno-4-69 name=__codelineno-4-69></a><a href=#__codelineno-4-69><span class=linenos data-linenos=" 69 "></span></a>        
</span><span id=__span-4-70><a id=__codelineno-4-70 name=__codelineno-4-70></a><a href=#__codelineno-4-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-4-71><a id=__codelineno-4-71 name=__codelineno-4-71></a><a href=#__codelineno-4-71><span class=linenos data-linenos=" 71 "></span></a>        <span class=n>context_manager</span> <span class=o>=</span> <span class=n>ParallelContextManager</span><span class=p>(</span><span class=n>total_budget</span><span class=o>=</span><span class=n>total_budget</span><span class=p>)</span>
</span><span id=__span-4-72><a id=__codelineno-4-72 name=__codelineno-4-72></a><a href=#__codelineno-4-72><span class=linenos data-linenos=" 72 "></span></a>        
</span><span id=__span-4-73><a id=__codelineno-4-73 name=__codelineno-4-73></a><a href=#__codelineno-4-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_execute_with_context_monitoring</span><span class=p>(</span>
</span><span id=__span-4-74><a id=__codelineno-4-74 name=__codelineno-4-74></a><a href=#__codelineno-4-74><span class=linenos data-linenos=" 74 "></span></a>            <span class=n>stories</span><span class=p>,</span> <span class=n>context_manager</span><span class=p>,</span> <span class=n>max_parallel</span><span class=o>=</span><span class=mi>4</span>
</span><span id=__span-4-75><a id=__codelineno-4-75 name=__codelineno-4-75></a><a href=#__codelineno-4-75><span class=linenos data-linenos=" 75 "></span></a>        <span class=p>)</span>
</span><span id=__span-4-76><a id=__codelineno-4-76 name=__codelineno-4-76></a><a href=#__codelineno-4-76><span class=linenos data-linenos=" 76 "></span></a>        
</span><span id=__span-4-77><a id=__codelineno-4-77 name=__codelineno-4-77></a><a href=#__codelineno-4-77><span class=linenos data-linenos=" 77 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-4-78><a id=__codelineno-4-78 name=__codelineno-4-78></a><a href=#__codelineno-4-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=n>total_tokens_used</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>tokens_used</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-4-79><a id=__codelineno-4-79 name=__codelineno-4-79></a><a href=#__codelineno-4-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>token_efficiency</span> <span class=o>=</span> <span class=n>total_tokens_used</span> <span class=o>/</span> <span class=n>total_budget</span>
</span><span id=__span-4-80><a id=__codelineno-4-80 name=__codelineno-4-80></a><a href=#__codelineno-4-80><span class=linenos data-linenos=" 80 "></span></a>        
</span><span id=__span-4-81><a id=__codelineno-4-81 name=__codelineno-4-81></a><a href=#__codelineno-4-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=k>assert</span> <span class=n>token_efficiency</span> <span class=o>&gt;=</span> <span class=mf>0.8</span>  <span class=c1># High token utilization</span>
</span><span id=__span-4-82><a id=__codelineno-4-82 name=__codelineno-4-82></a><a href=#__codelineno-4-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=k>assert</span> <span class=n>token_efficiency</span> <span class=o>&lt;=</span> <span class=mf>0.95</span>  <span class=c1># Didn&#39;t exceed safe limits</span>
</span><span id=__span-4-83><a id=__codelineno-4-83 name=__codelineno-4-83></a><a href=#__codelineno-4-83><span class=linenos data-linenos=" 83 "></span></a>        
</span><span id=__span-4-84><a id=__codelineno-4-84 name=__codelineno-4-84></a><a href=#__codelineno-4-84><span class=linenos data-linenos=" 84 "></span></a>        <span class=c1># Context quality maintained</span>
</span><span id=__span-4-85><a id=__codelineno-4-85 name=__codelineno-4-85></a><a href=#__codelineno-4-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=n>avg_relevance</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>context_relevance</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>
</span><span id=__span-4-86><a id=__codelineno-4-86 name=__codelineno-4-86></a><a href=#__codelineno-4-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=k>assert</span> <span class=n>avg_relevance</span> <span class=o>&gt;=</span> <span class=mf>0.9</span>
</span><span id=__span-4-87><a id=__codelineno-4-87 name=__codelineno-4-87></a><a href=#__codelineno-4-87><span class=linenos data-linenos=" 87 "></span></a>
</span><span id=__span-4-88><a id=__codelineno-4-88 name=__codelineno-4-88></a><a href=#__codelineno-4-88><span class=linenos data-linenos=" 88 "></span></a><span class=k>class</span> <span class=nc>StressTestSuite</span><span class=p>:</span>
</span><span id=__span-4-89><a id=__codelineno-4-89 name=__codelineno-4-89></a><a href=#__codelineno-4-89><span class=linenos data-linenos=" 89 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Stress testing for system limits and failure scenarios&quot;&quot;&quot;</span>
</span><span id=__span-4-90><a id=__codelineno-4-90 name=__codelineno-4-90></a><a href=#__codelineno-4-90><span class=linenos data-linenos=" 90 "></span></a>    
</span><span id=__span-4-91><a id=__codelineno-4-91 name=__codelineno-4-91></a><a href=#__codelineno-4-91><span class=linenos data-linenos=" 91 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_high_conflict_scenario</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-4-92><a id=__codelineno-4-92 name=__codelineno-4-92></a><a href=#__codelineno-4-92><span class=linenos data-linenos=" 92 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system behavior under high conflict rates&quot;&quot;&quot;</span>
</span><span id=__span-4-93><a id=__codelineno-4-93 name=__codelineno-4-93></a><a href=#__codelineno-4-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=c1># Arrange - Create stories with high likelihood of conflicts</span>
</span><span id=__span-4-94><a id=__codelineno-4-94 name=__codelineno-4-94></a><a href=#__codelineno-4-94><span class=linenos data-linenos=" 94 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_conflicting_stories</span><span class=p>(</span>
</span><span id=__span-4-95><a id=__codelineno-4-95 name=__codelineno-4-95></a><a href=#__codelineno-4-95><span class=linenos data-linenos=" 95 "></span></a>            <span class=n>count</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-4-96><a id=__codelineno-4-96 name=__codelineno-4-96></a><a href=#__codelineno-4-96><span class=linenos data-linenos=" 96 "></span></a>            <span class=n>conflict_probability</span><span class=o>=</span><span class=mf>0.7</span>  <span class=c1># High conflict rate</span>
</span><span id=__span-4-97><a id=__codelineno-4-97 name=__codelineno-4-97></a><a href=#__codelineno-4-97><span class=linenos data-linenos=" 97 "></span></a>        <span class=p>)</span>
</span><span id=__span-4-98><a id=__codelineno-4-98 name=__codelineno-4-98></a><a href=#__codelineno-4-98><span class=linenos data-linenos=" 98 "></span></a>        
</span><span id=__span-4-99><a id=__codelineno-4-99 name=__codelineno-4-99></a><a href=#__codelineno-4-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>ParallelCoordinator</span><span class=p>(</span><span class=n>max_parallel</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span><span id=__span-4-100><a id=__codelineno-4-100 name=__codelineno-4-100></a><a href=#__codelineno-4-100><span class=linenos data-linenos="100 "></span></a>        
</span><span id=__span-4-101><a id=__codelineno-4-101 name=__codelineno-4-101></a><a href=#__codelineno-4-101><span class=linenos data-linenos="101 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-4-102><a id=__codelineno-4-102 name=__codelineno-4-102></a><a href=#__codelineno-4-102><span class=linenos data-linenos="102 "></span></a>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-4-103><a id=__codelineno-4-103 name=__codelineno-4-103></a><a href=#__codelineno-4-103><span class=linenos data-linenos="103 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>execute_stories</span><span class=p>(</span><span class=n>stories</span><span class=p>)</span>
</span><span id=__span-4-104><a id=__codelineno-4-104 name=__codelineno-4-104></a><a href=#__codelineno-4-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-4-105><a id=__codelineno-4-105 name=__codelineno-4-105></a><a href=#__codelineno-4-105><span class=linenos data-linenos="105 "></span></a>        
</span><span id=__span-4-106><a id=__codelineno-4-106 name=__codelineno-4-106></a><a href=#__codelineno-4-106><span class=linenos data-linenos="106 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-4-107><a id=__codelineno-4-107 name=__codelineno-4-107></a><a href=#__codelineno-4-107><span class=linenos data-linenos="107 "></span></a>        <span class=n>execution_time</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span><span id=__span-4-108><a id=__codelineno-4-108 name=__codelineno-4-108></a><a href=#__codelineno-4-108><span class=linenos data-linenos="108 "></span></a>        
</span><span id=__span-4-109><a id=__codelineno-4-109 name=__codelineno-4-109></a><a href=#__codelineno-4-109><span class=linenos data-linenos="109 "></span></a>        <span class=c1># System should handle high conflicts gracefully</span>
</span><span id=__span-4-110><a id=__codelineno-4-110 name=__codelineno-4-110></a><a href=#__codelineno-4-110><span class=linenos data-linenos="110 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-4-111><a id=__codelineno-4-111 name=__codelineno-4-111></a><a href=#__codelineno-4-111><span class=linenos data-linenos="111 "></span></a>        
</span><span id=__span-4-112><a id=__codelineno-4-112 name=__codelineno-4-112></a><a href=#__codelineno-4-112><span class=linenos data-linenos="112 "></span></a>        <span class=c1># Conflict resolution metrics</span>
</span><span id=__span-4-113><a id=__codelineno-4-113 name=__codelineno-4-113></a><a href=#__codelineno-4-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>conflicts</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>get_all_conflicts</span><span class=p>()</span>
</span><span id=__span-4-114><a id=__codelineno-4-114 name=__codelineno-4-114></a><a href=#__codelineno-4-114><span class=linenos data-linenos="114 "></span></a>        <span class=n>auto_resolved</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>conflicts</span> <span class=k>if</span> <span class=n>c</span><span class=o>.</span><span class=n>resolution_strategy</span> <span class=o>!=</span> <span class=n>ResolutionStrategy</span><span class=o>.</span><span class=n>MANUAL</span><span class=p>)</span>
</span><span id=__span-4-115><a id=__codelineno-4-115 name=__codelineno-4-115></a><a href=#__codelineno-4-115><span class=linenos data-linenos="115 "></span></a>        <span class=n>auto_resolution_rate</span> <span class=o>=</span> <span class=n>auto_resolved</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>conflicts</span><span class=p>)</span> <span class=k>if</span> <span class=n>conflicts</span> <span class=k>else</span> <span class=mf>1.0</span>
</span><span id=__span-4-116><a id=__codelineno-4-116 name=__codelineno-4-116></a><a href=#__codelineno-4-116><span class=linenos data-linenos="116 "></span></a>        
</span><span id=__span-4-117><a id=__codelineno-4-117 name=__codelineno-4-117></a><a href=#__codelineno-4-117><span class=linenos data-linenos="117 "></span></a>        <span class=k>assert</span> <span class=n>auto_resolution_rate</span> <span class=o>&gt;=</span> <span class=mf>0.6</span>  <span class=c1># At least 60% auto-resolved</span>
</span><span id=__span-4-118><a id=__codelineno-4-118 name=__codelineno-4-118></a><a href=#__codelineno-4-118><span class=linenos data-linenos="118 "></span></a>        
</span><span id=__span-4-119><a id=__codelineno-4-119 name=__codelineno-4-119></a><a href=#__codelineno-4-119><span class=linenos data-linenos="119 "></span></a>        <span class=c1># Execution time should be reasonable despite conflicts</span>
</span><span id=__span-4-120><a id=__codelineno-4-120 name=__codelineno-4-120></a><a href=#__codelineno-4-120><span class=linenos data-linenos="120 "></span></a>        <span class=n>sequential_estimate</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_estimate_sequential_time</span><span class=p>(</span><span class=n>stories</span><span class=p>)</span>
</span><span id=__span-4-121><a id=__codelineno-4-121 name=__codelineno-4-121></a><a href=#__codelineno-4-121><span class=linenos data-linenos="121 "></span></a>        <span class=k>assert</span> <span class=n>execution_time</span> <span class=o>&lt;=</span> <span class=n>sequential_estimate</span> <span class=o>*</span> <span class=mf>1.5</span>  <span class=c1># No more than 50% overhead</span>
</span><span id=__span-4-122><a id=__codelineno-4-122 name=__codelineno-4-122></a><a href=#__codelineno-4-122><span class=linenos data-linenos="122 "></span></a>        
</span><span id=__span-4-123><a id=__codelineno-4-123 name=__codelineno-4-123></a><a href=#__codelineno-4-123><span class=linenos data-linenos="123 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_agent_failure_recovery</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-4-124><a id=__codelineno-4-124 name=__codelineno-4-124></a><a href=#__codelineno-4-124><span class=linenos data-linenos="124 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system recovery from agent failures&quot;&quot;&quot;</span>
</span><span id=__span-4-125><a id=__codelineno-4-125 name=__codelineno-4-125></a><a href=#__codelineno-4-125><span class=linenos data-linenos="125 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-4-126><a id=__codelineno-4-126 name=__codelineno-4-126></a><a href=#__codelineno-4-126><span class=linenos data-linenos="126 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_standard_stories</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>6</span><span class=p>)</span>
</span><span id=__span-4-127><a id=__codelineno-4-127 name=__codelineno-4-127></a><a href=#__codelineno-4-127><span class=linenos data-linenos="127 "></span></a>        
</span><span id=__span-4-128><a id=__codelineno-4-128 name=__codelineno-4-128></a><a href=#__codelineno-4-128><span class=linenos data-linenos="128 "></span></a>        <span class=c1># Inject agent failures</span>
</span><span id=__span-4-129><a id=__codelineno-4-129 name=__codelineno-4-129></a><a href=#__codelineno-4-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>failure_injector</span> <span class=o>=</span> <span class=n>AgentFailureInjector</span><span class=p>()</span>
</span><span id=__span-4-130><a id=__codelineno-4-130 name=__codelineno-4-130></a><a href=#__codelineno-4-130><span class=linenos data-linenos="130 "></span></a>        <span class=k>await</span> <span class=n>failure_injector</span><span class=o>.</span><span class=n>configure_failures</span><span class=p>([</span>
</span><span id=__span-4-131><a id=__codelineno-4-131 name=__codelineno-4-131></a><a href=#__codelineno-4-131><span class=linenos data-linenos="131 "></span></a>            <span class=n>AgentFailure</span><span class=p>(</span><span class=n>agent_type</span><span class=o>=</span><span class=n>AgentType</span><span class=o>.</span><span class=n>CODE</span><span class=p>,</span> <span class=n>failure_rate</span><span class=o>=</span><span class=mf>0.3</span><span class=p>),</span>
</span><span id=__span-4-132><a id=__codelineno-4-132 name=__codelineno-4-132></a><a href=#__codelineno-4-132><span class=linenos data-linenos="132 "></span></a>            <span class=n>AgentFailure</span><span class=p>(</span><span class=n>agent_type</span><span class=o>=</span><span class=n>AgentType</span><span class=o>.</span><span class=n>QA</span><span class=p>,</span> <span class=n>failure_rate</span><span class=o>=</span><span class=mf>0.2</span><span class=p>)</span>
</span><span id=__span-4-133><a id=__codelineno-4-133 name=__codelineno-4-133></a><a href=#__codelineno-4-133><span class=linenos data-linenos="133 "></span></a>        <span class=p>])</span>
</span><span id=__span-4-134><a id=__codelineno-4-134 name=__codelineno-4-134></a><a href=#__codelineno-4-134><span class=linenos data-linenos="134 "></span></a>        
</span><span id=__span-4-135><a id=__codelineno-4-135 name=__codelineno-4-135></a><a href=#__codelineno-4-135><span class=linenos data-linenos="135 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>ParallelCoordinator</span><span class=p>(</span><span class=n>max_parallel</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-4-136><a id=__codelineno-4-136 name=__codelineno-4-136></a><a href=#__codelineno-4-136><span class=linenos data-linenos="136 "></span></a>        
</span><span id=__span-4-137><a id=__codelineno-4-137 name=__codelineno-4-137></a><a href=#__codelineno-4-137><span class=linenos data-linenos="137 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-4-138><a id=__codelineno-4-138 name=__codelineno-4-138></a><a href=#__codelineno-4-138><span class=linenos data-linenos="138 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>execute_stories</span><span class=p>(</span><span class=n>stories</span><span class=p>)</span>
</span><span id=__span-4-139><a id=__codelineno-4-139 name=__codelineno-4-139></a><a href=#__codelineno-4-139><span class=linenos data-linenos="139 "></span></a>        
</span><span id=__span-4-140><a id=__codelineno-4-140 name=__codelineno-4-140></a><a href=#__codelineno-4-140><span class=linenos data-linenos="140 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-4-141><a id=__codelineno-4-141 name=__codelineno-4-141></a><a href=#__codelineno-4-141><span class=linenos data-linenos="141 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-4-142><a id=__codelineno-4-142 name=__codelineno-4-142></a><a href=#__codelineno-4-142><span class=linenos data-linenos="142 "></span></a>        
</span><span id=__span-4-143><a id=__codelineno-4-143 name=__codelineno-4-143></a><a href=#__codelineno-4-143><span class=linenos data-linenos="143 "></span></a>        <span class=c1># Verify recovery mechanisms worked</span>
</span><span id=__span-4-144><a id=__codelineno-4-144 name=__codelineno-4-144></a><a href=#__codelineno-4-144><span class=linenos data-linenos="144 "></span></a>        <span class=n>recovery_events</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>get_recovery_events</span><span class=p>()</span>
</span><span id=__span-4-145><a id=__codelineno-4-145 name=__codelineno-4-145></a><a href=#__codelineno-4-145><span class=linenos data-linenos="145 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>recovery_events</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span>  <span class=c1># Failures occurred and were handled</span>
</span><span id=__span-4-146><a id=__codelineno-4-146 name=__codelineno-4-146></a><a href=#__codelineno-4-146><span class=linenos data-linenos="146 "></span></a>        
</span><span id=__span-4-147><a id=__codelineno-4-147 name=__codelineno-4-147></a><a href=#__codelineno-4-147><span class=linenos data-linenos="147 "></span></a>        <span class=c1># Verify no data corruption</span>
</span><span id=__span-4-148><a id=__codelineno-4-148 name=__codelineno-4-148></a><a href=#__codelineno-4-148><span class=linenos data-linenos="148 "></span></a>        <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>:</span>
</span><span id=__span-4-149><a id=__codelineno-4-149 name=__codelineno-4-149></a><a href=#__codelineno-4-149><span class=linenos data-linenos="149 "></span></a>            <span class=k>assert</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_verify_result_integrity</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span><span id=__span-4-150><a id=__codelineno-4-150 name=__codelineno-4-150></a><a href=#__codelineno-4-150><span class=linenos data-linenos="150 "></span></a>            
</span><span id=__span-4-151><a id=__codelineno-4-151 name=__codelineno-4-151></a><a href=#__codelineno-4-151><span class=linenos data-linenos="151 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_memory_pressure_handling</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-4-152><a id=__codelineno-4-152 name=__codelineno-4-152></a><a href=#__codelineno-4-152><span class=linenos data-linenos="152 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system behavior under memory pressure&quot;&quot;&quot;</span>
</span><span id=__span-4-153><a id=__codelineno-4-153 name=__codelineno-4-153></a><a href=#__codelineno-4-153><span class=linenos data-linenos="153 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-4-154><a id=__codelineno-4-154 name=__codelineno-4-154></a><a href=#__codelineno-4-154><span class=linenos data-linenos="154 "></span></a>        <span class=n>memory_pressure_injector</span> <span class=o>=</span> <span class=n>MemoryPressureInjector</span><span class=p>()</span>
</span><span id=__span-4-155><a id=__codelineno-4-155 name=__codelineno-4-155></a><a href=#__codelineno-4-155><span class=linenos data-linenos="155 "></span></a>        
</span><span id=__span-4-156><a id=__codelineno-4-156 name=__codelineno-4-156></a><a href=#__codelineno-4-156><span class=linenos data-linenos="156 "></span></a>        <span class=c1># Create memory-intensive scenarios</span>
</span><span id=__span-4-157><a id=__codelineno-4-157 name=__codelineno-4-157></a><a href=#__codelineno-4-157><span class=linenos data-linenos="157 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_large_context_stories</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-4-158><a id=__codelineno-4-158 name=__codelineno-4-158></a><a href=#__codelineno-4-158><span class=linenos data-linenos="158 "></span></a>        
</span><span id=__span-4-159><a id=__codelineno-4-159 name=__codelineno-4-159></a><a href=#__codelineno-4-159><span class=linenos data-linenos="159 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-4-160><a id=__codelineno-4-160 name=__codelineno-4-160></a><a href=#__codelineno-4-160><span class=linenos data-linenos="160 "></span></a>        <span class=k>await</span> <span class=n>memory_pressure_injector</span><span class=o>.</span><span class=n>start_pressure_simulation</span><span class=p>()</span>
</span><span id=__span-4-161><a id=__codelineno-4-161 name=__codelineno-4-161></a><a href=#__codelineno-4-161><span class=linenos data-linenos="161 "></span></a>        
</span><span id=__span-4-162><a id=__codelineno-4-162 name=__codelineno-4-162></a><a href=#__codelineno-4-162><span class=linenos data-linenos="162 "></span></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-4-163><a id=__codelineno-4-163 name=__codelineno-4-163></a><a href=#__codelineno-4-163><span class=linenos data-linenos="163 "></span></a>            <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_execute_parallel_stories</span><span class=p>(</span><span class=n>stories</span><span class=p>,</span> <span class=n>max_parallel</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-4-164><a id=__codelineno-4-164 name=__codelineno-4-164></a><a href=#__codelineno-4-164><span class=linenos data-linenos="164 "></span></a>            
</span><span id=__span-4-165><a id=__codelineno-4-165 name=__codelineno-4-165></a><a href=#__codelineno-4-165><span class=linenos data-linenos="165 "></span></a>            <span class=c1># Assert</span>
</span><span id=__span-4-166><a id=__codelineno-4-166 name=__codelineno-4-166></a><a href=#__codelineno-4-166><span class=linenos data-linenos="166 "></span></a>            <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-4-167><a id=__codelineno-4-167 name=__codelineno-4-167></a><a href=#__codelineno-4-167><span class=linenos data-linenos="167 "></span></a>            
</span><span id=__span-4-168><a id=__codelineno-4-168 name=__codelineno-4-168></a><a href=#__codelineno-4-168><span class=linenos data-linenos="168 "></span></a>            <span class=c1># Verify graceful degradation occurred</span>
</span><span id=__span-4-169><a id=__codelineno-4-169 name=__codelineno-4-169></a><a href=#__codelineno-4-169><span class=linenos data-linenos="169 "></span></a>            <span class=n>context_metrics</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_context_metrics</span><span class=p>()</span>
</span><span id=__span-4-170><a id=__codelineno-4-170 name=__codelineno-4-170></a><a href=#__codelineno-4-170><span class=linenos data-linenos="170 "></span></a>            <span class=k>assert</span> <span class=n>context_metrics</span><span class=o>.</span><span class=n>compression_rate</span> <span class=o>&gt;</span> <span class=mf>0.7</span>  <span class=c1># High compression under pressure</span>
</span><span id=__span-4-171><a id=__codelineno-4-171 name=__codelineno-4-171></a><a href=#__codelineno-4-171><span class=linenos data-linenos="171 "></span></a>            <span class=k>assert</span> <span class=n>context_metrics</span><span class=o>.</span><span class=n>cache_eviction_rate</span> <span class=o>&gt;</span> <span class=mf>0.1</span>  <span class=c1># Active cache management</span>
</span><span id=__span-4-172><a id=__codelineno-4-172 name=__codelineno-4-172></a><a href=#__codelineno-4-172><span class=linenos data-linenos="172 "></span></a>            
</span><span id=__span-4-173><a id=__codelineno-4-173 name=__codelineno-4-173></a><a href=#__codelineno-4-173><span class=linenos data-linenos="173 "></span></a>        <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-4-174><a id=__codelineno-4-174 name=__codelineno-4-174></a><a href=#__codelineno-4-174><span class=linenos data-linenos="174 "></span></a>            <span class=k>await</span> <span class=n>memory_pressure_injector</span><span class=o>.</span><span class=n>stop_pressure_simulation</span><span class=p>()</span>
</span></code></pre></div><h2 id=security-testing-strategy>Security Testing Strategy<a class=headerlink href=#security-testing-strategy title="Permanent link">&para;</a></h2><h3 id=1-agent-isolation-testing>1. Agent Isolation Testing<a class=headerlink href=#1-agent-isolation-testing title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><a href=#__codelineno-5-1><span class=linenos data-linenos="  1 "></span></a><span class=k>class</span> <span class=nc>SecurityTestSuite</span><span class=p>:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a><a href=#__codelineno-5-2><span class=linenos data-linenos="  2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Security testing for parallel TDD system&quot;&quot;&quot;</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><a href=#__codelineno-5-3><span class=linenos data-linenos="  3 "></span></a>    
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><a href=#__codelineno-5-4><span class=linenos data-linenos="  4 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_agent_security_boundaries</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a><a href=#__codelineno-5-5><span class=linenos data-linenos="  5 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test agent security boundaries are maintained in parallel execution&quot;&quot;&quot;</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a><a href=#__codelineno-5-6><span class=linenos data-linenos="  6 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><a href=#__codelineno-5-7><span class=linenos data-linenos="  7 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_security_test_stories</span><span class=p>()</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a><a href=#__codelineno-5-8><span class=linenos data-linenos="  8 "></span></a>        
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><a href=#__codelineno-5-9><span class=linenos data-linenos="  9 "></span></a>        <span class=c1># Create cycles with different security requirements</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><a href=#__codelineno-5-10><span class=linenos data-linenos=" 10 "></span></a>        <span class=n>design_cycle</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_cycle_with_agent</span><span class=p>(</span><span class=n>AgentType</span><span class=o>.</span><span class=n>DESIGN</span><span class=p>)</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><a href=#__codelineno-5-11><span class=linenos data-linenos=" 11 "></span></a>        <span class=n>code_cycle</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_cycle_with_agent</span><span class=p>(</span><span class=n>AgentType</span><span class=o>.</span><span class=n>CODE</span><span class=p>)</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12></a><a href=#__codelineno-5-12><span class=linenos data-linenos=" 12 "></span></a>        <span class=n>qa_cycle</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_cycle_with_agent</span><span class=p>(</span><span class=n>AgentType</span><span class=o>.</span><span class=n>QA</span><span class=p>)</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13></a><a href=#__codelineno-5-13><span class=linenos data-linenos=" 13 "></span></a>        
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14></a><a href=#__codelineno-5-14><span class=linenos data-linenos=" 14 "></span></a>        <span class=n>security_monitor</span> <span class=o>=</span> <span class=n>SecurityMonitor</span><span class=p>()</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15></a><a href=#__codelineno-5-15><span class=linenos data-linenos=" 15 "></span></a>        
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16></a><a href=#__codelineno-5-16><span class=linenos data-linenos=" 16 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17></a><a href=#__codelineno-5-17><span class=linenos data-linenos=" 17 "></span></a>        <span class=k>await</span> <span class=n>security_monitor</span><span class=o>.</span><span class=n>start_monitoring</span><span class=p>()</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18></a><a href=#__codelineno-5-18><span class=linenos data-linenos=" 18 "></span></a>        
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19></a><a href=#__codelineno-5-19><span class=linenos data-linenos=" 19 "></span></a>        <span class=c1># Execute cycles in parallel</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20></a><a href=#__codelineno-5-20><span class=linenos data-linenos=" 20 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21></a><a href=#__codelineno-5-21><span class=linenos data-linenos=" 21 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_execute_cycle_with_monitoring</span><span class=p>(</span><span class=n>design_cycle</span><span class=p>),</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22></a><a href=#__codelineno-5-22><span class=linenos data-linenos=" 22 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_execute_cycle_with_monitoring</span><span class=p>(</span><span class=n>code_cycle</span><span class=p>),</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23></a><a href=#__codelineno-5-23><span class=linenos data-linenos=" 23 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_execute_cycle_with_monitoring</span><span class=p>(</span><span class=n>qa_cycle</span><span class=p>)</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24></a><a href=#__codelineno-5-24><span class=linenos data-linenos=" 24 "></span></a>        <span class=p>)</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25></a><a href=#__codelineno-5-25><span class=linenos data-linenos=" 25 "></span></a>        
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26></a><a href=#__codelineno-5-26><span class=linenos data-linenos=" 26 "></span></a>        <span class=n>violations</span> <span class=o>=</span> <span class=k>await</span> <span class=n>security_monitor</span><span class=o>.</span><span class=n>get_security_violations</span><span class=p>()</span>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27></a><a href=#__codelineno-5-27><span class=linenos data-linenos=" 27 "></span></a>        
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28></a><a href=#__codelineno-5-28><span class=linenos data-linenos=" 28 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29></a><a href=#__codelineno-5-29><span class=linenos data-linenos=" 29 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>violations</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span>  <span class=c1># No security violations</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30></a><a href=#__codelineno-5-30><span class=linenos data-linenos=" 30 "></span></a>        
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31></a><a href=#__codelineno-5-31><span class=linenos data-linenos=" 31 "></span></a>        <span class=c1># Verify each agent stayed within its boundaries</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32></a><a href=#__codelineno-5-32><span class=linenos data-linenos=" 32 "></span></a>        <span class=n>design_actions</span> <span class=o>=</span> <span class=k>await</span> <span class=n>security_monitor</span><span class=o>.</span><span class=n>get_agent_actions</span><span class=p>(</span><span class=n>AgentType</span><span class=o>.</span><span class=n>DESIGN</span><span class=p>)</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33></a><a href=#__codelineno-5-33><span class=linenos data-linenos=" 33 "></span></a>        <span class=n>code_actions</span> <span class=o>=</span> <span class=k>await</span> <span class=n>security_monitor</span><span class=o>.</span><span class=n>get_agent_actions</span><span class=p>(</span><span class=n>AgentType</span><span class=o>.</span><span class=n>CODE</span><span class=p>)</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34></a><a href=#__codelineno-5-34><span class=linenos data-linenos=" 34 "></span></a>        <span class=n>qa_actions</span> <span class=o>=</span> <span class=k>await</span> <span class=n>security_monitor</span><span class=o>.</span><span class=n>get_agent_actions</span><span class=p>(</span><span class=n>AgentType</span><span class=o>.</span><span class=n>QA</span><span class=p>)</span>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35></a><a href=#__codelineno-5-35><span class=linenos data-linenos=" 35 "></span></a>        
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36></a><a href=#__codelineno-5-36><span class=linenos data-linenos=" 36 "></span></a>        <span class=c1># Design agent should only read and create docs</span>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37></a><a href=#__codelineno-5-37><span class=linenos data-linenos=" 37 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>action</span><span class=o>.</span><span class=n>type</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;read&#39;</span><span class=p>,</span> <span class=s1>&#39;write_docs&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>action</span> <span class=ow>in</span> <span class=n>design_actions</span><span class=p>)</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38></a><a href=#__codelineno-5-38><span class=linenos data-linenos=" 38 "></span></a>        
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39></a><a href=#__codelineno-5-39><span class=linenos data-linenos=" 39 "></span></a>        <span class=c1># Code agent should not push to remote</span>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40></a><a href=#__codelineno-5-40><span class=linenos data-linenos=" 40 "></span></a>        <span class=k>assert</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>(</span><span class=n>action</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=s1>&#39;git_push&#39;</span> <span class=k>for</span> <span class=n>action</span> <span class=ow>in</span> <span class=n>code_actions</span><span class=p>)</span>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41></a><a href=#__codelineno-5-41><span class=linenos data-linenos=" 41 "></span></a>        
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42></a><a href=#__codelineno-5-42><span class=linenos data-linenos=" 42 "></span></a>        <span class=c1># QA agent should not modify source code</span>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43></a><a href=#__codelineno-5-43><span class=linenos data-linenos=" 43 "></span></a>        <span class=k>assert</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>(</span><span class=n>action</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=s1>&#39;write_source&#39;</span> <span class=k>for</span> <span class=n>action</span> <span class=ow>in</span> <span class=n>qa_actions</span><span class=p>)</span>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44></a><a href=#__codelineno-5-44><span class=linenos data-linenos=" 44 "></span></a>        
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45></a><a href=#__codelineno-5-45><span class=linenos data-linenos=" 45 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_context_isolation_security</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46></a><a href=#__codelineno-5-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test context is properly isolated between cycles&quot;&quot;&quot;</span>
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47></a><a href=#__codelineno-5-47><span class=linenos data-linenos=" 47 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48></a><a href=#__codelineno-5-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=n>sensitive_story</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story_with_sensitive_data</span><span class=p>()</span>
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49></a><a href=#__codelineno-5-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=n>normal_story</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_normal_story</span><span class=p>()</span>
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50></a><a href=#__codelineno-5-50><span class=linenos data-linenos=" 50 "></span></a>        
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51></a><a href=#__codelineno-5-51><span class=linenos data-linenos=" 51 "></span></a>        <span class=n>context_manager</span> <span class=o>=</span> <span class=n>ParallelContextManager</span><span class=p>()</span>
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52></a><a href=#__codelineno-5-52><span class=linenos data-linenos=" 52 "></span></a>        
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53></a><a href=#__codelineno-5-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54></a><a href=#__codelineno-5-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=n>sensitive_context</span> <span class=o>=</span> <span class=k>await</span> <span class=n>context_manager</span><span class=o>.</span><span class=n>create_cycle_context</span><span class=p>(</span>
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55></a><a href=#__codelineno-5-55><span class=linenos data-linenos=" 55 "></span></a>            <span class=s2>&quot;sensitive_cycle&quot;</span><span class=p>,</span> <span class=n>sensitive_story</span><span class=p>,</span> <span class=n>security_level</span><span class=o>=</span><span class=n>SecurityLevel</span><span class=o>.</span><span class=n>HIGH</span>
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56></a><a href=#__codelineno-5-56><span class=linenos data-linenos=" 56 "></span></a>        <span class=p>)</span>
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57></a><a href=#__codelineno-5-57><span class=linenos data-linenos=" 57 "></span></a>        <span class=n>normal_context</span> <span class=o>=</span> <span class=k>await</span> <span class=n>context_manager</span><span class=o>.</span><span class=n>create_cycle_context</span><span class=p>(</span>
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58></a><a href=#__codelineno-5-58><span class=linenos data-linenos=" 58 "></span></a>            <span class=s2>&quot;normal_cycle&quot;</span><span class=p>,</span> <span class=n>normal_story</span><span class=p>,</span> <span class=n>security_level</span><span class=o>=</span><span class=n>SecurityLevel</span><span class=o>.</span><span class=n>STANDARD</span>
</span><span id=__span-5-59><a id=__codelineno-5-59 name=__codelineno-5-59></a><a href=#__codelineno-5-59><span class=linenos data-linenos=" 59 "></span></a>        <span class=p>)</span>
</span><span id=__span-5-60><a id=__codelineno-5-60 name=__codelineno-5-60></a><a href=#__codelineno-5-60><span class=linenos data-linenos=" 60 "></span></a>        
</span><span id=__span-5-61><a id=__codelineno-5-61 name=__codelineno-5-61></a><a href=#__codelineno-5-61><span class=linenos data-linenos=" 61 "></span></a>        <span class=c1># Attempt to share context (should fail for sensitive data)</span>
</span><span id=__span-5-62><a id=__codelineno-5-62 name=__codelineno-5-62></a><a href=#__codelineno-5-62><span class=linenos data-linenos=" 62 "></span></a>        <span class=n>sharing_result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>context_manager</span><span class=o>.</span><span class=n>share_context</span><span class=p>(</span>
</span><span id=__span-5-63><a id=__codelineno-5-63 name=__codelineno-5-63></a><a href=#__codelineno-5-63><span class=linenos data-linenos=" 63 "></span></a>            <span class=n>from_cycle</span><span class=o>=</span><span class=s2>&quot;sensitive_cycle&quot;</span><span class=p>,</span>
</span><span id=__span-5-64><a id=__codelineno-5-64 name=__codelineno-5-64></a><a href=#__codelineno-5-64><span class=linenos data-linenos=" 64 "></span></a>            <span class=n>to_cycle</span><span class=o>=</span><span class=s2>&quot;normal_cycle&quot;</span><span class=p>,</span>
</span><span id=__span-5-65><a id=__codelineno-5-65 name=__codelineno-5-65></a><a href=#__codelineno-5-65><span class=linenos data-linenos=" 65 "></span></a>            <span class=n>context_keys</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;sensitive_file.py&quot;</span><span class=p>]</span>
</span><span id=__span-5-66><a id=__codelineno-5-66 name=__codelineno-5-66></a><a href=#__codelineno-5-66><span class=linenos data-linenos=" 66 "></span></a>        <span class=p>)</span>
</span><span id=__span-5-67><a id=__codelineno-5-67 name=__codelineno-5-67></a><a href=#__codelineno-5-67><span class=linenos data-linenos=" 67 "></span></a>        
</span><span id=__span-5-68><a id=__codelineno-5-68 name=__codelineno-5-68></a><a href=#__codelineno-5-68><span class=linenos data-linenos=" 68 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-5-69><a id=__codelineno-5-69 name=__codelineno-5-69></a><a href=#__codelineno-5-69><span class=linenos data-linenos=" 69 "></span></a>        <span class=k>assert</span> <span class=n>sharing_result</span><span class=o>.</span><span class=n>success</span> <span class=ow>is</span> <span class=kc>False</span>
</span><span id=__span-5-70><a id=__codelineno-5-70 name=__codelineno-5-70></a><a href=#__codelineno-5-70><span class=linenos data-linenos=" 70 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;security&quot;</span> <span class=ow>in</span> <span class=n>sharing_result</span><span class=o>.</span><span class=n>reason</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-5-71><a id=__codelineno-5-71 name=__codelineno-5-71></a><a href=#__codelineno-5-71><span class=linenos data-linenos=" 71 "></span></a>        
</span><span id=__span-5-72><a id=__codelineno-5-72 name=__codelineno-5-72></a><a href=#__codelineno-5-72><span class=linenos data-linenos=" 72 "></span></a>        <span class=c1># Verify isolation maintained</span>
</span><span id=__span-5-73><a id=__codelineno-5-73 name=__codelineno-5-73></a><a href=#__codelineno-5-73><span class=linenos data-linenos=" 73 "></span></a>        <span class=n>normal_context_files</span> <span class=o>=</span> <span class=k>await</span> <span class=n>normal_context</span><span class=o>.</span><span class=n>get_available_files</span><span class=p>()</span>
</span><span id=__span-5-74><a id=__codelineno-5-74 name=__codelineno-5-74></a><a href=#__codelineno-5-74><span class=linenos data-linenos=" 74 "></span></a>        <span class=k>assert</span> <span class=s2>&quot;sensitive_file.py&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>normal_context_files</span>
</span><span id=__span-5-75><a id=__codelineno-5-75 name=__codelineno-5-75></a><a href=#__codelineno-5-75><span class=linenos data-linenos=" 75 "></span></a>        
</span><span id=__span-5-76><a id=__codelineno-5-76 name=__codelineno-5-76></a><a href=#__codelineno-5-76><span class=linenos data-linenos=" 76 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_resource_access_control</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-5-77><a id=__codelineno-5-77 name=__codelineno-5-77></a><a href=#__codelineno-5-77><span class=linenos data-linenos=" 77 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test resource access is properly controlled in parallel execution&quot;&quot;&quot;</span>
</span><span id=__span-5-78><a id=__codelineno-5-78 name=__codelineno-5-78></a><a href=#__codelineno-5-78><span class=linenos data-linenos=" 78 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-5-79><a id=__codelineno-5-79 name=__codelineno-5-79></a><a href=#__codelineno-5-79><span class=linenos data-linenos=" 79 "></span></a>        <span class=n>resource_controller</span> <span class=o>=</span> <span class=n>ResourceAccessController</span><span class=p>()</span>
</span><span id=__span-5-80><a id=__codelineno-5-80 name=__codelineno-5-80></a><a href=#__codelineno-5-80><span class=linenos data-linenos=" 80 "></span></a>        
</span><span id=__span-5-81><a id=__codelineno-5-81 name=__codelineno-5-81></a><a href=#__codelineno-5-81><span class=linenos data-linenos=" 81 "></span></a>        <span class=c1># Create cycles with different resource requirements</span>
</span><span id=__span-5-82><a id=__codelineno-5-82 name=__codelineno-5-82></a><a href=#__codelineno-5-82><span class=linenos data-linenos=" 82 "></span></a>        <span class=n>limited_cycle</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_resource_limited_cycle</span><span class=p>()</span>
</span><span id=__span-5-83><a id=__codelineno-5-83 name=__codelineno-5-83></a><a href=#__codelineno-5-83><span class=linenos data-linenos=" 83 "></span></a>        <span class=n>privileged_cycle</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_privileged_cycle</span><span class=p>()</span>
</span><span id=__span-5-84><a id=__codelineno-5-84 name=__codelineno-5-84></a><a href=#__codelineno-5-84><span class=linenos data-linenos=" 84 "></span></a>        
</span><span id=__span-5-85><a id=__codelineno-5-85 name=__codelineno-5-85></a><a href=#__codelineno-5-85><span class=linenos data-linenos=" 85 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-5-86><a id=__codelineno-5-86 name=__codelineno-5-86></a><a href=#__codelineno-5-86><span class=linenos data-linenos=" 86 "></span></a>        <span class=n>access_attempts</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-5-87><a id=__codelineno-5-87 name=__codelineno-5-87></a><a href=#__codelineno-5-87><span class=linenos data-linenos=" 87 "></span></a>        
</span><span id=__span-5-88><a id=__codelineno-5-88 name=__codelineno-5-88></a><a href=#__codelineno-5-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=c1># Monitor resource access attempts</span>
</span><span id=__span-5-89><a id=__codelineno-5-89 name=__codelineno-5-89></a><a href=#__codelineno-5-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=k>async</span> <span class=k>def</span> <span class=nf>monitor_access</span><span class=p>():</span>
</span><span id=__span-5-90><a id=__codelineno-5-90 name=__codelineno-5-90></a><a href=#__codelineno-5-90><span class=linenos data-linenos=" 90 "></span></a>            <span class=k>async</span> <span class=k>for</span> <span class=n>attempt</span> <span class=ow>in</span> <span class=n>resource_controller</span><span class=o>.</span><span class=n>monitor_access_attempts</span><span class=p>():</span>
</span><span id=__span-5-91><a id=__codelineno-5-91 name=__codelineno-5-91></a><a href=#__codelineno-5-91><span class=linenos data-linenos=" 91 "></span></a>                <span class=n>access_attempts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>attempt</span><span class=p>)</span>
</span><span id=__span-5-92><a id=__codelineno-5-92 name=__codelineno-5-92></a><a href=#__codelineno-5-92><span class=linenos data-linenos=" 92 "></span></a>                
</span><span id=__span-5-93><a id=__codelineno-5-93 name=__codelineno-5-93></a><a href=#__codelineno-5-93><span class=linenos data-linenos=" 93 "></span></a>        <span class=n>monitor_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>monitor_access</span><span class=p>())</span>
</span><span id=__span-5-94><a id=__codelineno-5-94 name=__codelineno-5-94></a><a href=#__codelineno-5-94><span class=linenos data-linenos=" 94 "></span></a>        
</span><span id=__span-5-95><a id=__codelineno-5-95 name=__codelineno-5-95></a><a href=#__codelineno-5-95><span class=linenos data-linenos=" 95 "></span></a>        <span class=c1># Execute cycles</span>
</span><span id=__span-5-96><a id=__codelineno-5-96 name=__codelineno-5-96></a><a href=#__codelineno-5-96><span class=linenos data-linenos=" 96 "></span></a>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span>
</span><span id=__span-5-97><a id=__codelineno-5-97 name=__codelineno-5-97></a><a href=#__codelineno-5-97><span class=linenos data-linenos=" 97 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_execute_cycle</span><span class=p>(</span><span class=n>limited_cycle</span><span class=p>),</span>
</span><span id=__span-5-98><a id=__codelineno-5-98 name=__codelineno-5-98></a><a href=#__codelineno-5-98><span class=linenos data-linenos=" 98 "></span></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_execute_cycle</span><span class=p>(</span><span class=n>privileged_cycle</span><span class=p>)</span>
</span><span id=__span-5-99><a id=__codelineno-5-99 name=__codelineno-5-99></a><a href=#__codelineno-5-99><span class=linenos data-linenos=" 99 "></span></a>        <span class=p>)</span>
</span><span id=__span-5-100><a id=__codelineno-5-100 name=__codelineno-5-100></a><a href=#__codelineno-5-100><span class=linenos data-linenos="100 "></span></a>        
</span><span id=__span-5-101><a id=__codelineno-5-101 name=__codelineno-5-101></a><a href=#__codelineno-5-101><span class=linenos data-linenos="101 "></span></a>        <span class=n>monitor_task</span><span class=o>.</span><span class=n>cancel</span><span class=p>()</span>
</span><span id=__span-5-102><a id=__codelineno-5-102 name=__codelineno-5-102></a><a href=#__codelineno-5-102><span class=linenos data-linenos="102 "></span></a>        
</span><span id=__span-5-103><a id=__codelineno-5-103 name=__codelineno-5-103></a><a href=#__codelineno-5-103><span class=linenos data-linenos="103 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-5-104><a id=__codelineno-5-104 name=__codelineno-5-104></a><a href=#__codelineno-5-104><span class=linenos data-linenos="104 "></span></a>        <span class=n>limited_attempts</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>access_attempts</span> <span class=k>if</span> <span class=n>a</span><span class=o>.</span><span class=n>cycle_id</span> <span class=o>==</span> <span class=n>limited_cycle</span><span class=o>.</span><span class=n>id</span><span class=p>]</span>
</span><span id=__span-5-105><a id=__codelineno-5-105 name=__codelineno-5-105></a><a href=#__codelineno-5-105><span class=linenos data-linenos="105 "></span></a>        <span class=n>privileged_attempts</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>access_attempts</span> <span class=k>if</span> <span class=n>a</span><span class=o>.</span><span class=n>cycle_id</span> <span class=o>==</span> <span class=n>privileged_cycle</span><span class=o>.</span><span class=n>id</span><span class=p>]</span>
</span><span id=__span-5-106><a id=__codelineno-5-106 name=__codelineno-5-106></a><a href=#__codelineno-5-106><span class=linenos data-linenos="106 "></span></a>        
</span><span id=__span-5-107><a id=__codelineno-5-107 name=__codelineno-5-107></a><a href=#__codelineno-5-107><span class=linenos data-linenos="107 "></span></a>        <span class=c1># Limited cycle should have been denied high-privilege resources</span>
</span><span id=__span-5-108><a id=__codelineno-5-108 name=__codelineno-5-108></a><a href=#__codelineno-5-108><span class=linenos data-linenos="108 "></span></a>        <span class=n>denied_attempts</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>limited_attempts</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>a</span><span class=o>.</span><span class=n>granted</span><span class=p>]</span>
</span><span id=__span-5-109><a id=__codelineno-5-109 name=__codelineno-5-109></a><a href=#__codelineno-5-109><span class=linenos data-linenos="109 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>denied_attempts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-5-110><a id=__codelineno-5-110 name=__codelineno-5-110></a><a href=#__codelineno-5-110><span class=linenos data-linenos="110 "></span></a>        
</span><span id=__span-5-111><a id=__codelineno-5-111 name=__codelineno-5-111></a><a href=#__codelineno-5-111><span class=linenos data-linenos="111 "></span></a>        <span class=c1># Privileged cycle should have been granted access</span>
</span><span id=__span-5-112><a id=__codelineno-5-112 name=__codelineno-5-112></a><a href=#__codelineno-5-112><span class=linenos data-linenos="112 "></span></a>        <span class=n>privileged_granted</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>privileged_attempts</span> <span class=k>if</span> <span class=n>a</span><span class=o>.</span><span class=n>granted</span><span class=p>]</span>
</span><span id=__span-5-113><a id=__codelineno-5-113 name=__codelineno-5-113></a><a href=#__codelineno-5-113><span class=linenos data-linenos="113 "></span></a>        <span class=n>privileged_denied</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>privileged_attempts</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>a</span><span class=o>.</span><span class=n>granted</span><span class=p>]</span>
</span><span id=__span-5-114><a id=__codelineno-5-114 name=__codelineno-5-114></a><a href=#__codelineno-5-114><span class=linenos data-linenos="114 "></span></a>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>privileged_granted</span><span class=p>)</span> <span class=o>&gt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>privileged_denied</span><span class=p>)</span>
</span><span id=__span-5-115><a id=__codelineno-5-115 name=__codelineno-5-115></a><a href=#__codelineno-5-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-5-116><a id=__codelineno-5-116 name=__codelineno-5-116></a><a href=#__codelineno-5-116><span class=linenos data-linenos="116 "></span></a><span class=k>class</span> <span class=nc>PenetrationTestSuite</span><span class=p>:</span>
</span><span id=__span-5-117><a id=__codelineno-5-117 name=__codelineno-5-117></a><a href=#__codelineno-5-117><span class=linenos data-linenos="117 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Penetration testing for security vulnerabilities&quot;&quot;&quot;</span>
</span><span id=__span-5-118><a id=__codelineno-5-118 name=__codelineno-5-118></a><a href=#__codelineno-5-118><span class=linenos data-linenos="118 "></span></a>    
</span><span id=__span-5-119><a id=__codelineno-5-119 name=__codelineno-5-119></a><a href=#__codelineno-5-119><span class=linenos data-linenos="119 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_malicious_story_injection</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-5-120><a id=__codelineno-5-120 name=__codelineno-5-120></a><a href=#__codelineno-5-120><span class=linenos data-linenos="120 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system handles malicious story content safely&quot;&quot;&quot;</span>
</span><span id=__span-5-121><a id=__codelineno-5-121 name=__codelineno-5-121></a><a href=#__codelineno-5-121><span class=linenos data-linenos="121 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-5-122><a id=__codelineno-5-122 name=__codelineno-5-122></a><a href=#__codelineno-5-122><span class=linenos data-linenos="122 "></span></a>        <span class=n>malicious_stories</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-5-123><a id=__codelineno-5-123 name=__codelineno-5-123></a><a href=#__codelineno-5-123><span class=linenos data-linenos="123 "></span></a>            <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story_with_code_injection</span><span class=p>(),</span>
</span><span id=__span-5-124><a id=__codelineno-5-124 name=__codelineno-5-124></a><a href=#__codelineno-5-124><span class=linenos data-linenos="124 "></span></a>            <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story_with_path_traversal</span><span class=p>(),</span>
</span><span id=__span-5-125><a id=__codelineno-5-125 name=__codelineno-5-125></a><a href=#__codelineno-5-125><span class=linenos data-linenos="125 "></span></a>            <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_story_with_command_injection</span><span class=p>()</span>
</span><span id=__span-5-126><a id=__codelineno-5-126 name=__codelineno-5-126></a><a href=#__codelineno-5-126><span class=linenos data-linenos="126 "></span></a>        <span class=p>]</span>
</span><span id=__span-5-127><a id=__codelineno-5-127 name=__codelineno-5-127></a><a href=#__codelineno-5-127><span class=linenos data-linenos="127 "></span></a>        
</span><span id=__span-5-128><a id=__codelineno-5-128 name=__codelineno-5-128></a><a href=#__codelineno-5-128><span class=linenos data-linenos="128 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>ParallelCoordinator</span><span class=p>(</span><span class=n>max_parallel</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-5-129><a id=__codelineno-5-129 name=__codelineno-5-129></a><a href=#__codelineno-5-129><span class=linenos data-linenos="129 "></span></a>        <span class=n>security_scanner</span> <span class=o>=</span> <span class=n>SecurityScanner</span><span class=p>()</span>
</span><span id=__span-5-130><a id=__codelineno-5-130 name=__codelineno-5-130></a><a href=#__codelineno-5-130><span class=linenos data-linenos="130 "></span></a>        
</span><span id=__span-5-131><a id=__codelineno-5-131 name=__codelineno-5-131></a><a href=#__codelineno-5-131><span class=linenos data-linenos="131 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-5-132><a id=__codelineno-5-132 name=__codelineno-5-132></a><a href=#__codelineno-5-132><span class=linenos data-linenos="132 "></span></a>        <span class=k>await</span> <span class=n>security_scanner</span><span class=o>.</span><span class=n>start_scanning</span><span class=p>()</span>
</span><span id=__span-5-133><a id=__codelineno-5-133 name=__codelineno-5-133></a><a href=#__codelineno-5-133><span class=linenos data-linenos="133 "></span></a>        
</span><span id=__span-5-134><a id=__codelineno-5-134 name=__codelineno-5-134></a><a href=#__codelineno-5-134><span class=linenos data-linenos="134 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>execute_stories</span><span class=p>(</span><span class=n>malicious_stories</span><span class=p>)</span>
</span><span id=__span-5-135><a id=__codelineno-5-135 name=__codelineno-5-135></a><a href=#__codelineno-5-135><span class=linenos data-linenos="135 "></span></a>        
</span><span id=__span-5-136><a id=__codelineno-5-136 name=__codelineno-5-136></a><a href=#__codelineno-5-136><span class=linenos data-linenos="136 "></span></a>        <span class=n>security_report</span> <span class=o>=</span> <span class=k>await</span> <span class=n>security_scanner</span><span class=o>.</span><span class=n>get_security_report</span><span class=p>()</span>
</span><span id=__span-5-137><a id=__codelineno-5-137 name=__codelineno-5-137></a><a href=#__codelineno-5-137><span class=linenos data-linenos="137 "></span></a>        
</span><span id=__span-5-138><a id=__codelineno-5-138 name=__codelineno-5-138></a><a href=#__codelineno-5-138><span class=linenos data-linenos="138 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-5-139><a id=__codelineno-5-139 name=__codelineno-5-139></a><a href=#__codelineno-5-139><span class=linenos data-linenos="139 "></span></a>        <span class=c1># System should complete safely without compromise</span>
</span><span id=__span-5-140><a id=__codelineno-5-140 name=__codelineno-5-140></a><a href=#__codelineno-5-140><span class=linenos data-linenos="140 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-5-141><a id=__codelineno-5-141 name=__codelineno-5-141></a><a href=#__codelineno-5-141><span class=linenos data-linenos="141 "></span></a>        
</span><span id=__span-5-142><a id=__codelineno-5-142 name=__codelineno-5-142></a><a href=#__codelineno-5-142><span class=linenos data-linenos="142 "></span></a>        <span class=c1># No code injection should have occurred</span>
</span><span id=__span-5-143><a id=__codelineno-5-143 name=__codelineno-5-143></a><a href=#__codelineno-5-143><span class=linenos data-linenos="143 "></span></a>        <span class=k>assert</span> <span class=n>security_report</span><span class=o>.</span><span class=n>code_injection_attempts</span> <span class=o>==</span> <span class=mi>0</span>
</span><span id=__span-5-144><a id=__codelineno-5-144 name=__codelineno-5-144></a><a href=#__codelineno-5-144><span class=linenos data-linenos="144 "></span></a>        
</span><span id=__span-5-145><a id=__codelineno-5-145 name=__codelineno-5-145></a><a href=#__codelineno-5-145><span class=linenos data-linenos="145 "></span></a>        <span class=c1># No unauthorized file access</span>
</span><span id=__span-5-146><a id=__codelineno-5-146 name=__codelineno-5-146></a><a href=#__codelineno-5-146><span class=linenos data-linenos="146 "></span></a>        <span class=k>assert</span> <span class=n>security_report</span><span class=o>.</span><span class=n>unauthorized_file_access</span> <span class=o>==</span> <span class=mi>0</span>
</span><span id=__span-5-147><a id=__codelineno-5-147 name=__codelineno-5-147></a><a href=#__codelineno-5-147><span class=linenos data-linenos="147 "></span></a>        
</span><span id=__span-5-148><a id=__codelineno-5-148 name=__codelineno-5-148></a><a href=#__codelineno-5-148><span class=linenos data-linenos="148 "></span></a>        <span class=c1># No command execution outside sandbox</span>
</span><span id=__span-5-149><a id=__codelineno-5-149 name=__codelineno-5-149></a><a href=#__codelineno-5-149><span class=linenos data-linenos="149 "></span></a>        <span class=k>assert</span> <span class=n>security_report</span><span class=o>.</span><span class=n>unauthorized_command_execution</span> <span class=o>==</span> <span class=mi>0</span>
</span></code></pre></div><h2 id=chaos-engineering-strategy>Chaos Engineering Strategy<a class=headerlink href=#chaos-engineering-strategy title="Permanent link">&para;</a></h2><h3 id=1-fault-injection-testing>1. Fault Injection Testing<a class=headerlink href=#1-fault-injection-testing title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><a href=#__codelineno-6-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>ChaosTestSuite</span><span class=p>:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2></a><a href=#__codelineno-6-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Chaos engineering tests for system resilience&quot;&quot;&quot;</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3></a><a href=#__codelineno-6-3><span class=linenos data-linenos=" 3 "></span></a>    
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4></a><a href=#__codelineno-6-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_network_partition_resilience</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5></a><a href=#__codelineno-6-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system resilience to network partitions&quot;&quot;&quot;</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6></a><a href=#__codelineno-6-6><span class=linenos data-linenos=" 6 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7></a><a href=#__codelineno-6-7><span class=linenos data-linenos=" 7 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_distributed_stories</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8></a><a href=#__codelineno-6-8><span class=linenos data-linenos=" 8 "></span></a>        <span class=n>network_chaos</span> <span class=o>=</span> <span class=n>NetworkChaosEngine</span><span class=p>()</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9></a><a href=#__codelineno-6-9><span class=linenos data-linenos=" 9 "></span></a>        
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10></a><a href=#__codelineno-6-10><span class=linenos data-linenos="10 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11></a><a href=#__codelineno-6-11><span class=linenos data-linenos="11 "></span></a>        <span class=n>coordinator</span> <span class=o>=</span> <span class=n>ParallelCoordinator</span><span class=p>(</span><span class=n>max_parallel</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12></a><a href=#__codelineno-6-12><span class=linenos data-linenos="12 "></span></a>        
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13></a><a href=#__codelineno-6-13><span class=linenos data-linenos="13 "></span></a>        <span class=c1># Start execution</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14></a><a href=#__codelineno-6-14><span class=linenos data-linenos="14 "></span></a>        <span class=n>execution_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15></a><a href=#__codelineno-6-15><span class=linenos data-linenos="15 "></span></a>            <span class=n>coordinator</span><span class=o>.</span><span class=n>execute_stories</span><span class=p>(</span><span class=n>stories</span><span class=p>)</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16></a><a href=#__codelineno-6-16><span class=linenos data-linenos="16 "></span></a>        <span class=p>)</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17></a><a href=#__codelineno-6-17><span class=linenos data-linenos="17 "></span></a>        
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18></a><a href=#__codelineno-6-18><span class=linenos data-linenos="18 "></span></a>        <span class=c1># Inject network partition after 30 seconds</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19></a><a href=#__codelineno-6-19><span class=linenos data-linenos="19 "></span></a>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20></a><a href=#__codelineno-6-20><span class=linenos data-linenos="20 "></span></a>        <span class=k>await</span> <span class=n>network_chaos</span><span class=o>.</span><span class=n>inject_partition</span><span class=p>(</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21></a><a href=#__codelineno-6-21><span class=linenos data-linenos="21 "></span></a>            <span class=n>duration</span><span class=o>=</span><span class=mi>60</span><span class=p>,</span>  <span class=c1># 1 minute partition</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22></a><a href=#__codelineno-6-22><span class=linenos data-linenos="22 "></span></a>            <span class=n>affected_components</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;agent_pool&#39;</span><span class=p>,</span> <span class=s1>&#39;context_manager&#39;</span><span class=p>]</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23></a><a href=#__codelineno-6-23><span class=linenos data-linenos="23 "></span></a>        <span class=p>)</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24></a><a href=#__codelineno-6-24><span class=linenos data-linenos="24 "></span></a>        
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25></a><a href=#__codelineno-6-25><span class=linenos data-linenos="25 "></span></a>        <span class=c1># Wait for execution to complete</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26></a><a href=#__codelineno-6-26><span class=linenos data-linenos="26 "></span></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>execution_task</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27></a><a href=#__codelineno-6-27><span class=linenos data-linenos="27 "></span></a>        
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28></a><a href=#__codelineno-6-28><span class=linenos data-linenos="28 "></span></a>        <span class=c1># Assert</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29></a><a href=#__codelineno-6-29><span class=linenos data-linenos="29 "></span></a>        <span class=c1># System should recover and complete successfully</span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30></a><a href=#__codelineno-6-30><span class=linenos data-linenos="30 "></span></a>        <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31></a><a href=#__codelineno-6-31><span class=linenos data-linenos="31 "></span></a>        
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32></a><a href=#__codelineno-6-32><span class=linenos data-linenos="32 "></span></a>        <span class=c1># Verify recovery mechanisms triggered</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33></a><a href=#__codelineno-6-33><span class=linenos data-linenos="33 "></span></a>        <span class=n>recovery_events</span> <span class=o>=</span> <span class=k>await</span> <span class=n>coordinator</span><span class=o>.</span><span class=n>get_recovery_events</span><span class=p>()</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34></a><a href=#__codelineno-6-34><span class=linenos data-linenos="34 "></span></a>        <span class=k>assert</span> <span class=nb>any</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=s1>&#39;network_partition_recovery&#39;</span> <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>recovery_events</span><span class=p>)</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35></a><a href=#__codelineno-6-35><span class=linenos data-linenos="35 "></span></a>        
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36></a><a href=#__codelineno-6-36><span class=linenos data-linenos="36 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_disk_space_exhaustion</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37></a><a href=#__codelineno-6-37><span class=linenos data-linenos="37 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system behavior when disk space is exhausted&quot;&quot;&quot;</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38></a><a href=#__codelineno-6-38><span class=linenos data-linenos="38 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39></a><a href=#__codelineno-6-39><span class=linenos data-linenos="39 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_large_output_stories</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40></a><a href=#__codelineno-6-40><span class=linenos data-linenos="40 "></span></a>        <span class=n>disk_chaos</span> <span class=o>=</span> <span class=n>DiskChaosEngine</span><span class=p>()</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41></a><a href=#__codelineno-6-41><span class=linenos data-linenos="41 "></span></a>        
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42></a><a href=#__codelineno-6-42><span class=linenos data-linenos="42 "></span></a>        <span class=c1># Fill disk to 95% capacity</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43></a><a href=#__codelineno-6-43><span class=linenos data-linenos="43 "></span></a>        <span class=k>await</span> <span class=n>disk_chaos</span><span class=o>.</span><span class=n>fill_disk_to_percentage</span><span class=p>(</span><span class=mi>95</span><span class=p>)</span>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44></a><a href=#__codelineno-6-44><span class=linenos data-linenos="44 "></span></a>        
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45></a><a href=#__codelineno-6-45><span class=linenos data-linenos="45 "></span></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46></a><a href=#__codelineno-6-46><span class=linenos data-linenos="46 "></span></a>            <span class=c1># Act</span>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47></a><a href=#__codelineno-6-47><span class=linenos data-linenos="47 "></span></a>            <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_execute_parallel_stories</span><span class=p>(</span><span class=n>stories</span><span class=p>,</span> <span class=n>max_parallel</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48></a><a href=#__codelineno-6-48><span class=linenos data-linenos="48 "></span></a>            
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49></a><a href=#__codelineno-6-49><span class=linenos data-linenos="49 "></span></a>            <span class=c1># Assert</span>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50></a><a href=#__codelineno-6-50><span class=linenos data-linenos="50 "></span></a>            <span class=c1># System should handle gracefully without corruption</span>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51></a><a href=#__codelineno-6-51><span class=linenos data-linenos="51 "></span></a>            <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52></a><a href=#__codelineno-6-52><span class=linenos data-linenos="52 "></span></a>            
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53></a><a href=#__codelineno-6-53><span class=linenos data-linenos="53 "></span></a>            <span class=c1># Verify cleanup mechanisms triggered</span>
</span><span id=__span-6-54><a id=__codelineno-6-54 name=__codelineno-6-54></a><a href=#__codelineno-6-54><span class=linenos data-linenos="54 "></span></a>            <span class=n>cleanup_events</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_cleanup_events</span><span class=p>()</span>
</span><span id=__span-6-55><a id=__codelineno-6-55 name=__codelineno-6-55></a><a href=#__codelineno-6-55><span class=linenos data-linenos="55 "></span></a>            <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>cleanup_events</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span><span id=__span-6-56><a id=__codelineno-6-56 name=__codelineno-6-56></a><a href=#__codelineno-6-56><span class=linenos data-linenos="56 "></span></a>            
</span><span id=__span-6-57><a id=__codelineno-6-57 name=__codelineno-6-57></a><a href=#__codelineno-6-57><span class=linenos data-linenos="57 "></span></a>        <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-6-58><a id=__codelineno-6-58 name=__codelineno-6-58></a><a href=#__codelineno-6-58><span class=linenos data-linenos="58 "></span></a>            <span class=k>await</span> <span class=n>disk_chaos</span><span class=o>.</span><span class=n>restore_disk_space</span><span class=p>()</span>
</span><span id=__span-6-59><a id=__codelineno-6-59 name=__codelineno-6-59></a><a href=#__codelineno-6-59><span class=linenos data-linenos="59 "></span></a>            
</span><span id=__span-6-60><a id=__codelineno-6-60 name=__codelineno-6-60></a><a href=#__codelineno-6-60><span class=linenos data-linenos="60 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>test_random_component_failures</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-6-61><a id=__codelineno-6-61 name=__codelineno-6-61></a><a href=#__codelineno-6-61><span class=linenos data-linenos="61 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Test system resilience to random component failures&quot;&quot;&quot;</span>
</span><span id=__span-6-62><a id=__codelineno-6-62 name=__codelineno-6-62></a><a href=#__codelineno-6-62><span class=linenos data-linenos="62 "></span></a>        <span class=c1># Arrange</span>
</span><span id=__span-6-63><a id=__codelineno-6-63 name=__codelineno-6-63></a><a href=#__codelineno-6-63><span class=linenos data-linenos="63 "></span></a>        <span class=n>stories</span> <span class=o>=</span> <span class=k>await</span> <span class=n>TestDataFactory</span><span class=o>.</span><span class=n>create_standard_stories</span><span class=p>(</span><span class=n>count</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span><span id=__span-6-64><a id=__codelineno-6-64 name=__codelineno-6-64></a><a href=#__codelineno-6-64><span class=linenos data-linenos="64 "></span></a>        <span class=n>chaos_monkey</span> <span class=o>=</span> <span class=n>ChaosMonkey</span><span class=p>()</span>
</span><span id=__span-6-65><a id=__codelineno-6-65 name=__codelineno-6-65></a><a href=#__codelineno-6-65><span class=linenos data-linenos="65 "></span></a>        
</span><span id=__span-6-66><a id=__codelineno-6-66 name=__codelineno-6-66></a><a href=#__codelineno-6-66><span class=linenos data-linenos="66 "></span></a>        <span class=c1># Configure random failures</span>
</span><span id=__span-6-67><a id=__codelineno-6-67 name=__codelineno-6-67></a><a href=#__codelineno-6-67><span class=linenos data-linenos="67 "></span></a>        <span class=k>await</span> <span class=n>chaos_monkey</span><span class=o>.</span><span class=n>configure_failures</span><span class=p>([</span>
</span><span id=__span-6-68><a id=__codelineno-6-68 name=__codelineno-6-68></a><a href=#__codelineno-6-68><span class=linenos data-linenos="68 "></span></a>            <span class=n>RandomFailure</span><span class=p>(</span><span class=n>component</span><span class=o>=</span><span class=s1>&#39;agent_pool&#39;</span><span class=p>,</span> <span class=n>probability</span><span class=o>=</span><span class=mf>0.1</span><span class=p>),</span>
</span><span id=__span-6-69><a id=__codelineno-6-69 name=__codelineno-6-69></a><a href=#__codelineno-6-69><span class=linenos data-linenos="69 "></span></a>            <span class=n>RandomFailure</span><span class=p>(</span><span class=n>component</span><span class=o>=</span><span class=s1>&#39;context_manager&#39;</span><span class=p>,</span> <span class=n>probability</span><span class=o>=</span><span class=mf>0.05</span><span class=p>),</span>
</span><span id=__span-6-70><a id=__codelineno-6-70 name=__codelineno-6-70></a><a href=#__codelineno-6-70><span class=linenos data-linenos="70 "></span></a>            <span class=n>RandomFailure</span><span class=p>(</span><span class=n>component</span><span class=o>=</span><span class=s1>&#39;storage_system&#39;</span><span class=p>,</span> <span class=n>probability</span><span class=o>=</span><span class=mf>0.03</span><span class=p>),</span>
</span><span id=__span-6-71><a id=__codelineno-6-71 name=__codelineno-6-71></a><a href=#__codelineno-6-71><span class=linenos data-linenos="71 "></span></a>            <span class=n>RandomFailure</span><span class=p>(</span><span class=n>component</span><span class=o>=</span><span class=s1>&#39;conflict_resolver&#39;</span><span class=p>,</span> <span class=n>probability</span><span class=o>=</span><span class=mf>0.08</span><span class=p>)</span>
</span><span id=__span-6-72><a id=__codelineno-6-72 name=__codelineno-6-72></a><a href=#__codelineno-6-72><span class=linenos data-linenos="72 "></span></a>        <span class=p>])</span>
</span><span id=__span-6-73><a id=__codelineno-6-73 name=__codelineno-6-73></a><a href=#__codelineno-6-73><span class=linenos data-linenos="73 "></span></a>        
</span><span id=__span-6-74><a id=__codelineno-6-74 name=__codelineno-6-74></a><a href=#__codelineno-6-74><span class=linenos data-linenos="74 "></span></a>        <span class=c1># Act</span>
</span><span id=__span-6-75><a id=__codelineno-6-75 name=__codelineno-6-75></a><a href=#__codelineno-6-75><span class=linenos data-linenos="75 "></span></a>        <span class=k>await</span> <span class=n>chaos_monkey</span><span class=o>.</span><span class=n>start_chaos</span><span class=p>()</span>
</span><span id=__span-6-76><a id=__codelineno-6-76 name=__codelineno-6-76></a><a href=#__codelineno-6-76><span class=linenos data-linenos="76 "></span></a>        
</span><span id=__span-6-77><a id=__codelineno-6-77 name=__codelineno-6-77></a><a href=#__codelineno-6-77><span class=linenos data-linenos="77 "></span></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-6-78><a id=__codelineno-6-78 name=__codelineno-6-78></a><a href=#__codelineno-6-78><span class=linenos data-linenos="78 "></span></a>            <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_execute_parallel_stories</span><span class=p>(</span><span class=n>stories</span><span class=p>,</span> <span class=n>max_parallel</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span><span id=__span-6-79><a id=__codelineno-6-79 name=__codelineno-6-79></a><a href=#__codelineno-6-79><span class=linenos data-linenos="79 "></span></a>            
</span><span id=__span-6-80><a id=__codelineno-6-80 name=__codelineno-6-80></a><a href=#__codelineno-6-80><span class=linenos data-linenos="80 "></span></a>            <span class=c1># Assert</span>
</span><span id=__span-6-81><a id=__codelineno-6-81 name=__codelineno-6-81></a><a href=#__codelineno-6-81><span class=linenos data-linenos="81 "></span></a>            <span class=k>assert</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>success</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>)</span>
</span><span id=__span-6-82><a id=__codelineno-6-82 name=__codelineno-6-82></a><a href=#__codelineno-6-82><span class=linenos data-linenos="82 "></span></a>            
</span><span id=__span-6-83><a id=__codelineno-6-83 name=__codelineno-6-83></a><a href=#__codelineno-6-83><span class=linenos data-linenos="83 "></span></a>            <span class=c1># Verify system maintained data consistency</span>
</span><span id=__span-6-84><a id=__codelineno-6-84 name=__codelineno-6-84></a><a href=#__codelineno-6-84><span class=linenos data-linenos="84 "></span></a>            <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>results</span><span class=p>:</span>
</span><span id=__span-6-85><a id=__codelineno-6-85 name=__codelineno-6-85></a><a href=#__codelineno-6-85><span class=linenos data-linenos="85 "></span></a>                <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_verify_data_consistency</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span><span id=__span-6-86><a id=__codelineno-6-86 name=__codelineno-6-86></a><a href=#__codelineno-6-86><span class=linenos data-linenos="86 "></span></a>                
</span><span id=__span-6-87><a id=__codelineno-6-87 name=__codelineno-6-87></a><a href=#__codelineno-6-87><span class=linenos data-linenos="87 "></span></a>        <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-6-88><a id=__codelineno-6-88 name=__codelineno-6-88></a><a href=#__codelineno-6-88><span class=linenos data-linenos="88 "></span></a>            <span class=k>await</span> <span class=n>chaos_monkey</span><span class=o>.</span><span class=n>stop_chaos</span><span class=p>()</span>
</span></code></pre></div><h2 id=continuous-testing-pipeline>Continuous Testing Pipeline<a class=headerlink href=#continuous-testing-pipeline title="Permanent link">&para;</a></h2><h3 id=1-automated-test-execution>1. Automated Test Execution<a class=headerlink href=#1-automated-test-execution title="Permanent link">&para;</a></h3><div class="language-yaml highlight"><span class=filename>YAML</span><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1></a><a href=#__codelineno-7-1><span class=linenos data-linenos=" 1 "></span></a><span class=c1># CI/CD Pipeline Configuration</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2></a><a href=#__codelineno-7-2><span class=linenos data-linenos=" 2 "></span></a><span class=nt>test_pipeline</span><span class=p>:</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3></a><a href=#__codelineno-7-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>  </span><span class=nt>stages</span><span class=p>:</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4></a><a href=#__codelineno-7-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unit_tests</span><span class=p>:</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5></a><a href=#__codelineno-7-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;pytest</span><span class=nv> </span><span class=s>tests/unit/</span><span class=nv> </span><span class=s>-v</span><span class=nv> </span><span class=s>--cov=lib</span><span class=nv> </span><span class=s>--cov-report=xml&quot;</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6></a><a href=#__codelineno-7-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>        </span><span class=nt>parallel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7></a><a href=#__codelineno-7-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>        </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10m</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8></a><a href=#__codelineno-7-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>        </span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9></a><a href=#__codelineno-7-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>integration_tests</span><span class=p>:</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10></a><a href=#__codelineno-7-10><span class=linenos data-linenos="10 "></span></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;pytest</span><span class=nv> </span><span class=s>tests/integration/</span><span class=nv> </span><span class=s>-v</span><span class=nv> </span><span class=s>--slow&quot;</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11></a><a href=#__codelineno-7-11><span class=linenos data-linenos="11 "></span></a><span class=w>        </span><span class=nt>depends_on</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>unit_tests</span><span class="p p-Indicator">]</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12></a><a href=#__codelineno-7-12><span class=linenos data-linenos="12 "></span></a><span class=w>        </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30m</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13></a><a href=#__codelineno-7-13><span class=linenos data-linenos="13 "></span></a><span class=w>        </span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14></a><a href=#__codelineno-7-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>performance_tests</span><span class=p>:</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15></a><a href=#__codelineno-7-15><span class=linenos data-linenos="15 "></span></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;pytest</span><span class=nv> </span><span class=s>tests/performance/</span><span class=nv> </span><span class=s>-v</span><span class=nv> </span><span class=s>--benchmark&quot;</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16></a><a href=#__codelineno-7-16><span class=linenos data-linenos="16 "></span></a><span class=w>        </span><span class=nt>depends_on</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>integration_tests</span><span class="p p-Indicator">]</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17></a><a href=#__codelineno-7-17><span class=linenos data-linenos="17 "></span></a><span class=w>        </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">60m</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18></a><a href=#__codelineno-7-18><span class=linenos data-linenos="18 "></span></a><span class=w>        </span><span class=nt>schedule</span><span class=p>:</span><span class=w> </span><span class=s>&quot;daily&quot;</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19></a><a href=#__codelineno-7-19><span class=linenos data-linenos="19 "></span></a><span class=w>        </span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20></a><a href=#__codelineno-7-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>security_tests</span><span class=p>:</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21></a><a href=#__codelineno-7-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;pytest</span><span class=nv> </span><span class=s>tests/security/</span><span class=nv> </span><span class=s>-v</span><span class=nv> </span><span class=s>--security-scan&quot;</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22></a><a href=#__codelineno-7-22><span class=linenos data-linenos="22 "></span></a><span class=w>        </span><span class=nt>depends_on</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>integration_tests</span><span class="p p-Indicator">]</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23></a><a href=#__codelineno-7-23><span class=linenos data-linenos="23 "></span></a><span class=w>        </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">45m</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24></a><a href=#__codelineno-7-24><span class=linenos data-linenos="24 "></span></a><span class=w>        </span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25></a><a href=#__codelineno-7-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>chaos_tests</span><span class=p>:</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26></a><a href=#__codelineno-7-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;pytest</span><span class=nv> </span><span class=s>tests/chaos/</span><span class=nv> </span><span class=s>-v</span><span class=nv> </span><span class=s>--chaos-mode&quot;</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27></a><a href=#__codelineno-7-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=nt>depends_on</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>performance_tests</span><span class="p p-Indicator">]</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28></a><a href=#__codelineno-7-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">90m</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29></a><a href=#__codelineno-7-29><span class=linenos data-linenos="29 "></span></a><span class=w>        </span><span class=nt>schedule</span><span class=p>:</span><span class=w> </span><span class=s>&quot;weekly&quot;</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30></a><a href=#__codelineno-7-30><span class=linenos data-linenos="30 "></span></a>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31></a><a href=#__codelineno-7-31><span class=linenos data-linenos="31 "></span></a><span class=w>  </span><span class=nt>quality_gates</span><span class=p>:</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32></a><a href=#__codelineno-7-32><span class=linenos data-linenos="32 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unit_test_coverage</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&gt;=</span><span class=nv> </span><span class=s>95%&quot;</span>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33></a><a href=#__codelineno-7-33><span class=linenos data-linenos="33 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>integration_test_pass_rate</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&gt;=</span><span class=nv> </span><span class=s>100%&quot;</span>
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34></a><a href=#__codelineno-7-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>performance_regression</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&lt;</span><span class=nv> </span><span class=s>5%&quot;</span>
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35></a><a href=#__codelineno-7-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>security_vulnerabilities</span><span class=p>:</span><span class=w> </span><span class=s>&quot;=</span><span class=nv> </span><span class=s>0&quot;</span>
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36></a><a href=#__codelineno-7-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>chaos_test_success_rate</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&gt;=</span><span class=nv> </span><span class=s>90%&quot;</span>
</span></code></pre></div><h3 id=2-test-metrics-and-reporting>2. Test Metrics and Reporting<a class=headerlink href=#2-test-metrics-and-reporting title="Permanent link">&para;</a></h3><div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1></a><a href=#__codelineno-8-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>class</span> <span class=nc>TestMetricsCollector</span><span class=p>:</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2></a><a href=#__codelineno-8-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Collect and report comprehensive test metrics&quot;&quot;&quot;</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3></a><a href=#__codelineno-8-3><span class=linenos data-linenos=" 3 "></span></a>    
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4></a><a href=#__codelineno-8-4><span class=linenos data-linenos=" 4 "></span></a>    <span class=k>async</span> <span class=k>def</span> <span class=nf>collect_test_metrics</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TestMetrics</span><span class=p>:</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5></a><a href=#__codelineno-8-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Collect all test execution metrics&quot;&quot;&quot;</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6></a><a href=#__codelineno-8-6><span class=linenos data-linenos=" 6 "></span></a>        <span class=k>return</span> <span class=n>TestMetrics</span><span class=p>(</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7></a><a href=#__codelineno-8-7><span class=linenos data-linenos=" 7 "></span></a>            <span class=c1># Coverage metrics</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8></a><a href=#__codelineno-8-8><span class=linenos data-linenos=" 8 "></span></a>            <span class=n>unit_test_coverage</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_unit_test_coverage</span><span class=p>(),</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9></a><a href=#__codelineno-8-9><span class=linenos data-linenos=" 9 "></span></a>            <span class=n>integration_test_coverage</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_integration_coverage</span><span class=p>(),</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10></a><a href=#__codelineno-8-10><span class=linenos data-linenos="10 "></span></a>            
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11></a><a href=#__codelineno-8-11><span class=linenos data-linenos="11 "></span></a>            <span class=c1># Performance metrics</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12></a><a href=#__codelineno-8-12><span class=linenos data-linenos="12 "></span></a>            <span class=n>test_execution_time</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_execution_times</span><span class=p>(),</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13></a><a href=#__codelineno-8-13><span class=linenos data-linenos="13 "></span></a>            <span class=n>performance_benchmarks</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_performance_benchmarks</span><span class=p>(),</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14></a><a href=#__codelineno-8-14><span class=linenos data-linenos="14 "></span></a>            
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15></a><a href=#__codelineno-8-15><span class=linenos data-linenos="15 "></span></a>            <span class=c1># Quality metrics</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16></a><a href=#__codelineno-8-16><span class=linenos data-linenos="16 "></span></a>            <span class=n>test_pass_rates</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_pass_rates</span><span class=p>(),</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17></a><a href=#__codelineno-8-17><span class=linenos data-linenos="17 "></span></a>            <span class=n>flaky_test_rate</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_flaky_test_rate</span><span class=p>(),</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18></a><a href=#__codelineno-8-18><span class=linenos data-linenos="18 "></span></a>            
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19></a><a href=#__codelineno-8-19><span class=linenos data-linenos="19 "></span></a>            <span class=c1># Security metrics</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20></a><a href=#__codelineno-8-20><span class=linenos data-linenos="20 "></span></a>            <span class=n>security_test_results</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_security_results</span><span class=p>(),</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21></a><a href=#__codelineno-8-21><span class=linenos data-linenos="21 "></span></a>            <span class=n>vulnerability_count</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_vulnerability_count</span><span class=p>(),</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22></a><a href=#__codelineno-8-22><span class=linenos data-linenos="22 "></span></a>            
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23></a><a href=#__codelineno-8-23><span class=linenos data-linenos="23 "></span></a>            <span class=c1># Chaos metrics</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24></a><a href=#__codelineno-8-24><span class=linenos data-linenos="24 "></span></a>            <span class=n>resilience_score</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_calculate_resilience_score</span><span class=p>(),</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25></a><a href=#__codelineno-8-25><span class=linenos data-linenos="25 "></span></a>            <span class=n>recovery_time_metrics</span><span class=o>=</span><span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_recovery_times</span><span class=p>()</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26></a><a href=#__codelineno-8-26><span class=linenos data-linenos="26 "></span></a>        <span class=p>)</span>
</span></code></pre></div><p>This comprehensive testing strategy ensures the Parallel TDD Execution system meets all quality, performance, security, and reliability requirements while maintaining the integrity of the TDD workflow across parallel execution scenarios.</p><aside class=md-source-file><span class=md-source-file__fact><span class=md-icon title="Last update"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 18, 2025 00:22:32 UTC">June 18, 2025 00:22:32</span></span><span class=md-source-file__fact><span class=md-icon title=Created><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 18, 2025 00:22:32 UTC">June 18, 2025 00:22:32</span></span></aside><form class=md-feedback name=feedback hidden><fieldset><legend class=md-feedback__title> Was this page helpful? </legend><div class=md-feedback__inner><div class=md-feedback__list><button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg></button><button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg></button></div><div class=md-feedback__note><div data-md-value=1 hidden> Thanks for your feedback! </div><div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by <a href="https://github.com/jmontp/agent-workflow/issues/new/?title=[Feedback]+Parallel%20TDD%20Testing%20Strategy+-+/architecture/parallel-tdd-testing-strategy/" target=_blank rel=noopener>telling us what you found confusing</a>. </div></div></div></fieldset></form></article></div><script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button type=button class="md-top md-icon" data-md-component=top hidden><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button></main><footer class=md-footer><nav class="md-footer__inner md-grid" aria-label=Footer><a href=../parallel-tdd-comprehensive-implementation-plan/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Parallel TDD Comprehensive Plan"><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.41 16.58 10.83 12l4.58-4.59L14 6l-6 6 6 6z"/></svg></div><div class=md-footer__title><span class=md-footer__direction> Previous </span><div class=md-ellipsis> Parallel TDD Comprehensive Plan </div></div></a><a href=../parallel-context-integration/ class="md-footer__link md-footer__link--next" aria-label="Next: Parallel Context Integration"><div class=md-footer__title><span class=md-footer__direction> Next </span><div class=md-ellipsis> Parallel Context Integration </div></div><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58 13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright></div><div class=md-social><a href=https://github.com/jmontp/agent-workflow target=_blank rel=noopener title="GitHub Repository" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></a><a href=https://jmontp.github.io/agent-workflow/ target=_blank rel=noopener title="Documentation Site" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg></a><a href=https://discord.gg/your-discord-server target=_blank rel=noopener title="Discord Community" class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3c5.5 0 10 3.58 10 8s-4.5 8-10 8c-1.24 0-2.43-.18-3.53-.5C5.55 21 2 21 2 21c2.33-2.33 2.7-3.9 2.75-4.5C3.05 15.07 2 13.13 2 11c0-4.42 4.5-8 10-8"/></svg></a><a href=https://github.com/sponsors/jmontp target=_blank rel=noopener title=Sponsor class=md-social__link><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53z"/></svg></a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><div class=md-progress data-md-component=progress role=progressbar></div><div class=md-consent data-md-component=consent id=__consent hidden><div class=md-consent__overlay></div><aside class=md-consent__inner><form class="md-consent__form md-grid md-typeset" name=consent><h4>Cookie consent</h4><p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p><input class=md-toggle type=checkbox id=__settings><div class=md-consent__settings><ul class=task-list><li class=task-list-item><label class=task-list-control><input type=checkbox name=analytics checked><span class=task-list-indicator></span> Google Analytics </label></li><li class=task-list-item><label class=task-list-control><input type=checkbox name=github checked><span class=task-list-indicator></span> GitHub </label></li></ul></div><div class=md-consent__controls><button class="md-button md-button--primary">Accept</button><button type=reset class="md-button md-button--primary">Reject</button><label class=md-button for=__settings>Manage settings</label></div></form></aside></div><script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script><script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": {"API": "api", "Architecture": "architecture", "CSS": "css", "Discord": "discord", "HTML5": "html", "JavaScript": "js", "Python": "python", "Scrum": "scrum", "TDD": "tdd"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.13a4f30d.min.js></script><script src=https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mtml-chtml.js></script><script src=../../js/mermaid-zoom.js></script><script src=../../js/universal-search.js></script><script src=../../js/enhanced-navigation.js></script><script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body></html>