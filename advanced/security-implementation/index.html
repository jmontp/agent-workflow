
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Human-In-The-Loop orchestration framework for AI-assisted software development">
      
      
        <meta name="author" content="AI Agent Workflow Team">
      
      
        <link rel="canonical" href="https://jmontp.github.io/agent-workflow/advanced/security-implementation/">
      
      
        <link rel="prev" href="../project-repo/">
      
      
        <link rel="next" href="../testing/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Security Implementation - AI Agent TDD-Scrum Workflow</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#security-architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AI Agent TDD-Scrum Workflow" class="md-header__button md-logo" aria-label="AI Agent TDD-Scrum Workflow" data-md-component="logo">
      
  <img src="../../assets/images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI Agent TDD-Scrum Workflow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Security Implementation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/jmontp/agent-workflow" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    jmontp/agent-workflow
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/" class="md-tabs__link">
          
  
  
    
  
  🚀 Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user-guide/" class="md-tabs__link">
          
  
  
    
  
  📖 User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../concepts/" class="md-tabs__link">
          
  
  
    
  
  🧠 Core Concepts

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/" class="md-tabs__link">
          
  
  
    
  
  🏗️ Architecture

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  🔬 Advanced Topics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/" class="md-tabs__link">
          
  
  
    
  
  👨‍💻 Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../deployment/" class="md-tabs__link">
          
  
  
    
  
  🚀 Deployment

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AI Agent TDD-Scrum Workflow" class="md-nav__button md-logo" aria-label="AI Agent TDD-Scrum Workflow" data-md-component="logo">
      
  <img src="../../assets/images/favicon.png" alt="logo">

    </a>
    AI Agent TDD-Scrum Workflow
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jmontp/agent-workflow" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    jmontp/agent-workflow
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../getting-started/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    🚀 Getting Started
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../user-guide/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    📖 User Guide
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../concepts/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    🧠 Core Concepts
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../architecture/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    🏗️ Architecture
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    🔬 Advanced Topics
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            🔬 Advanced Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Diagram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture-detailed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detailed Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Container Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../component/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../orchestration-repo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orchestration Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../project-repo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Security Implementation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Security Implementation
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent-security-model" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Security Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent Security Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Command Access Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enhanced-agent-access-matrix-with-tdd-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Enhanced Agent Access Matrix (with TDD Capabilities)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Security Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-tool-restriction-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      1. Tool Restriction Enforcement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-command-categories" class="md-nav__link">
    <span class="md-ellipsis">
      2. Command Categories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Command Categories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#restricted-commands-blocked-for-most-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Restricted Commands (Blocked for Most Agents)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elevated-commands-orchestrator-only" class="md-nav__link">
    <span class="md-ellipsis">
      Elevated Commands (Orchestrator Only)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-management-commands-orchestrator-code-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Code Management Commands (Orchestrator + Code Agent)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-security-validation" class="md-nav__link">
    <span class="md-ellipsis">
      3. Security Validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Data Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enhanced-state-management-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enhanced State Management Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-environment-security" class="md-nav__link">
    <span class="md-ellipsis">
      2. Environment Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-secret-management" class="md-nav__link">
    <span class="md-ellipsis">
      3. Secret Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication &amp; Authorization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication &amp; Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-discord-bot-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Discord Bot Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-project-level-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      2. Project-Level Permissions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-validation-sanitization" class="md-nav__link">
    <span class="md-ellipsis">
      Input Validation &amp; Sanitization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input Validation &amp; Sanitization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enhanced-command-validation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enhanced Command Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-dual-state-machine-validation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Dual State Machine Validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Audit &amp; Monitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Audit &amp; Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-security-logging" class="md-nav__link">
    <span class="md-ellipsis">
      1. Security Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-access-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      2. Access Monitoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threat-model-mitigations" class="md-nav__link">
    <span class="md-ellipsis">
      Threat Model &amp; Mitigations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threat Model &amp; Mitigations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enhanced-threat-model-with-tdd-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enhanced Threat Model (with TDD Considerations)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      2. Security Controls
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Security Controls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preventive-controls" class="md-nav__link">
    <span class="md-ellipsis">
      Preventive Controls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detective-controls" class="md-nav__link">
    <span class="md-ellipsis">
      Detective Controls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corrective-controls" class="md-nav__link">
    <span class="md-ellipsis">
      Corrective Controls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Security Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enhanced-automated-security-tests" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enhanced Automated Security Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-enhanced-security-test-categories" class="md-nav__link">
    <span class="md-ellipsis">
      2. Enhanced Security Test Categories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Security Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enhanced-agent-security-profiles-with-tdd-support" class="md-nav__link">
    <span class="md-ellipsis">
      1. Enhanced Agent Security Profiles (with TDD Support)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-enhanced-environment-security-settings-with-tdd-support" class="md-nav__link">
    <span class="md-ellipsis">
      2. Enhanced Environment Security Settings (with TDD Support)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-development-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Development Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-operational-security" class="md-nav__link">
    <span class="md-ellipsis">
      2. Operational Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-monitoring-alerting" class="md-nav__link">
    <span class="md-ellipsis">
      3. Monitoring &amp; Alerting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-privacy" class="md-nav__link">
    <span class="md-ellipsis">
      1. Data Privacy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-access-controls" class="md-nav__link">
    <span class="md-ellipsis">
      2. Access Controls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Structure
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../development/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    👨‍💻 Development
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../deployment/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    🚀 Deployment
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/jmontp/agent-workflow/edit/master/docs/advanced/security-implementation.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/jmontp/agent-workflow/raw/master/docs/advanced/security-implementation.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="security-architecture">Security Architecture<a class="headerlink" href="#security-architecture" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The AI Agent TDD-Scrum Workflow system implements comprehensive security measures to ensure safe operation of AI agents with appropriate access controls and data protection. This includes enhanced security boundaries for Test-Driven Development workflows, test file access controls, and TDD-specific agent restrictions.</p>
<h2 id="agent-security-model">Agent Security Model<a class="headerlink" href="#agent-security-model" title="Permanent link">&para;</a></h2>
<h3 id="command-access-control">Command Access Control<a class="headerlink" href="#command-access-control" title="Permanent link">&para;</a></h3>
<p>Each agent type operates under the <strong>Principle of Least Privilege</strong>, with access restricted to only the tools necessary for their specific function.</p>
<pre class="mermaid"><code>graph LR
    subgraph "Agent Security Layers"
        Claude[Claude Code CLI]
        Config[Agent Tool Config]
        Validation[Access Validation]
    end

    subgraph "Agent Types"
        Orchestrator[Orchestrator&lt;br/&gt;Full Access]
        Code[Code Agent&lt;br/&gt;Edit + Commit]
        Design[Design Agent&lt;br/&gt;Read Only]
        QA[QA Agent&lt;br/&gt;Test Only]
        Data[Data Agent&lt;br/&gt;Analysis Only]
    end

    Claude --&gt; Config
    Config --&gt; Validation
    Validation --&gt; Orchestrator
    Validation --&gt; Code
    Validation --&gt; Design
    Validation --&gt; QA
    Validation --&gt; Data</code></pre>
<h3 id="enhanced-agent-access-matrix-with-tdd-capabilities">Enhanced Agent Access Matrix (with TDD Capabilities)<a class="headerlink" href="#enhanced-agent-access-matrix-with-tdd-capabilities" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Tool Category</th>
<th>Orchestrator</th>
<th>Code Agent (TDD)</th>
<th>Design Agent (TDD)</th>
<th>QA Agent (TDD)</th>
<th>Data Agent</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>File Operations</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Read files</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Write new files</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Edit existing code</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>Delete files</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td><strong>TDD-Specific File Operations</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Create test files</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Edit test files</td>
<td>✅</td>
<td>✅ (during CODE_GREEN)</td>
<td>❌</td>
<td>✅ (during TEST_RED)</td>
<td>❌</td>
</tr>
<tr>
<td>Preserve test files</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Promote test files</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Delete test files</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td><strong>Version Control</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Git status/diff</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Git add/commit</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅ (tests only)</td>
<td>❌</td>
</tr>
<tr>
<td>Git push</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td><strong>TDD-Specific Version Control</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Commit failing tests</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Commit code with tests</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>Commit refactored code</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td><strong>Testing &amp; Analysis</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Run tests</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Code quality tools</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td><strong>TDD-Specific Testing</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Create failing tests</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Validate test failures</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>Test coverage analysis</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td><strong>System Operations</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Package management</td>
<td>✅</td>
<td>✅ (limited)</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>Process management</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>Network access</td>
<td>✅</td>
<td>❌</td>
<td>✅ (research)</td>
<td>❌</td>
<td>❌</td>
</tr>
</tbody>
</table>
<h2 id="security-implementation">Security Implementation<a class="headerlink" href="#security-implementation" title="Permanent link">&para;</a></h2>
<h3 id="1-tool-restriction-enforcement">1. Tool Restriction Enforcement<a class="headerlink" href="#1-tool-restriction-enforcement" title="Permanent link">&para;</a></h3>
<p>The system leverages Claude Code's built-in security flags:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>claude<span class="w"> </span>--allowedTools<span class="w"> </span><span class="s2">&quot;Read Write Glob&quot;</span><span class="w"> </span>--disallowedTools<span class="w"> </span><span class="s2">&quot;Bash(rm) Edit&quot;</span>
</span></code></pre></div>
<p><strong>Architecture Components:</strong></p>
<ul>
<li><strong><code>agent_tool_config.py</code></strong>: Centralized security configuration</li>
<li><strong>Enhanced Claude Client</strong>: Automatic tool restriction application</li>
<li><strong>Agent Integration</strong>: Transparent security enforcement</li>
</ul>
<h3 id="2-command-categories">2. Command Categories<a class="headerlink" href="#2-command-categories" title="Permanent link">&para;</a></h3>
<h4 id="restricted-commands-blocked-for-most-agents">Restricted Commands (Blocked for Most Agents)<a class="headerlink" href="#restricted-commands-blocked-for-most-agents" title="Permanent link">&para;</a></h4>
<ul>
<li><code>sudo</code>, <code>su</code> - Privilege escalation</li>
<li><code>chmod</code>, <code>chown</code> - Permission changes</li>
<li><code>kill</code>, <code>killall</code> - Process termination</li>
<li><code>curl</code>, <code>wget</code> - Network downloads</li>
<li><code>ssh</code>, <code>scp</code> - Remote access</li>
<li><code>docker run</code> - Container operations</li>
</ul>
<h4 id="elevated-commands-orchestrator-only">Elevated Commands (Orchestrator Only)<a class="headerlink" href="#elevated-commands-orchestrator-only" title="Permanent link">&para;</a></h4>
<ul>
<li><code>rm</code>, <code>rmdir</code> - File deletion</li>
<li><code>git push</code> - Publishing changes</li>
</ul>
<h4 id="code-management-commands-orchestrator-code-agent">Code Management Commands (Orchestrator + Code Agent)<a class="headerlink" href="#code-management-commands-orchestrator-code-agent" title="Permanent link">&para;</a></h4>
<ul>
<li><code>git commit</code> - Version control commits</li>
<li><code>git add</code> - Stage changes</li>
<li><code>git reset</code> - Reset changes</li>
</ul>
<h3 id="3-security-validation">3. Security Validation<a class="headerlink" href="#3-security-validation" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">lib.agent_tool_config</span> <span class="kn">import</span> <span class="n">validate_agent_access</span><span class="p">,</span> <span class="n">AgentType</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># Runtime validation</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">can_commit</span> <span class="o">=</span> <span class="n">validate_agent_access</span><span class="p">(</span><span class="n">AgentType</span><span class="o">.</span><span class="n">CODE</span><span class="p">,</span> <span class="s2">&quot;Bash(git commit)&quot;</span><span class="p">)</span>  <span class="c1"># ✅ True</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">can_delete</span> <span class="o">=</span> <span class="n">validate_agent_access</span><span class="p">(</span><span class="n">AgentType</span><span class="o">.</span><span class="n">CODE</span><span class="p">,</span> <span class="s2">&quot;Bash(rm)&quot;</span><span class="p">)</span>          <span class="c1"># ❌ False</span>
</span></code></pre></div>
<h2 id="data-protection">Data Protection<a class="headerlink" href="#data-protection" title="Permanent link">&para;</a></h2>
<h3 id="1-enhanced-state-management-security">1. Enhanced State Management Security<a class="headerlink" href="#1-enhanced-state-management-security" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>No Sensitive Data</strong>: State files contain only workflow and TDD metadata</li>
<li><strong>Dual State Storage</strong>: </li>
<li>Workflow state persisted in <code>.orch-state/status.json</code></li>
<li>TDD state persisted in <code>.orch-state/tdd/</code></li>
<li><strong>Project Isolation</strong>: Independent workflow and TDD state per project</li>
<li><strong>Story-Level TDD Isolation</strong>: TDD cycles isolated per story to prevent cross-contamination</li>
<li><strong>Access Control</strong>: File system permissions protect both workflow and TDD state</li>
<li><strong>Test File Protection</strong>: Test files in <code>tests/tdd/</code> protected from unauthorized modification</li>
</ul>
<h3 id="2-environment-security">2. Environment Security<a class="headerlink" href="#2-environment-security" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Required environment variables</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">DISCORD_BOT_TOKEN</span><span class="o">=</span><span class="s2">&quot;your_token_here&quot;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Optional: Restrict Claude Code directory access</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>claude<span class="w"> </span>--add-dir<span class="w"> </span>./project-dir
</span></code></pre></div>
<h3 id="3-secret-management">3. Secret Management<a class="headerlink" href="#3-secret-management" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Environment Variables</strong>: All secrets stored as env vars</li>
<li><strong>No Hardcoded Secrets</strong>: Code contains no embedded credentials</li>
<li><strong>Token Rotation</strong>: Support for rotating API tokens</li>
<li><strong>Audit Logging</strong>: All credential usage logged</li>
</ul>
<h2 id="authentication-authorization">Authentication &amp; Authorization<a class="headerlink" href="#authentication-authorization" title="Permanent link">&para;</a></h2>
<h3 id="1-discord-bot-security">1. Discord Bot Security<a class="headerlink" href="#1-discord-bot-security" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Role-based access control</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nd">@app_commands</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nd">@requires_role</span><span class="p">(</span><span class="s2">&quot;developer&quot;</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">sensitive_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">):</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="c1"># Only users with &#39;developer&#39; role can execute</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="k">pass</span>
</span></code></pre></div>
<h3 id="2-project-level-permissions">2. Project-Level Permissions<a class="headerlink" href="#2-project-level-permissions" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Channel Isolation</strong>: Each project has dedicated Discord channel</li>
<li><strong>User Permissions</strong>: Discord role-based access control</li>
<li><strong>Command Restrictions</strong>: Sensitive commands require elevated roles</li>
</ul>
<h2 id="input-validation-sanitization">Input Validation &amp; Sanitization<a class="headerlink" href="#input-validation-sanitization" title="Permanent link">&para;</a></h2>
<h3 id="1-enhanced-command-validation">1. Enhanced Command Validation<a class="headerlink" href="#1-enhanced-command-validation" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span> <span class="nf">validate_epic_command</span><span class="p">(</span><span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate epic description input&quot;&quot;&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Epic description too long&quot;</span><span class="p">)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="c1"># Prevent command injection</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">dangerous_chars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;||&#39;</span><span class="p">,</span> <span class="s1">&#39;`&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">]</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">description</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">dangerous_chars</span><span class="p">):</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid characters in description&quot;</span><span class="p">)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="k">def</span> <span class="nf">validate_tdd_command</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">story_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cycle</span><span class="p">:</span> <span class="n">TDDCycle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate TDD command input with cycle context&quot;&quot;&quot;</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="c1"># Validate story ID format</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[A-Z0-9-]+$&#39;</span><span class="p">,</span> <span class="n">story_id</span><span class="p">):</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid story ID format&quot;</span><span class="p">)</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>    <span class="c1"># Validate TDD command format</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>    <span class="n">valid_tdd_commands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/tdd test&#39;</span><span class="p">,</span> <span class="s1">&#39;/tdd code&#39;</span><span class="p">,</span> <span class="s1">&#39;/tdd refactor&#39;</span><span class="p">,</span> <span class="s1">&#39;/tdd commit&#39;</span><span class="p">]</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>    <span class="k">if</span> <span class="n">command</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_tdd_commands</span><span class="p">:</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid TDD command: </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>    <span class="c1"># Validate against TDD state machine</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">cycle</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">cycle</span><span class="o">.</span><span class="n">current_state</span><span class="p">:</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid TDD cycle state&quot;</span><span class="p">)</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>    <span class="k">return</span> <span class="kc">True</span>
</span></code></pre></div>
<h3 id="2-dual-state-machine-validation">2. Dual State Machine Validation<a class="headerlink" href="#2-dual-state-machine-validation" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Workflow Command Sequencing</strong>: Only valid workflow commands allowed per state</li>
<li><strong>TDD Command Sequencing</strong>: TDD commands validated against TDD state and conditions</li>
<li><strong>Cross-State Validation</strong>: Workflow and TDD states validated for consistency</li>
<li><strong>Parameter Validation</strong>: All inputs validated before processing (workflow + TDD)</li>
<li><strong>Error Handling</strong>: Graceful failure with helpful error messages for both systems</li>
<li><strong>Test File Validation</strong>: Test file paths and contents validated for security</li>
</ul>
<h2 id="audit-monitoring">Audit &amp; Monitoring<a class="headerlink" href="#audit-monitoring" title="Permanent link">&para;</a></h2>
<h3 id="1-security-logging">1. Security Logging<a class="headerlink" href="#1-security-logging" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Security-relevant events logged</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">logger</span><span class="o">.</span><span class="n">security</span><span class="p">(</span><span class="s2">&quot;Agent access granted&quot;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="s2">&quot;agent_type&quot;</span><span class="p">:</span> <span class="s2">&quot;CodeAgent&quot;</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="s2">&quot;tool&quot;</span><span class="p">:</span> <span class="s2">&quot;git commit&quot;</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">interaction</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="s2">&quot;project&quot;</span><span class="p">:</span> <span class="n">project_name</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="p">})</span>
</span></code></pre></div>
<h3 id="2-access-monitoring">2. Access Monitoring<a class="headerlink" href="#2-access-monitoring" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Tool Usage Tracking</strong>: All agent tool usage logged</li>
<li><strong>Failed Access Attempts</strong>: Blocked commands logged</li>
<li><strong>User Activity</strong>: Discord command usage tracked</li>
<li><strong>Anomaly Detection</strong>: Unusual usage patterns flagged</li>
</ul>
<h2 id="threat-model-mitigations">Threat Model &amp; Mitigations<a class="headerlink" href="#threat-model-mitigations" title="Permanent link">&para;</a></h2>
<h3 id="1-enhanced-threat-model-with-tdd-considerations">1. Enhanced Threat Model (with TDD Considerations)<a class="headerlink" href="#1-enhanced-threat-model-with-tdd-considerations" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Threat</th>
<th>Impact</th>
<th>Likelihood</th>
<th>Mitigation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Malicious Agent Commands</strong></td>
<td>High</td>
<td>Medium</td>
<td>Enhanced tool access restrictions + TDD phase controls</td>
</tr>
<tr>
<td><strong>TDD Test Tampering</strong></td>
<td>High</td>
<td>Medium</td>
<td>Test file access controls + preservation workflow</td>
</tr>
<tr>
<td><strong>Privilege Escalation</strong></td>
<td>High</td>
<td>Low</td>
<td>Command filtering + TDD phase validation</td>
</tr>
<tr>
<td><strong>Code Injection via Tests</strong></td>
<td>Medium</td>
<td>Medium</td>
<td>Test content validation + sandboxed execution</td>
</tr>
<tr>
<td><strong>Cross-Story Test Contamination</strong></td>
<td>Medium</td>
<td>Medium</td>
<td>Story-level TDD isolation</td>
</tr>
<tr>
<td><strong>Test File Exfiltration</strong></td>
<td>Medium</td>
<td>Low</td>
<td>Network restrictions + test file access controls</td>
</tr>
<tr>
<td><strong>Unauthorized TDD State Access</strong></td>
<td>Medium</td>
<td>Low</td>
<td>TDD state access controls + Discord role permissions</td>
</tr>
<tr>
<td><strong>TDD Cycle Disruption</strong></td>
<td>Low</td>
<td>Medium</td>
<td>TDD state validation + recovery mechanisms</td>
</tr>
</tbody>
</table>
<h3 id="2-security-controls">2. Security Controls<a class="headerlink" href="#2-security-controls" title="Permanent link">&para;</a></h3>
<h4 id="preventive-controls">Preventive Controls<a class="headerlink" href="#preventive-controls" title="Permanent link">&para;</a></h4>
<ul>
<li>Enhanced agent tool restrictions (including TDD-specific controls)</li>
<li>Input validation (workflow + TDD commands)</li>
<li>Role-based access control (including TDD command permissions)</li>
<li>Environment isolation (including TDD workspace isolation)</li>
<li><strong>TDD-Specific Controls</strong>:</li>
<li>Test file access restrictions per TDD phase</li>
<li>Story-level TDD cycle isolation</li>
<li>Test preservation workflow validation</li>
<li>TDD state transition controls</li>
</ul>
<h4 id="detective-controls">Detective Controls<a class="headerlink" href="#detective-controls" title="Permanent link">&para;</a></h4>
<ul>
<li>Comprehensive audit logging (workflow + TDD activities)</li>
<li>Access monitoring (including test file access)</li>
<li>Anomaly detection (including TDD cycle anomalies)</li>
<li>Failed attempt tracking (workflow + TDD command failures)</li>
<li><strong>TDD-Specific Detection</strong>:</li>
<li>Test file modification monitoring</li>
<li>TDD phase transition tracking</li>
<li>Test preservation validation logging</li>
<li>Cross-story contamination detection</li>
</ul>
<h4 id="corrective-controls">Corrective Controls<a class="headerlink" href="#corrective-controls" title="Permanent link">&para;</a></h4>
<ul>
<li>Automatic command blocking (workflow + TDD commands)</li>
<li>Error recovery procedures (including TDD cycle recovery)</li>
<li>State rollback capabilities (dual state machine rollback)</li>
<li>Alert escalation (workflow + TDD security events)</li>
<li><strong>TDD-Specific Corrections</strong>:</li>
<li>Test file restoration from git history</li>
<li>TDD cycle state recovery</li>
<li>Test preservation workflow repair</li>
<li>Cross-story isolation enforcement</li>
</ul>
<h2 id="security-testing">Security Testing<a class="headerlink" href="#security-testing" title="Permanent link">&para;</a></h2>
<h3 id="1-enhanced-automated-security-tests">1. Enhanced Automated Security Tests<a class="headerlink" href="#1-enhanced-automated-security-tests" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Example security test for TDD workflow</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">def</span> <span class="nf">test_code_agent_cannot_delete_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify code agent cannot use rm command&quot;&quot;&quot;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">access_granted</span> <span class="o">=</span> <span class="n">validate_agent_access</span><span class="p">(</span><span class="n">AgentType</span><span class="o">.</span><span class="n">CODE</span><span class="p">,</span> <span class="s2">&quot;Bash(rm)&quot;</span><span class="p">)</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">access_granted</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="k">def</span> <span class="nf">test_qa_agent_cannot_edit_code_during_test_red</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify QA agent cannot edit source code during TEST_RED phase&quot;&quot;&quot;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="n">cycle</span> <span class="o">=</span> <span class="n">create_test_tdd_cycle</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">TDDState</span><span class="o">.</span><span class="n">TEST_RED</span><span class="p">)</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>    <span class="n">access_granted</span> <span class="o">=</span> <span class="n">validate_tdd_phase_access</span><span class="p">(</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>        <span class="n">AgentType</span><span class="o">.</span><span class="n">QA</span><span class="p">,</span> <span class="s2">&quot;Edit(src/main.py)&quot;</span><span class="p">,</span> <span class="n">cycle</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="p">)</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">access_granted</span><span class="p">)</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="k">def</span> <span class="nf">test_code_agent_cannot_modify_tests_during_refactor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify code agent cannot modify test files during REFACTOR phase&quot;&quot;&quot;</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>    <span class="n">cycle</span> <span class="o">=</span> <span class="n">create_test_tdd_cycle</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">TDDState</span><span class="o">.</span><span class="n">REFACTOR</span><span class="p">)</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    <span class="n">access_granted</span> <span class="o">=</span> <span class="n">validate_tdd_phase_access</span><span class="p">(</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>        <span class="n">AgentType</span><span class="o">.</span><span class="n">CODE</span><span class="p">,</span> <span class="s2">&quot;Edit(tests/tdd/story-1/test_feature.py)&quot;</span><span class="p">,</span> <span class="n">cycle</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>    <span class="p">)</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">access_granted</span><span class="p">)</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="k">def</span> <span class="nf">test_cross_story_tdd_isolation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify agents cannot access other story&#39;s TDD cycles&quot;&quot;&quot;</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>    <span class="n">story1_cycle</span> <span class="o">=</span> <span class="n">create_test_tdd_cycle</span><span class="p">(</span><span class="n">story_id</span><span class="o">=</span><span class="s2">&quot;STORY-1&quot;</span><span class="p">)</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>    <span class="n">story2_cycle</span> <span class="o">=</span> <span class="n">create_test_tdd_cycle</span><span class="p">(</span><span class="n">story_id</span><span class="o">=</span><span class="s2">&quot;STORY-2&quot;</span><span class="p">)</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>    <span class="n">access_granted</span> <span class="o">=</span> <span class="n">validate_cross_story_access</span><span class="p">(</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>        <span class="n">AgentType</span><span class="o">.</span><span class="n">QA</span><span class="p">,</span> <span class="n">story1_cycle</span><span class="p">,</span> <span class="n">story2_cycle</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>    <span class="p">)</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">access_granted</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="2-enhanced-security-test-categories">2. Enhanced Security Test Categories<a class="headerlink" href="#2-enhanced-security-test-categories" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Access Control Tests</strong>: Verify agent restrictions work (including TDD phase restrictions)</li>
<li><strong>Input Validation Tests</strong>: Test command injection prevention (workflow + TDD commands)</li>
<li><strong>Authentication Tests</strong>: Verify Discord role enforcement (including TDD command permissions)</li>
<li><strong>State Security Tests</strong>: Ensure state tampering protection (dual state machine)</li>
<li><strong>TDD-Specific Security Tests</strong>:</li>
<li>TDD phase access control validation</li>
<li>Test file modification restrictions</li>
<li>Story-level TDD isolation verification</li>
<li>Test preservation workflow security</li>
<li>Cross-phase contamination prevention</li>
</ul>
<h2 id="security-configuration">Security Configuration<a class="headerlink" href="#security-configuration" title="Permanent link">&para;</a></h2>
<h3 id="1-enhanced-agent-security-profiles-with-tdd-support">1. Enhanced Agent Security Profiles (with TDD Support)<a class="headerlink" href="#1-enhanced-agent-security-profiles-with-tdd-support" title="Permanent link">&para;</a></h3>
<p>Create custom security profiles by modifying <code>AGENT_TOOL_CONFIG</code> with TDD phase awareness:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">TDD_ENHANCED_AGENT_CONFIG</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">AgentType</span><span class="o">.</span><span class="n">QA_TDD</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>        <span class="s2">&quot;allowed_tools&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>            <span class="n">TDDState</span><span class="o">.</span><span class="n">TEST_RED</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>                <span class="s2">&quot;Read&quot;</span><span class="p">,</span> <span class="s2">&quot;Write&quot;</span><span class="p">,</span> <span class="s2">&quot;Bash(pytest)&quot;</span><span class="p">,</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>                <span class="s2">&quot;TestFileCreate&quot;</span><span class="p">,</span> <span class="s2">&quot;TestFileEdit&quot;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>            <span class="p">],</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>            <span class="n">TDDState</span><span class="o">.</span><span class="n">CODE_GREEN</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>                <span class="s2">&quot;Read&quot;</span><span class="p">,</span> <span class="s2">&quot;Bash(pytest)&quot;</span><span class="p">,</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>                <span class="s2">&quot;TestFileValidate&quot;</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>            <span class="p">],</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>            <span class="n">TDDState</span><span class="o">.</span><span class="n">REFACTOR</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>                <span class="s2">&quot;Read&quot;</span><span class="p">,</span> <span class="s2">&quot;Bash(pytest)&quot;</span><span class="p">,</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>                <span class="s2">&quot;TestFileValidate&quot;</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>            <span class="p">]</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>        <span class="p">},</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>        <span class="s2">&quot;disallowed_tools&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>            <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>                <span class="s2">&quot;Edit(src/*)&quot;</span><span class="p">,</span> <span class="s2">&quot;Bash(rm)&quot;</span><span class="p">,</span> <span class="s2">&quot;TestFileDelete&quot;</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>            <span class="p">],</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>            <span class="n">TDDState</span><span class="o">.</span><span class="n">CODE_GREEN</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>                <span class="s2">&quot;TestFileEdit&quot;</span><span class="p">,</span> <span class="s2">&quot;TestFileCreate&quot;</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>            <span class="p">]</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>        <span class="p">},</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>        <span class="s2">&quot;tdd_restrictions&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>            <span class="s2">&quot;story_isolation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>            <span class="s2">&quot;test_preservation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>            <span class="s2">&quot;cross_phase_validation&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>        <span class="p">}</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>    <span class="p">},</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>    <span class="n">AgentType</span><span class="o">.</span><span class="n">CODE_TDD</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>        <span class="s2">&quot;allowed_tools&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>            <span class="n">TDDState</span><span class="o">.</span><span class="n">CODE_GREEN</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>                <span class="s2">&quot;Read&quot;</span><span class="p">,</span> <span class="s2">&quot;Edit(src/*)&quot;</span><span class="p">,</span> <span class="s2">&quot;Write(src/*)&quot;</span><span class="p">,</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>                <span class="s2">&quot;Bash(pytest)&quot;</span><span class="p">,</span> <span class="s2">&quot;TestFileValidate&quot;</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>            <span class="p">],</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>            <span class="n">TDDState</span><span class="o">.</span><span class="n">REFACTOR</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>                <span class="s2">&quot;Read&quot;</span><span class="p">,</span> <span class="s2">&quot;Edit(src/*)&quot;</span><span class="p">,</span> <span class="s2">&quot;Refactor&quot;</span><span class="p">,</span>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>                <span class="s2">&quot;Bash(pytest)&quot;</span><span class="p">,</span> <span class="s2">&quot;TestFileValidate&quot;</span>
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>            <span class="p">]</span>
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>        <span class="p">},</span>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>        <span class="s2">&quot;disallowed_tools&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>            <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>                <span class="s2">&quot;TestFileEdit&quot;</span><span class="p">,</span> <span class="s2">&quot;TestFileCreate&quot;</span><span class="p">,</span> <span class="s2">&quot;Bash(rm)&quot;</span>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>            <span class="p">],</span>
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>            <span class="n">TDDState</span><span class="o">.</span><span class="n">TEST_RED</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>                <span class="s2">&quot;Edit(src/*)&quot;</span><span class="p">,</span> <span class="s2">&quot;Write(src/*)&quot;</span>
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>            <span class="p">]</span>
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>        <span class="p">}</span>
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>    <span class="p">}</span>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="2-enhanced-environment-security-settings-with-tdd-support">2. Enhanced Environment Security Settings (with TDD Support)<a class="headerlink" href="#2-enhanced-environment-security-settings-with-tdd-support" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Restrict Claude Code to specific directories</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CLAUDE_ALLOWED_DIRS</span><span class="o">=</span><span class="s2">&quot;/workspace/safe-dir&quot;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1"># Enable additional security logging</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SECURITY_LOG_LEVEL</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1"># Require explicit permission for network access</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">REQUIRE_NETWORK_APPROVAL</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c1"># TDD-specific security settings</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TDD_ISOLATION_ENABLED</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TDD_TEST_FILE_VALIDATION</span><span class="o">=</span><span class="s2">&quot;strict&quot;</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TDD_CROSS_STORY_ACCESS</span><span class="o">=</span><span class="s2">&quot;deny&quot;</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TDD_PHASE_ENFORCEMENT</span><span class="o">=</span><span class="s2">&quot;strict&quot;</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c1"># Test file security settings</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TEST_FILE_BACKUP_ENABLED</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TEST_PRESERVATION_VALIDATION</span><span class="o">=</span><span class="s2">&quot;enabled&quot;</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TEST_FILE_PROMOTION_APPROVAL</span><span class="o">=</span><span class="s2">&quot;required&quot;</span>
</span></code></pre></div>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="1-development-security">1. Development Security<a class="headerlink" href="#1-development-security" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Code Review</strong>: All security-related changes require review</li>
<li><strong>Principle of Least Privilege</strong>: Grant minimal necessary permissions</li>
<li><strong>Defense in Depth</strong>: Multiple security layers</li>
<li><strong>Fail Secure</strong>: Default to deny for unknown operations</li>
</ul>
<h3 id="2-operational-security">2. Operational Security<a class="headerlink" href="#2-operational-security" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Regular Audits</strong>: Periodic review of agent permissions</li>
<li><strong>Security Updates</strong>: Keep dependencies updated</li>
<li><strong>Incident Response</strong>: Clear procedures for security events</li>
<li><strong>Backup &amp; Recovery</strong>: Secure backup of critical data</li>
</ul>
<h3 id="3-monitoring-alerting">3. Monitoring &amp; Alerting<a class="headerlink" href="#3-monitoring-alerting" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Security alert example</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">if</span> <span class="n">failed_access_attempts</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">alert_security_team</span><span class="p">(</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        <span class="s2">&quot;Multiple failed access attempts&quot;</span><span class="p">,</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>        <span class="n">agent_type</span><span class="o">=</span><span class="n">agent</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>        <span class="n">user</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>        <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>    <span class="p">)</span>
</span></code></pre></div>
<h2 id="compliance-considerations">Compliance Considerations<a class="headerlink" href="#compliance-considerations" title="Permanent link">&para;</a></h2>
<h3 id="1-data-privacy">1. Data Privacy<a class="headerlink" href="#1-data-privacy" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>No PII Storage</strong>: System avoids storing personal information</li>
<li><strong>Data Minimization</strong>: Only necessary data collected</li>
<li><strong>Retention Policies</strong>: Automatic log rotation and cleanup</li>
</ul>
<h3 id="2-access-controls">2. Access Controls<a class="headerlink" href="#2-access-controls" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Role Separation</strong>: Clear separation of duties</li>
<li><strong>Audit Trail</strong>: Complete audit trail of all actions</li>
<li><strong>Access Reviews</strong>: Regular review of user permissions</li>
</ul>
<hr />
<div class="admonition warning">
<p class="admonition-title">Security Updates</p>
<p>Security configurations should be reviewed regularly and updated as new threats emerge. Monitor security advisories for all dependencies.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Incident Response</p>
<p>In case of suspected security incident, immediately disable affected agents and review audit logs. Contact security team for investigation procedures.</p>
</div>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../project-repo/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Project Repository">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Project Repository
              </div>
            </div>
          </a>
        
        
          
          <a href="../testing/" class="md-footer__link md-footer__link--next" aria-label="Next: Testing Strategy">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Testing Strategy
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/jmontp/agent-workflow" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://jmontp.github.io/agent-workflow/" target="_blank" rel="noopener" title="Documentation Site" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../js/mermaid-zoom.js"></script>
      
    
  </body>
</html>